{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{disclosureApi,disclosureOperateApi}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CommunityPage=()=>{const navigate=useNavigate();const[disclosures,setDisclosures]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{loadDisclosures();},[]);const loadDisclosures=async()=>{try{setLoading(true);const res=await disclosureApi.getPublicDisclosure(1,100);setDisclosures(res.data.data||[]);}catch(err){console.error(err);}finally{setLoading(false);}};const ensureLogin=()=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return false;}return true;};const handleLike=async id=>{if(!ensureLogin())return;await disclosureOperateApi.like(id);};const handleCollect=async id=>{if(!ensureLogin())return;await disclosureOperateApi.collect(id);};return/*#__PURE__*/_jsxs(\"div\",{className:\"community-page-wrapper\",style:{maxWidth:'1200px',margin:'20px auto',padding:'0 15px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'20px'},children:\"\\u307F\\u3093\\u306A\\u306E\\u6295\\u7A3F (\\u627F\\u8A8D\\u6E08\\u307F)\"}),loading?/*#__PURE__*/_jsx(\"div\",{children:\"\\u8AAD\\u307F\\u8FBC\\u307F\\u4E2D...\"}):disclosures.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-tips\",children:\"\\u6295\\u7A3F\\u304C\\u307E\\u3060\\u3042\\u308A\\u307E\\u305B\\u3093\"}):/*#__PURE__*/_jsx(\"div\",{className:\"community-grid\",style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(280px, 1fr))',gap:'20px'},children:disclosures.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"community-card\",style:{border:'1px solid #eee',borderRadius:'8px',overflow:'hidden',background:'#fff',boxShadow:'0 2px 4px rgba(0,0,0,0.05)'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",style:{height:'200px',background:'#f5f5f5',display:'flex',alignItems:'center',justifyContent:'center'},children:item.imgUrl?/*#__PURE__*/_jsx(\"img\",{src:item.imgUrl,alt:item.title,style:{width:'100%',height:'100%',objectFit:'contain'}}):/*#__PURE__*/_jsx(\"span\",{style:{color:'#ccc'},children:\"No Image\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",style:{padding:'15px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 10px',fontSize:'16px',lineHeight:'1.4',height:'44px',overflow:'hidden'},children:item.title}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#ff5000',fontWeight:'bold',fontSize:'18px',marginBottom:'10px'},children:[\"\\xA5\",item.disclosurePrice]}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'13px',color:'#666',marginBottom:'15px',height:'60px',overflow:'hidden'},children:item.content}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'12px',color:'#999'},children:new Date(item.createTime).toLocaleDateString()}),/*#__PURE__*/_jsx(\"a\",{href:item.link,target:\"_blank\",rel:\"noopener noreferrer\",style:{background:'#ff5000',color:'#fff',padding:'5px 15px',borderRadius:'15px',textDecoration:'none',fontSize:'13px'},children:\"\\u8A73\\u7D30\\u3078\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLike(item.disclosureId),style:{border:'1px solid #ddd',background:'#fff',padding:'5px 10px',cursor:'pointer'},children:\"\\u70B9\\u8D5E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCollect(item.disclosureId),style:{border:'1px solid #ddd',background:'#fff',padding:'5px 10px',cursor:'pointer'},children:\"\\u6536\\u85CF\"})]})]})]})]},item.disclosureId))})]});};export default CommunityPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","disclosureApi","disclosureOperateApi","jsx","_jsx","jsxs","_jsxs","CommunityPage","navigate","disclosures","setDisclosures","loading","setLoading","loadDisclosures","res","getPublicDisclosure","data","err","console","error","ensureLogin","token","localStorage","getItem","handleLike","id","like","handleCollect","collect","className","style","maxWidth","margin","padding","children","marginBottom","length","display","gridTemplateColumns","gap","map","item","border","borderRadius","overflow","background","boxShadow","height","alignItems","justifyContent","imgUrl","src","alt","title","width","objectFit","color","fontSize","lineHeight","fontWeight","disclosurePrice","content","Date","createTime","toLocaleDateString","href","link","target","rel","textDecoration","onClick","disclosureId","cursor"],"sources":["C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/src/pages/CommunityPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { disclosureApi, disclosureOperateApi } from '../services/api';\n\ninterface Disclosure {\n  disclosureId: number;\n  title: string;\n  content: string;\n  link: string;\n  disclosurePrice: number;\n  imgUrl?: string;\n  createTime: string;\n  authorName?: string;\n}\n\nconst CommunityPage: React.FC = () => {\n  const navigate = useNavigate();\n  const [disclosures, setDisclosures] = useState<Disclosure[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadDisclosures();\n  }, []);\n\n  const loadDisclosures = async () => {\n    try {\n      setLoading(true);\n      const res = await disclosureApi.getPublicDisclosure(1, 100);\n      setDisclosures(res.data.data || []);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const ensureLogin = () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      navigate('/login');\n      return false;\n    }\n    return true;\n  };\n\n  const handleLike = async (id: number) => {\n    if (!ensureLogin()) return;\n    await disclosureOperateApi.like(id);\n  };\n\n  const handleCollect = async (id: number) => {\n    if (!ensureLogin()) return;\n    await disclosureOperateApi.collect(id);\n  };\n\n  return (\n    <div className=\"community-page-wrapper\" style={{ maxWidth: '1200px', margin: '20px auto', padding: '0 15px' }}>\n      <h2 style={{ marginBottom: '20px' }}>みんなの投稿 (承認済み)</h2>\n      \n      {loading ? (\n        <div>読み込み中...</div>\n      ) : disclosures.length === 0 ? (\n        <div className=\"no-tips\">投稿がまだありません</div>\n      ) : (\n        <div className=\"community-grid\" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(280px, 1fr))', gap: '20px' }}>\n          {disclosures.map((item) => (\n            <div key={item.disclosureId} className=\"community-card\" style={{ border: '1px solid #eee', borderRadius: '8px', overflow: 'hidden', background: '#fff', boxShadow: '0 2px 4px rgba(0,0,0,0.05)' }}>\n              <div className=\"card-image\" style={{ height: '200px', background: '#f5f5f5', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                {item.imgUrl ? (\n                  <img src={item.imgUrl} alt={item.title} style={{ width: '100%', height: '100%', objectFit: 'contain' }} />\n                ) : (\n                  <span style={{ color: '#ccc' }}>No Image</span>\n                )}\n              </div>\n              <div className=\"card-content\" style={{ padding: '15px' }}>\n                <h3 style={{ margin: '0 0 10px', fontSize: '16px', lineHeight: '1.4', height: '44px', overflow: 'hidden' }}>{item.title}</h3>\n                <div style={{ color: '#ff5000', fontWeight: 'bold', fontSize: '18px', marginBottom: '10px' }}>¥{item.disclosurePrice}</div>\n                <p style={{ fontSize: '13px', color: '#666', marginBottom: '15px', height: '60px', overflow: 'hidden' }}>{item.content}</p>\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                  <span style={{ fontSize: '12px', color: '#999' }}>{new Date(item.createTime).toLocaleDateString()}</span>\n                  <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\" style={{ background: '#ff5000', color: '#fff', padding: '5px 15px', borderRadius: '15px', textDecoration: 'none', fontSize: '13px' }}>\n                    詳細へ\n                  </a>\n                  <div style={{ display: 'flex', gap: '8px' }}>\n                    <button onClick={() => handleLike(item.disclosureId)} style={{ border: '1px solid #ddd', background: '#fff', padding: '5px 10px', cursor: 'pointer' }}>点赞</button>\n                    <button onClick={() => handleCollect(item.disclosureId)} style={{ border: '1px solid #ddd', background: '#fff', padding: '5px 10px', cursor: 'pointer' }}>收藏</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommunityPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}