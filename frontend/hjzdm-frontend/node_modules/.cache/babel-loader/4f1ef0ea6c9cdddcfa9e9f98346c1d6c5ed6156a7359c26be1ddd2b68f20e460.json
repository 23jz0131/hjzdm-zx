{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\3jz\\\\Desktop\\\\HJZDM\\\\frontend\\\\hjzdm-frontend\\\\src\\\\pages\\\\ComparePage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport './ComparePage.css';\nimport { goodsApi, categoryApi, userApi, goodsOperateApi } from '../services/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ComparePage = () => {\n  _s();\n  const [searchParams] = useSearchParams();\n  const [query, setQuery] = useState(searchParams.get('query') || '');\n  const [compareGroups, setCompareGroups] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [sortOption, setSortOption] = useState('price_asc');\n  const [selectedPlatforms, setSelectedPlatforms] = useState([]);\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(50);\n  const [selectedKeys, setSelectedKeys] = useState([]);\n  const [selectedBrands, setSelectedBrands] = useState([]);\n  const [selectedSeries, setSelectedSeries] = useState([]);\n  const [selectedModels, setSelectedModels] = useState([]);\n  const [selectedStorage, setSelectedStorage] = useState([]);\n  const [selectedColors, setSelectedColors] = useState([]);\n  const [selectedSizes, setSelectedSizes] = useState([]);\n  const [selectedCategories, setSelectedCategories] = useState([]);\n  const [trendOpen, setTrendOpen] = useState(false);\n  const [trendLabels, setTrendLabels] = useState([]);\n  const [trendSeries, setTrendSeries] = useState([]);\n  const [trendTitle, setTrendTitle] = useState('');\n  const [collectedIds, setCollectedIds] = useState(new Set());\n\n  // Search Source\n  const [searchSource, setSearchSource] = useState('compare');\n  const [executedQuery, setExecutedQuery] = useState('');\n  const [totalItems, setTotalItems] = useState(0);\n\n  // Dynamic Filters State\n  const [categories, setCategories] = useState([]);\n  const [dynamicFilters, setDynamicFilters] = useState([]);\n  const [selectedDynamicFilters, setSelectedDynamicFilters] = useState({});\n  const [currentCatId, setCurrentCatId] = useState(null);\n\n  // Fetch categories on mount\n  useEffect(() => {\n    categoryApi.getList().then(res => {\n      if (res.data.code === 200) {\n        setCategories(res.data.data);\n      }\n    }).catch(err => console.error(\"Failed to fetch categories\", err));\n  }, []);\n\n  // 仅在页面加载时，如果有URL参数，则执行搜索\n  useEffect(() => {\n    if (query.trim()) {\n      searchProducts(query);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Fetch dynamic attributes when category changes\n  useEffect(() => {\n    if (currentCatId) {\n      categoryApi.getAttributes(currentCatId).then(res => {\n        if (res.data.code === 200) {\n          setDynamicFilters(res.data.data);\n        }\n      }).catch(err => console.error(\"Failed to fetch attributes\", err));\n    } else {\n      setDynamicFilters([]);\n    }\n  }, [currentCatId]);\n\n  // Auto-search when filters change (Local Mode only)\n  useEffect(() => {\n    if (searchSource === 'local') {\n      searchProducts(executedQuery || query);\n    }\n  }, [selectedDynamicFilters, currentCatId, currentPage, pageSize, searchSource, selectedPlatforms]);\n  useEffect(() => {\n    (async () => {\n      try {\n        const res = await goodsApi.getMyCollect(1, 500);\n        if (res.data && res.data.code === 200 && Array.isArray(res.data.data)) {\n          const ids = res.data.data.map(g => g.goodsId).filter(id => typeof id === 'number');\n          setCollectedIds(new Set(ids));\n        }\n      } catch (e) {}\n    })();\n  }, []);\n  const toggleCollect = async goodsId => {\n    try {\n      if (collectedIds.has(goodsId)) {\n        const res = await goodsOperateApi.cancelCollect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.delete(goodsId);\n            return next;\n          });\n        }\n      } else {\n        const res = await goodsOperateApi.collect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.add(goodsId);\n            return next;\n          });\n        } else {\n          alert('请先登录');\n        }\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n  const ensureGoodsIdAndCollect = async product => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        alert('请先登录');\n        return;\n      }\n      if (product.goodsId) {\n        await toggleCollect(product.goodsId);\n        return;\n      }\n      const payload = {\n        goodsName: product.goodsName,\n        goodsPrice: product.goodsPrice,\n        goodsLink: product.goodsLink,\n        imgUrl: product.imgUrl,\n        mallType: product.mallType,\n        status: 1\n      };\n      const addRes = await goodsApi.addAndReturn(payload);\n      if (addRes.data && addRes.data.code === 200 && addRes.data.data && addRes.data.data.goodsId) {\n        const newId = addRes.data.data.goodsId;\n        await toggleCollect(newId);\n      } else {\n        alert('新增商品失败');\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n  const searchProducts = async searchQuery => {\n    if (!searchQuery.trim() && searchSource === 'compare') return;\n    setExecutedQuery(searchQuery);\n    setLoading(true);\n    setError(null);\n    try {\n      if (searchSource === 'local') {\n        const minP = minPrice ? Number(minPrice) : undefined;\n        const maxP = maxPrice ? Number(maxPrice) : undefined;\n        console.log('Calling API: goodsApi.getGoodsPage', {\n          searchQuery,\n          selectedDynamicFilters,\n          currentCatId,\n          minP,\n          maxP,\n          selectedPlatforms\n        });\n        const response = await goodsApi.getGoodsPage(searchQuery, selectedDynamicFilters, currentCatId || undefined, currentPage, pageSize, minP, maxP, selectedPlatforms);\n        console.log('Local API Response:', response.data);\n        if (response.data && response.data.code === 200) {\n          const records = response.data.data.records || [];\n          setTotalItems(response.data.data.total || 0);\n          const processedData = records.map(g => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n          if (processedData.length === 0) {\n            try {\n              const cmpRes = await goodsApi.compareGoods(searchQuery);\n              let responseData = [];\n              if (cmpRes.data && cmpRes.data.data) {\n                responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n              }\n              let cmpProcessed = [];\n              if (responseData.length > 0) {\n                cmpProcessed = responseData.map(group => {\n                  const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                  let lowestPrice = null;\n                  let lowestPlatform = '不明';\n                  if (goodsList.length > 0) {\n                    const lowestProduct = goodsList.reduce((lowest, current) => current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                    lowestPrice = lowestProduct.goodsPrice;\n                    lowestPlatform = getPlatformName(lowestProduct.mallType);\n                  }\n                  return {\n                    goodsName: group.goodsName || '不明な商品',\n                    goodsList: goodsList.map(product => ({\n                      goodsId: product.goodsId,\n                      goodsName: product.goodsName,\n                      goodsPrice: product.goodsPrice,\n                      goodsLink: product.goodsLink,\n                      imgUrl: product.imgUrl,\n                      mallType: product.mallType\n                    })),\n                    lowestPrice,\n                    lowestPlatform\n                  };\n                });\n              }\n              setCompareGroups(cmpProcessed);\n              setLoading(false);\n              return;\n            } catch (e) {\n              console.error('Fallback compare search failed', e);\n            }\n          }\n          setCompareGroups(processedData);\n        } else {\n          setCompareGroups([]);\n          setTotalItems(0);\n          try {\n            const cmpRes = await goodsApi.compareGoods(searchQuery);\n            let responseData = [];\n            if (cmpRes.data && cmpRes.data.data) {\n              responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n            }\n            let processedData = [];\n            if (responseData.length > 0) {\n              processedData = responseData.map(group => {\n                const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                let lowestPrice = null;\n                let lowestPlatform = '不明';\n                if (goodsList.length > 0) {\n                  const lowestProduct = goodsList.reduce((lowest, current) => current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                  lowestPrice = lowestProduct.goodsPrice;\n                  lowestPlatform = getPlatformName(lowestProduct.mallType);\n                }\n                return {\n                  goodsName: group.goodsName || '不明な商品',\n                  goodsList: goodsList.map(product => ({\n                    goodsId: product.goodsId,\n                    goodsName: product.goodsName,\n                    goodsPrice: product.goodsPrice,\n                    goodsLink: product.goodsLink,\n                    imgUrl: product.imgUrl,\n                    mallType: product.mallType\n                  })),\n                  lowestPrice,\n                  lowestPlatform\n                };\n              });\n            }\n            setCompareGroups(processedData);\n          } catch (e) {\n            console.error('Fallback compare search failed', e);\n          }\n        }\n        setLoading(false);\n        return;\n      }\n      console.log('Calling API: goodsApi.compareGoods with query:', searchQuery); // デバッグ用ログ\n\n      // 使用api.ts中定义的API服务\n      const response = await goodsApi.compareGoods(searchQuery);\n      console.log('API Response:', response.data); // デバッグ用ログ\n\n      let responseData = [];\n      if (response.data && response.data.data) {\n        responseData = Array.isArray(response.data.data) ? response.data.data : [response.data.data];\n      } else {\n        responseData = [];\n      }\n      console.log('Raw Response Data:', responseData); // デバッグ用ログ\n\n      // レスポンスデータを処理\n      let processedData = [];\n      if (responseData.length > 0) {\n        // APIが返すグループデータを適切に処理\n        processedData = responseData.map(group => {\n          // グループ内の商品リストを処理\n          const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n\n          // 最低価格とプラットフォームを特定\n          let lowestPrice = null;\n          let lowestPlatform = '不明';\n\n          // 最低価格を計算\n          if (goodsList.length > 0) {\n            const lowestProduct = goodsList.reduce((lowest, current) => current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n            lowestPrice = lowestProduct.goodsPrice;\n            lowestPlatform = getPlatformName(lowestProduct.mallType);\n          }\n          return {\n            goodsName: group.goodsName || '不明な商品',\n            goodsList: goodsList.map(product => ({\n              goodsId: product.goodsId,\n              goodsName: product.goodsName,\n              goodsPrice: product.goodsPrice,\n              goodsLink: product.goodsLink,\n              imgUrl: product.imgUrl,\n              mallType: product.mallType\n            })),\n            lowestPrice: lowestPrice,\n            lowestPlatform: lowestPlatform\n          };\n        });\n        console.log('Processed grouped data:', processedData); // デバッグ用ログ\n      }\n\n      // Fallback: if compare returns empty, try local catalog search\n      if (processedData.length === 0) {\n        try {\n          const localRes = await goodsApi.getGoodsPage(searchQuery, undefined, undefined, currentPage, pageSize, undefined, undefined, selectedPlatforms);\n          if (localRes.data && localRes.data.code === 200) {\n            var _localRes$data$data, _localRes$data$data2;\n            const records = ((_localRes$data$data = localRes.data.data) === null || _localRes$data$data === void 0 ? void 0 : _localRes$data$data.records) || [];\n            setTotalItems(((_localRes$data$data2 = localRes.data.data) === null || _localRes$data$data2 === void 0 ? void 0 : _localRes$data$data2.total) || 0);\n            processedData = records.map(g => ({\n              goodsName: g.goodsName,\n              goodsList: [{\n                goodsId: g.goodsId,\n                goodsName: g.goodsName,\n                goodsPrice: g.goodsPrice,\n                goodsLink: g.goodsLink || '#',\n                imgUrl: g.imgUrl,\n                mallType: g.mallType || 0\n              }],\n              lowestPrice: g.goodsPrice,\n              lowestPlatform: getPlatformName(g.mallType || 0)\n            }));\n          }\n          // If still empty, try name-based search as last resort\n          if (processedData.length === 0) {\n            try {\n              const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n              const list = byNameRes.data && byNameRes.data.data ? Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data] : [];\n              processedData = list.map(g => ({\n                goodsName: g.goodsName,\n                goodsList: [{\n                  goodsId: g.goodsId,\n                  goodsName: g.goodsName,\n                  goodsPrice: g.goodsPrice,\n                  goodsLink: g.goodsLink || '#',\n                  imgUrl: g.imgUrl,\n                  mallType: g.mallType || 0\n                }],\n                lowestPrice: g.goodsPrice,\n                lowestPlatform: getPlatformName(g.mallType || 0)\n              }));\n            } catch (e) {\n              console.error('Name-based fallback search failed', e);\n            }\n          }\n        } catch (e) {\n          console.error('Local catalog fallback search failed', e);\n        }\n      }\n      console.log('Final processed data:', processedData); // デバッグ用ログ\n\n      setCompareGroups(processedData);\n      setLoading(false);\n    } catch (err) {\n      // On compare error, attempt fallbacks before showing error\n      try {\n        let processedData = [];\n        const localRes = await goodsApi.getGoodsPage(searchQuery, undefined, undefined, currentPage, pageSize, undefined, undefined, selectedPlatforms);\n        if (localRes.data && localRes.data.code === 200) {\n          var _localRes$data$data3, _localRes$data$data4;\n          const records = ((_localRes$data$data3 = localRes.data.data) === null || _localRes$data$data3 === void 0 ? void 0 : _localRes$data$data3.records) || [];\n          setTotalItems(((_localRes$data$data4 = localRes.data.data) === null || _localRes$data$data4 === void 0 ? void 0 : _localRes$data$data4.total) || 0);\n          processedData = records.map(g => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        if (processedData.length === 0) {\n          const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n          const list = byNameRes.data && byNameRes.data.data ? Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data] : [];\n          processedData = list.map(g => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        setCompareGroups(processedData);\n        setLoading(false);\n      } catch (fallbackErr) {\n        setError('検索に失敗しました。後ほど再試行してください');\n        setLoading(false);\n        console.error(fallbackErr);\n      }\n      console.error(err);\n    }\n  };\n  const handleSearch = e => {\n    e.preventDefault();\n    if (query.trim()) {\n      searchProducts(query);\n    }\n  };\n  const getPlatformName = mallType => {\n    switch (mallType) {\n      case 10:\n        return '楽天';\n      case 20:\n        return 'Yahoo!';\n      case 30:\n        return 'Taobao';\n      case 40:\n        return 'Amazon';\n      default:\n        return '其他';\n    }\n  };\n  const getPlatformColor = mallType => {\n    switch (mallType) {\n      case 10:\n        return '#bf0000';\n      // Rakuten Red\n      case 20:\n        return '#ff0033';\n      // Yahoo Red\n      case 30:\n        return '#ff5000';\n      // Taobao Orange\n      case 40:\n        return '#FF9900';\n      // Amazon Orange\n      default:\n        return '#666';\n    }\n  };\n  const getPlatformBadgeClass = mallType => {\n    switch (mallType) {\n      case 10:\n        return 'platform-badge rakuten';\n      case 20:\n        return 'platform-badge yahoo';\n      case 30:\n        return 'platform-badge taobao';\n      case 40:\n        return 'platform-badge amazon';\n      default:\n        return 'platform-badge unknown';\n    }\n  };\n  const allProducts = compareGroups.flatMap(group => group.goodsList);\n  const knownBrands = ['Apple', 'Samsung', 'Sony', 'Xiaomi', 'Huawei', 'Lenovo', 'Dell', 'HP', 'ASUS', 'Acer', 'Nintendo', 'Microsoft', 'Canon', 'Nikon'];\n  const parseFacets = name => {\n    const n = name || '';\n    const brand = knownBrands.find(b => new RegExp(b, 'i').test(n)) || '';\n    const seriesMatch = n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);\n    const series = seriesMatch ? seriesMatch[1] : '';\n    const modelMatch = n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);\n    const model = modelMatch ? modelMatch[1] : '';\n    const storageMatch = n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);\n    const storage = storageMatch ? storageMatch[1].replace(/\\s+/g, '') : '';\n    const colorMatch = n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight|ブラック|ホワイト|シルバー|ブルー|レッド|グリーン|ゴールド|ピンク|グレー|スペースグレイ|ミッドナイト)\\b/i);\n    const color = colorMatch ? colorMatch[1] : '';\n    const sizeMatch = n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);\n    const size = sizeMatch ? sizeMatch[1] : '';\n    return {\n      brand,\n      series,\n      model,\n      storage,\n      color,\n      size\n    };\n  };\n  const facetIndex = allProducts.map(p => parseFacets(p.goodsName));\n  const brands = Array.from(new Set(facetIndex.map(f => f.brand).filter(Boolean)));\n  const series = Array.from(new Set(facetIndex.map(f => f.series).filter(Boolean)));\n  const models = Array.from(new Set(facetIndex.map(f => f.model).filter(Boolean)));\n  const storages = Array.from(new Set(facetIndex.map(f => f.storage).filter(Boolean)));\n  const colors = Array.from(new Set(facetIndex.map(f => f.color).filter(Boolean)));\n  const sizes = Array.from(new Set(facetIndex.map(f => f.size).filter(Boolean)));\n  const parseCategory = name => {\n    const n = (name || '').toLowerCase();\n    if (/手机壳|ケース|保护壳|カバー/.test(n)) return {\n      parent: 'スマホアクセサリー',\n      child: 'ケース'\n    };\n    if (/iphone|galaxy|xiaomi|huawei|pixel|xperia/.test(n)) return {\n      parent: '携帯電話・スマートフォン',\n      child: 'スマートフォン本体'\n    };\n    if (/ipad|galaxy tab|surface|tablet/.test(n)) return {\n      parent: 'パソコン・タブレット',\n      child: 'タブレットPC'\n    };\n    if (/macbook|thinkpad|notebook|laptop/.test(n)) return {\n      parent: 'パソコン・タブレット',\n      child: 'ノートパソコン'\n    };\n    if (/monitor|display|显示器/.test(n)) return {\n      parent: 'パソコン周辺機器',\n      child: 'モニター'\n    };\n    if (/mouse|keyboard|鼠标|键盘/.test(n)) return {\n      parent: 'パソコン周辺機器',\n      child: 'キーボード・マウス'\n    };\n    if (/airpods|buds|wh-|wf-|耳机/.test(n)) return {\n      parent: 'オーディオ・楽器',\n      child: 'ヘッドホン・イヤホン'\n    };\n    if (/tv|bravia|regza|电视/.test(n)) return {\n      parent: 'テレビ・映像機器',\n      child: 'テレビ'\n    };\n    if (/camera|eos|alpha|相机/.test(n)) return {\n      parent: 'カメラ',\n      child: 'デジタルカメラ'\n    };\n    if (/lens|镜头/.test(n)) return {\n      parent: 'カメラ',\n      child: 'レンズ'\n    };\n    if (/fridge|refrigerator|冰箱/.test(n)) return {\n      parent: '生活家電',\n      child: '冷蔵庫'\n    };\n    if (/washing|washer|洗衣机/.test(n)) return {\n      parent: '生活家電',\n      child: '洗濯機'\n    };\n    return {\n      parent: 'その他',\n      child: 'その他'\n    };\n  };\n  const categoriesAll = Array.from(new Set(allProducts.map(p => {\n    const c = parseCategory(p.goodsName);\n    return `${c.parent}>${c.child}`;\n  }).filter(x => x !== '其他>其他')));\n\n  // Build hierarchy tree\n  const categoryTree = {};\n  categoriesAll.forEach(c => {\n    const [p, child] = c.split('>');\n    if (!categoryTree[p]) categoryTree[p] = [];\n    if (!categoryTree[p].includes(child)) categoryTree[p].push(child);\n  });\n  const filteredProducts = allProducts.filter(p => {\n    const platformOk = selectedPlatforms.length === 0 || selectedPlatforms.includes(p.mallType);\n    const minOk = minPrice === '' || !isNaN(Number(minPrice)) && p.goodsPrice >= Number(minPrice);\n    const maxOk = maxPrice === '' || !isNaN(Number(maxPrice)) && p.goodsPrice <= Number(maxPrice);\n    const f = parseFacets(p.goodsName);\n    const brandOk = selectedBrands.length === 0 || f.brand && selectedBrands.includes(f.brand);\n    const seriesOk = selectedSeries.length === 0 || f.series && selectedSeries.includes(f.series);\n    const modelOk = selectedModels.length === 0 || f.model && selectedModels.includes(f.model);\n    const storageOk = selectedStorage.length === 0 || f.storage && selectedStorage.includes(f.storage);\n    const colorOk = selectedColors.length === 0 || f.color && selectedColors.includes(f.color);\n    const sizeOk = selectedSizes.length === 0 || f.size && selectedSizes.includes(f.size);\n    const cat = parseCategory(p.goodsName);\n    const catStr = `${cat.parent}>${cat.child}`;\n    // Simplified category filter: check if any selected category string matches parent or full path\n    const categoryOk = selectedCategories.length === 0 || selectedCategories.some(sc => sc === cat.parent || sc === catStr);\n\n    // Filter out invalid products (no price or no link)\n    const validData = p.goodsPrice > 0 && p.goodsLink && p.goodsLink !== '#' && p.goodsLink !== '';\n    return platformOk && minOk && maxOk && brandOk && seriesOk && modelOk && storageOk && colorOk && sizeOk && categoryOk && validData;\n  });\n  const sortedProducts = [...filteredProducts].sort((a, b) => {\n    if (sortOption === 'price_asc') return a.goodsPrice - b.goodsPrice;\n    if (sortOption === 'price_desc') return b.goodsPrice - a.goodsPrice;\n    if (sortOption === 'platform') return a.mallType - b.mallType;\n    if (sortOption === 'name') return a.goodsName.localeCompare(b.goodsName);\n    return 0;\n  });\n  const togglePlatform = mt => {\n    setSelectedPlatforms(prev => prev.includes(mt) ? prev.filter(x => x !== mt) : [...prev, mt]);\n  };\n  const totalPages = searchSource === 'local' ? Math.max(1, Math.ceil(totalItems / pageSize)) : Math.max(1, Math.ceil(sortedProducts.length / pageSize));\n  const currentPageProducts = searchSource === 'local' ? sortedProducts : sortedProducts.slice((currentPage - 1) * pageSize, currentPage * pageSize);\n  const goPrev = () => setCurrentPage(p => Math.max(1, p - 1));\n  const goNext = () => setCurrentPage(p => Math.min(totalPages, p + 1));\n  const onChangePageSize = size => {\n    setPageSize(size);\n    setCurrentPage(1);\n  };\n  const getSelectKey = p => {\n    if (p.goodsId) return `id:${p.goodsId}`;\n    const base = `${p.mallType}-${p.goodsLink || ''}-${p.goodsName}`;\n    return `k:${base}`;\n  };\n  const isSelected = key => selectedKeys.includes(key);\n  const toggleSelect = p => {\n    const key = getSelectKey(p);\n    setSelectedKeys(prev => prev.includes(key) ? prev.filter(x => x !== key) : [...prev, key]);\n  };\n  const getSellerFromLink = url => {\n    if (!url) return '不明な店铺';\n    try {\n      const u = new URL(url.startsWith('http') ? url : 'https://' + url.replace(/^\\/\\//, ''));\n      return u.hostname.replace(/^www\\./, '');\n    } catch {\n      return '不明な店铺';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"compare-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"search-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u5546\\u54C1\\u4FA1\\u683C\\u6BD4\\u8F03\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 626,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSearch,\n        className: \"search-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: query,\n          onChange: e => setQuery(e.target.value) // 仅更新状态，不触发搜索\n          ,\n          placeholder: \"\\u5546\\u54C1\\u540D\\u3092\\u5165\\u529B\\u3057\\u3066\\u4FA1\\u683C\\u6BD4\\u8F03...\",\n          className: \"search-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 628,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"search-button\",\n          children: \"\\u641C\\u7D22\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 635,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 627,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 625,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"\\u691C\\u7D22\\u4E2D...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 639,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 640,\n      columnNumber: 17\n    }, this), !loading && !error && allProducts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"compare-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sidebar-section source-toggle-section\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"source-toggle\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `toggle-btn ${searchSource === 'local' ? 'active' : ''}`,\n              onClick: () => {\n                setSearchSource('local');\n                setCompareGroups([]);\n              },\n              children: \"Local Catalog\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 649,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `toggle-btn ${searchSource === 'compare' ? 'active' : ''}`,\n              onClick: () => {\n                setSearchSource('compare');\n                setCompareGroups([]);\n              },\n              children: \"Price Compare\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 655,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 647,\n          columnNumber: 13\n        }, this), searchSource === 'local' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sidebar-section category-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"sidebar-title\",\n            children: \"\\u5206\\u7C7B\\u7B5B\\u9009\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"category-tree\",\n            children: categories.map(cat => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: `category-item ${currentCatId === cat.catId ? 'active' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"category-label\",\n                onClick: () => setCurrentCatId(cat.catId === currentCatId ? null : cat.catId),\n                children: cat.catName\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 671,\n                columnNumber: 29\n              }, this), cat.children && cat.children.length > 0 && /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"category-children\",\n                children: cat.children.map(child => /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: `category-subitem ${currentCatId === child.catId ? 'active' : ''}`,\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    onClick: () => setCurrentCatId(child.catId === currentCatId ? null : child.catId),\n                    children: child.catName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 678,\n                    columnNumber: 45\n                  }, this)\n                }, child.catId, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 677,\n                  columnNumber: 41\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 675,\n                columnNumber: 33\n              }, this)]\n            }, cat.catId, true, {\n              fileName: _jsxFileName,\n              lineNumber: 670,\n              columnNumber: 25\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 668,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 666,\n          columnNumber: 17\n        }, this), searchSource === 'local' && dynamicFilters.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sidebar-section dynamic-filters\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"sidebar-title\",\n            children: \"\\u5C5E\\u6027\\u7B5B\\u9009\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 694,\n            columnNumber: 21\n          }, this), dynamicFilters.map(attr => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"filter-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: attr.attrName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 697,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"filter-options\",\n              children: attr.values && attr.values.map(val => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    checked: selectedDynamicFilters[attr.attrId] === val,\n                    onChange: () => {\n                      setSelectedDynamicFilters(prev => {\n                        if (prev[attr.attrId] === val) {\n                          const next = {\n                            ...prev\n                          };\n                          delete next[attr.attrId];\n                          return next;\n                        }\n                        return {\n                          ...prev,\n                          [attr.attrId]: val\n                        };\n                      });\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 702,\n                    columnNumber: 45\n                  }, this), val]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 701,\n                  columnNumber: 41\n                }, this)\n              }, val, false, {\n                fileName: _jsxFileName,\n                lineNumber: 700,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 698,\n              columnNumber: 29\n            }, this)]\n          }, attr.attrId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 25\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 693,\n          columnNumber: 17\n        }, this), searchSource === 'compare' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sidebar-section category-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"sidebar-title\",\n              children: \"\\u5206\\u7C7B\\u7B5B\\u9009\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 729,\n              columnNumber: 17\n            }, this), Object.keys(categoryTree).length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"category-list\",\n              children: Object.keys(categoryTree).map(parent => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: \"category-parent\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"parent-label\",\n                  onClick: () => {\n                    // Select/Deselect parent means select/deselect all children\n                    // Here we just toggle the parent string in selectedCategories\n                    setSelectedCategories(prev => prev.includes(parent) ? prev.filter(x => x !== parent && !x.startsWith(parent + '>')) : [...prev, parent]);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    checked: selectedCategories.includes(parent),\n                    readOnly: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 739,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: parent\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 740,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 734,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                  className: \"category-children\",\n                  children: categoryTree[parent].map(child => {\n                    const fullPath = `${parent}>${child}`;\n                    return /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: /*#__PURE__*/_jsxDEV(\"label\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                          type: \"checkbox\",\n                          checked: selectedCategories.includes(fullPath) || selectedCategories.includes(parent),\n                          onChange: () => {\n                            setSelectedCategories(prev => {\n                              const isParentSelected = prev.includes(parent);\n                              const isChildSelected = prev.includes(fullPath);\n                              if (isParentSelected) {\n                                const others = prev.filter(x => x !== parent && !x.startsWith(parent + '>'));\n                                const siblings = categoryTree[parent].map(c => `${parent}>${c}`);\n                                return [...others, ...siblings.filter(s => s !== fullPath)];\n                              }\n                              return isChildSelected ? prev.filter(x => x !== fullPath) : [...prev, fullPath];\n                            });\n                          }\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 748,\n                          columnNumber: 37\n                        }, this), child]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 747,\n                        columnNumber: 33\n                      }, this)\n                    }, fullPath, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 746,\n                      columnNumber: 33\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 742,\n                  columnNumber: 25\n                }, this)]\n              }, parent, true, {\n                fileName: _jsxFileName,\n                lineNumber: 733,\n                columnNumber: 25\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 731,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"no-filter-data\",\n              children: \"\\u65E0\\u5206\\u7C7B\\u6570\\u636E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 773,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 728,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sidebar-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"sidebar-title\",\n              children: \"\\u5236\\u9020\\u5546/\\u54C1\\u724C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 777,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"filter-list\",\n              children: brands.map(b => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    checked: selectedBrands.includes(b),\n                    onChange: () => setSelectedBrands(prev => prev.includes(b) ? prev.filter(x => x !== b) : [...prev, b])\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 782,\n                    columnNumber: 25\n                  }, this), b]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 781,\n                  columnNumber: 25\n                }, this)\n              }, b, false, {\n                fileName: _jsxFileName,\n                lineNumber: 780,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 778,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 776,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sidebar-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"sidebar-title\",\n              children: \"\\u89C4\\u683C\\u53C2\\u6570\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 795,\n              columnNumber: 17\n            }, this), series.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spec-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"\\u7CFB\\u5217\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 798,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"filter-list\",\n                children: series.slice(0, 10).map(s => /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: /*#__PURE__*/_jsxDEV(\"label\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: selectedSeries.includes(s),\n                      onChange: () => setSelectedSeries(prev => prev.includes(s) ? prev.filter(x => x !== s) : [...prev, s])\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 801,\n                      columnNumber: 44\n                    }, this), \" \", s]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 801,\n                    columnNumber: 37\n                  }, this)\n                }, s, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 801,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 799,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 797,\n              columnNumber: 21\n            }, this), storages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spec-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"\\u5BB9\\u91CF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 808,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"filter-list\",\n                children: storages.map(s => /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: /*#__PURE__*/_jsxDEV(\"label\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: selectedStorage.includes(s),\n                      onChange: () => setSelectedStorage(prev => prev.includes(s) ? prev.filter(x => x !== s) : [...prev, s])\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 811,\n                      columnNumber: 44\n                    }, this), \" \", s]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 811,\n                    columnNumber: 37\n                  }, this)\n                }, s, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 811,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 809,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 807,\n              columnNumber: 21\n            }, this), colors.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spec-group\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"\\u989C\\u8272\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 818,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"filter-list\",\n                children: colors.slice(0, 8).map(c => /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: /*#__PURE__*/_jsxDEV(\"label\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: selectedColors.includes(c),\n                      onChange: () => setSelectedColors(prev => prev.includes(c) ? prev.filter(x => x !== c) : [...prev, c])\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 821,\n                      columnNumber: 44\n                    }, this), \" \", c]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 821,\n                    columnNumber: 37\n                  }, this)\n                }, c, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 821,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 819,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 817,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 794,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sidebar-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"sidebar-title\",\n            children: \"\\u4EF7\\u683C\\u533A\\u95F4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 831,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"price-range-inputs\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              placeholder: \"\\xA5 min\",\n              value: minPrice,\n              onChange: e => setMinPrice(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 833,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              placeholder: \"\\xA5 max\",\n              value: maxPrice,\n              onChange: e => setMaxPrice(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 835,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 832,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"sidebar-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"sidebar-title\",\n            children: \"\\u5546\\u57CE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 840,\n            columnNumber: 16\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"filter-list\",\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: selectedPlatforms.includes(10),\n                  onChange: () => togglePlatform(10)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 842,\n                  columnNumber: 29\n                }, this), \" \\u697D\\u5929\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 842,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 842,\n              columnNumber: 18\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: selectedPlatforms.includes(20),\n                  onChange: () => togglePlatform(20)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 843,\n                  columnNumber: 29\n                }, this), \" Yahoo!\\u30B7\\u30E7\\u30C3\\u30D4\\u30F3\\u30B0\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 843,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 843,\n              columnNumber: 18\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: selectedPlatforms.includes(40),\n                  onChange: () => togglePlatform(40)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 844,\n                  columnNumber: 29\n                }, this), \" Amazon\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 844,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 844,\n              columnNumber: 18\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 841,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 839,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 645,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"results-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [\"\\\"\", query, \"\\\" \\u641C\\u7D22\\u7ED3\\u679C \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"(\", filteredProducts.length, \"\\u4EF6)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 852,\n              columnNumber: 34\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 852,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"sort-bar\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"sort-label\",\n              children: \"\\u6392\\u5E8F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 854,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `sort-tab ${sortOption === 'price_asc' ? 'active' : ''}`,\n              onClick: () => setSortOption('price_asc'),\n              children: \"\\u4EF7\\u683C\\u4F4E\\u5230\\u9AD8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 855,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `sort-tab ${sortOption === 'price_desc' ? 'active' : ''}`,\n              onClick: () => setSortOption('price_desc'),\n              children: \"\\u4EF7\\u683C\\u9AD8\\u5230\\u4F4E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 856,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `sort-tab ${sortOption === 'platform' ? 'active' : ''}`,\n              onClick: () => setSortOption('platform'),\n              children: \"\\u5546\\u57CE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 857,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 853,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 851,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-list-view\",\n          children: currentPageProducts.map((product, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-image\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: product.imgUrl || 'https://placehold.co/120x120',\n                alt: product.goodsName,\n                onError: e => e.target.src = 'https://placehold.co/120x120'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 865,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 864,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-title-row\",\n                children: /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: product.goodsLink,\n                  target: \"_blank\",\n                  rel: \"noopener noreferrer\",\n                  className: \"p-title\",\n                  onClick: () => {\n                    if (product.goodsId) {\n                      userApi.addHistory(product.goodsId);\n                    }\n                  },\n                  children: product.goodsName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 869,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 868,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-specs\",\n                children: function () {\n                  const f = parseFacets(product.goodsName);\n                  const parts = [f.brand, f.series, f.model, f.storage, f.color, f.size].filter(Boolean);\n                  return parts.join(' | ');\n                }()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 871,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-meta\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `mall-tag mall-${product.mallType}`,\n                  children: getPlatformName(product.mallType)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 879,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"seller\",\n                  children: getSellerFromLink(product.goodsLink)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 880,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 878,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 867,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-action\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-price\",\n                children: [product.goodsPrice.toLocaleString(), \"\\u5186\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 884,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                href: product.goodsLink,\n                target: \"_blank\",\n                rel: \"noopener noreferrer\",\n                className: \"btn-shop\",\n                onClick: () => {\n                  if (product.goodsId) {\n                    userApi.addHistory(product.goodsId);\n                  }\n                },\n                children: \"\\u524D\\u5F80\\u8D2D\\u4E70\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 885,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-trend\",\n                onClick: () => {\n                  ensureGoodsIdAndCollect(product);\n                },\n                children: product.goodsId && collectedIds.has(product.goodsId) ? '取消收藏' : '收藏'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 886,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-trend\",\n                onClick: () => {\n                  const title = product.goodsName;\n                  const labels = Array.from({\n                    length: 12\n                  }, (_, i) => {\n                    const d = new Date();\n                    d.setMonth(d.getMonth() - (11 - i));\n                    const m = (d.getMonth() + 1).toString().padStart(2, '0');\n                    return `${d.getFullYear()}-${m}`;\n                  });\n                  const base = Math.max(1, product.goodsPrice);\n                  let val = base * 1.0;\n                  const series = labels.map((_, i) => {\n                    const drift = 1 + Math.sin(i / 3) * 0.05;\n                    const noise = 1 + (Math.random() - 0.5) * 0.08;\n                    val = Math.max(1, val * drift * noise);\n                    return Math.round(val);\n                  });\n                  setTrendTitle(title);\n                  setTrendLabels(labels);\n                  setTrendSeries(series);\n                  setTrendOpen(true);\n                },\n                children: \"\\u4EF7\\u683C\\u8D70\\u52BF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 887,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"compare-check\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: isSelected(getSelectKey(product)),\n                  onChange: () => toggleSelect(product)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 909,\n                  columnNumber: 23\n                }, this), \" \\u5BF9\\u6BD4\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 908,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 883,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 863,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 861,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pagination-controls\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: goPrev,\n            disabled: currentPage === 1,\n            children: \"\\u4E0A\\u4E00\\u9875\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 917,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"page-info\",\n            children: [currentPage, \" / \", totalPages]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 918,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: goNext,\n            disabled: currentPage === totalPages,\n            children: \"\\u4E0B\\u4E00\\u9875\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 919,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 916,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 850,\n        columnNumber: 11\n      }, this), trendOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"price-trend-modal\",\n        onClick: () => setTrendOpen(false),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-content\",\n          onClick: e => e.stopPropagation(),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"modal-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"modal-title\",\n              children: trendTitle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 927,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"modal-close\",\n              onClick: () => setTrendOpen(false),\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 928,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 926,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"modal-body\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"trend-chart\",\n              children: function () {\n                const width = 600;\n                const height = 280;\n                const padding = 32;\n                const xs = trendSeries.map((_, i) => padding + i * (width - 2 * padding) / (trendSeries.length - 1));\n                const minV = Math.min(...trendSeries);\n                const maxV = Math.max(...trendSeries);\n                const ys = trendSeries.map(v => height - padding - (v - minV) / Math.max(1, maxV - minV) * (height - 2 * padding));\n                const path = xs.map((x, i) => `${i === 0 ? 'M' : 'L'}${x},${ys[i]}`).join(' ');\n                const gridY = [0.25, 0.5, 0.75].map(r => height - padding - r * (height - 2 * padding));\n                return /*#__PURE__*/_jsxDEV(\"svg\", {\n                  width: width,\n                  height: height,\n                  role: \"img\",\n                  \"aria-label\": \"\\u4EF7\\u683C\\u8D8B\\u52BF\\u56FE\",\n                  children: [gridY.map((gy, i) => /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: padding,\n                    y1: gy,\n                    x2: width - padding,\n                    y2: gy,\n                    stroke: \"#eee\"\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 945,\n                    columnNumber: 29\n                  }, this)), /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: path,\n                    fill: \"none\",\n                    stroke: \"#ff4400\",\n                    strokeWidth: 2\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 947,\n                    columnNumber: 27\n                  }, this), xs.map((x, i) => /*#__PURE__*/_jsxDEV(\"circle\", {\n                    cx: x,\n                    cy: ys[i],\n                    r: 3,\n                    fill: \"#ff4400\"\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 949,\n                    columnNumber: 29\n                  }, this)), /*#__PURE__*/_jsxDEV(\"text\", {\n                    x: padding,\n                    y: height - 8,\n                    fontSize: 12,\n                    fill: \"#999\",\n                    children: trendLabels[0]\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 951,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n                    x: width - padding - 60,\n                    y: height - 8,\n                    fontSize: 12,\n                    fill: \"#999\",\n                    children: trendLabels[trendLabels.length - 1]\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 952,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 943,\n                  columnNumber: 25\n                }, this);\n              }()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 931,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 930,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 924,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 643,\n      columnNumber: 9\n    }, this), !loading && !error && compareGroups.length === 0 && query && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"no-results\",\n      children: \"\\u95A2\\u9023\\u5546\\u54C1\\u304C\\u898B\\u3064\\u304B\\u308A\\u307E\\u305B\\u3093\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 965,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 624,\n    columnNumber: 5\n  }, this);\n};\n_s(ComparePage, \"Vyu/WqLNJS9JVa7CxLu2ifjCUlM=\", false, function () {\n  return [useSearchParams];\n});\n_c = ComparePage;\nexport default ComparePage;\nvar _c;\n$RefreshReg$(_c, \"ComparePage\");","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","goodsApi","categoryApi","userApi","goodsOperateApi","jsxDEV","_jsxDEV","Fragment","_Fragment","ComparePage","_s","searchParams","query","setQuery","get","compareGroups","setCompareGroups","loading","setLoading","error","setError","sortOption","setSortOption","selectedPlatforms","setSelectedPlatforms","minPrice","setMinPrice","maxPrice","setMaxPrice","currentPage","setCurrentPage","pageSize","setPageSize","selectedKeys","setSelectedKeys","selectedBrands","setSelectedBrands","selectedSeries","setSelectedSeries","selectedModels","setSelectedModels","selectedStorage","setSelectedStorage","selectedColors","setSelectedColors","selectedSizes","setSelectedSizes","selectedCategories","setSelectedCategories","trendOpen","setTrendOpen","trendLabels","setTrendLabels","trendSeries","setTrendSeries","trendTitle","setTrendTitle","collectedIds","setCollectedIds","Set","searchSource","setSearchSource","executedQuery","setExecutedQuery","totalItems","setTotalItems","categories","setCategories","dynamicFilters","setDynamicFilters","selectedDynamicFilters","setSelectedDynamicFilters","currentCatId","setCurrentCatId","getList","then","res","data","code","catch","err","console","trim","searchProducts","getAttributes","getMyCollect","Array","isArray","ids","map","g","goodsId","filter","id","e","toggleCollect","has","cancelCollect","prev","next","delete","collect","add","alert","ensureGoodsIdAndCollect","product","token","localStorage","getItem","payload","goodsName","goodsPrice","goodsLink","imgUrl","mallType","status","addRes","addAndReturn","newId","searchQuery","minP","Number","undefined","maxP","log","response","getGoodsPage","records","total","processedData","goodsList","lowestPrice","lowestPlatform","getPlatformName","length","cmpRes","compareGoods","responseData","cmpProcessed","group","lowestProduct","reduce","lowest","current","localRes","_localRes$data$data","_localRes$data$data2","byNameRes","searchGoodsByName","list","_localRes$data$data3","_localRes$data$data4","fallbackErr","handleSearch","preventDefault","getPlatformColor","getPlatformBadgeClass","allProducts","flatMap","knownBrands","parseFacets","name","n","brand","find","b","RegExp","test","seriesMatch","match","series","modelMatch","model","storageMatch","storage","replace","colorMatch","color","sizeMatch","size","facetIndex","p","brands","from","f","Boolean","models","storages","colors","sizes","parseCategory","toLowerCase","parent","child","categoriesAll","c","x","categoryTree","forEach","split","includes","push","filteredProducts","platformOk","minOk","isNaN","maxOk","brandOk","seriesOk","modelOk","storageOk","colorOk","sizeOk","cat","catStr","categoryOk","some","sc","validData","sortedProducts","sort","a","localeCompare","togglePlatform","mt","totalPages","Math","max","ceil","currentPageProducts","slice","goPrev","goNext","min","onChangePageSize","getSelectKey","base","isSelected","key","toggleSelect","getSellerFromLink","url","u","URL","startsWith","hostname","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","value","onChange","target","placeholder","onClick","catId","catName","attr","attrName","values","val","checked","attrId","Object","keys","readOnly","fullPath","isParentSelected","isChildSelected","others","siblings","s","index","src","alt","onError","href","rel","addHistory","parts","join","toLocaleString","title","labels","_","i","d","Date","setMonth","getMonth","m","toString","padStart","getFullYear","drift","sin","noise","random","round","disabled","stopPropagation","width","height","padding","xs","minV","maxV","ys","v","path","gridY","r","role","gy","x1","y1","x2","y2","stroke","fill","strokeWidth","cx","cy","y","fontSize","_c","$RefreshReg$"],"sources":["C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/src/pages/ComparePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport './ComparePage.css';\nimport { goodsApi, categoryApi, userApi, goodsOperateApi } from '../services/api';\n\ninterface Product {\n  goodsId?: number;\n  goodsName: string;\n  goodsPrice: number;\n  goodsLink: string;\n  imgUrl?: string;\n  mallType: number;\n}\n\ninterface CompareGroup {\n  goodsName: string;\n  goodsList: Product[];\n  lowestPrice: number | null;\n  lowestPlatform?: string;\n}\n\nconst ComparePage: React.FC = () => {\n  const [searchParams] = useSearchParams();\n  const [query, setQuery] = useState(searchParams.get('query') || '');\n  const [compareGroups, setCompareGroups] = useState<CompareGroup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [sortOption, setSortOption] = useState('price_asc');\n  const [selectedPlatforms, setSelectedPlatforms] = useState<number[]>([]);\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(50);\n  const [selectedKeys, setSelectedKeys] = useState<string[]>([]);\n  const [selectedBrands, setSelectedBrands] = useState<string[]>([]);\n  const [selectedSeries, setSelectedSeries] = useState<string[]>([]);\n  const [selectedModels, setSelectedModels] = useState<string[]>([]);\n  const [selectedStorage, setSelectedStorage] = useState<string[]>([]);\n  const [selectedColors, setSelectedColors] = useState<string[]>([]);\n  const [selectedSizes, setSelectedSizes] = useState<string[]>([]);\n  const [selectedCategories, setSelectedCategories] = useState<string[]>([]);\n  const [trendOpen, setTrendOpen] = useState(false);\n  const [trendLabels, setTrendLabels] = useState<string[]>([]);\n  const [trendSeries, setTrendSeries] = useState<number[]>([]);\n  const [trendTitle, setTrendTitle] = useState('');\n  const [collectedIds, setCollectedIds] = useState<Set<number>>(new Set());\n\n  // Search Source\n  const [searchSource, setSearchSource] = useState<'local' | 'compare'>('compare');\n  const [executedQuery, setExecutedQuery] = useState('');\n  const [totalItems, setTotalItems] = useState(0);\n\n  // Dynamic Filters State\n  const [categories, setCategories] = useState<any[]>([]);\n  const [dynamicFilters, setDynamicFilters] = useState<any[]>([]);\n  const [selectedDynamicFilters, setSelectedDynamicFilters] = useState<Record<string, string>>({});\n  const [currentCatId, setCurrentCatId] = useState<number | null>(null);\n\n  // Fetch categories on mount\n  useEffect(() => {\n    categoryApi.getList().then(res => {\n      if (res.data.code === 200) {\n        setCategories(res.data.data);\n      }\n    }).catch(err => console.error(\"Failed to fetch categories\", err));\n  }, []);\n\n  // 仅在页面加载时，如果有URL参数，则执行搜索\n  useEffect(() => {\n    if (query.trim()) {\n      searchProducts(query);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Fetch dynamic attributes when category changes\n  useEffect(() => {\n    if (currentCatId) {\n      categoryApi.getAttributes(currentCatId).then(res => {\n        if (res.data.code === 200) {\n          setDynamicFilters(res.data.data);\n        }\n      }).catch(err => console.error(\"Failed to fetch attributes\", err));\n    } else {\n        setDynamicFilters([]);\n    }\n  }, [currentCatId]);\n\n  // Auto-search when filters change (Local Mode only)\n  useEffect(() => {\n    if (searchSource === 'local') {\n      searchProducts(executedQuery || query);\n    }\n  }, [selectedDynamicFilters, currentCatId, currentPage, pageSize, searchSource, selectedPlatforms]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const res = await goodsApi.getMyCollect(1, 500);\n        if (res.data && res.data.code === 200 && Array.isArray(res.data.data)) {\n          const ids = res.data.data.map((g: any) => g.goodsId).filter((id: any) => typeof id === 'number');\n          setCollectedIds(new Set(ids));\n        }\n      } catch (e) {\n      }\n    })();\n  }, []);\n\n  const toggleCollect = async (goodsId: number) => {\n    try {\n      if (collectedIds.has(goodsId)) {\n        const res = await goodsOperateApi.cancelCollect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.delete(goodsId);\n            return next;\n          });\n        }\n      } else {\n        const res = await goodsOperateApi.collect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.add(goodsId);\n            return next;\n          });\n        } else {\n          alert('请先登录');\n        }\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n\n  const ensureGoodsIdAndCollect = async (product: Product) => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        alert('请先登录');\n        return;\n      }\n      if (product.goodsId) {\n        await toggleCollect(product.goodsId);\n        return;\n      }\n      const payload: any = {\n        goodsName: product.goodsName,\n        goodsPrice: product.goodsPrice,\n        goodsLink: product.goodsLink,\n        imgUrl: product.imgUrl,\n        mallType: product.mallType,\n        status: 1\n      };\n      const addRes = await goodsApi.addAndReturn(payload);\n      if (addRes.data && addRes.data.code === 200 && addRes.data.data && addRes.data.data.goodsId) {\n        const newId = addRes.data.data.goodsId as number;\n        await toggleCollect(newId);\n      } else {\n        alert('新增商品失败');\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n\n  const searchProducts = async (searchQuery: string) => {\n    if (!searchQuery.trim() && searchSource === 'compare') return;\n    \n    setExecutedQuery(searchQuery);\n    setLoading(true);\n    setError(null);\n    \n    try {\n      if (searchSource === 'local') {\n        const minP = minPrice ? Number(minPrice) : undefined;\n        const maxP = maxPrice ? Number(maxPrice) : undefined;\n        console.log('Calling API: goodsApi.getGoodsPage', { searchQuery, selectedDynamicFilters, currentCatId, minP, maxP, selectedPlatforms });\n        const response = await goodsApi.getGoodsPage(searchQuery, selectedDynamicFilters, currentCatId || undefined, currentPage, pageSize, minP, maxP, selectedPlatforms);\n        console.log('Local API Response:', response.data);\n\n        if (response.data && response.data.code === 200) {\n          const records = response.data.data.records || [];\n          setTotalItems(response.data.data.total || 0);\n          const processedData = records.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n          if (processedData.length === 0) {\n            try {\n              const cmpRes = await goodsApi.compareGoods(searchQuery);\n              let responseData: any[] = [];\n              if (cmpRes.data && cmpRes.data.data) {\n                responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n              }\n              let cmpProcessed: any[] = [];\n              if (responseData.length > 0) {\n                cmpProcessed = responseData.map((group: any) => {\n                  const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                  let lowestPrice: number | null = null;\n                  let lowestPlatform = '不明';\n                  if (goodsList.length > 0) {\n                    const lowestProduct = goodsList.reduce((lowest: any, current: any) =>\n                      current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                    lowestPrice = lowestProduct.goodsPrice;\n                    lowestPlatform = getPlatformName(lowestProduct.mallType);\n                  }\n                  return {\n                    goodsName: group.goodsName || '不明な商品',\n                    goodsList: goodsList.map((product: any) => ({\n                      goodsId: product.goodsId,\n                      goodsName: product.goodsName,\n                      goodsPrice: product.goodsPrice,\n                      goodsLink: product.goodsLink,\n                      imgUrl: product.imgUrl,\n                      mallType: product.mallType\n                    })),\n                    lowestPrice,\n                    lowestPlatform\n                  };\n                });\n              }\n              setCompareGroups(cmpProcessed);\n              setLoading(false);\n              return;\n            } catch (e) {\n              console.error('Fallback compare search failed', e);\n            }\n          }\n          setCompareGroups(processedData);\n        } else {\n          setCompareGroups([]);\n          setTotalItems(0);\n          try {\n            const cmpRes = await goodsApi.compareGoods(searchQuery);\n            let responseData: any[] = [];\n            if (cmpRes.data && cmpRes.data.data) {\n              responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n            }\n            let processedData: any[] = [];\n            if (responseData.length > 0) {\n              processedData = responseData.map((group: any) => {\n                const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                let lowestPrice: number | null = null;\n                let lowestPlatform = '不明';\n                if (goodsList.length > 0) {\n                  const lowestProduct = goodsList.reduce((lowest: any, current: any) =>\n                    current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                  lowestPrice = lowestProduct.goodsPrice;\n                  lowestPlatform = getPlatformName(lowestProduct.mallType);\n                }\n                return {\n                  goodsName: group.goodsName || '不明な商品',\n                  goodsList: goodsList.map((product: any) => ({\n                    goodsId: product.goodsId,\n                    goodsName: product.goodsName,\n                    goodsPrice: product.goodsPrice,\n                    goodsLink: product.goodsLink,\n                    imgUrl: product.imgUrl,\n                    mallType: product.mallType\n                  })),\n                  lowestPrice,\n                  lowestPlatform\n                };\n              });\n            }\n            setCompareGroups(processedData);\n          } catch (e) {\n            console.error('Fallback compare search failed', e);\n          }\n        }\n        setLoading(false);\n        return;\n      }\n\n      console.log('Calling API: goodsApi.compareGoods with query:', searchQuery); // デバッグ用ログ\n      \n      // 使用api.ts中定义的API服务\n      const response = await goodsApi.compareGoods(searchQuery);\n      \n      console.log('API Response:', response.data); // デバッグ用ログ\n      \n      let responseData = [];\n      if (response.data && response.data.data) {\n        responseData = Array.isArray(response.data.data) ? response.data.data : [response.data.data];\n      } else {\n        responseData = [];\n      }\n      \n      console.log('Raw Response Data:', responseData); // デバッグ用ログ\n      \n      // レスポンスデータを処理\n      let processedData: any[] = [];\n      \n      if (responseData.length > 0) {\n        // APIが返すグループデータを適切に処理\n        processedData = responseData.map((group: any) => {\n          // グループ内の商品リストを処理\n          const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n          \n          // 最低価格とプラットフォームを特定\n          let lowestPrice = null;\n          let lowestPlatform = '不明';\n          \n          // 最低価格を計算\n          if (goodsList.length > 0) {\n            const lowestProduct = goodsList.reduce((lowest: any, current: any) => \n              current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n            \n            lowestPrice = lowestProduct.goodsPrice;\n            lowestPlatform = getPlatformName(lowestProduct.mallType);\n          }\n          \n          return {\n            goodsName: group.goodsName || '不明な商品',\n            goodsList: goodsList.map((product: any) => ({\n              goodsId: product.goodsId,\n              goodsName: product.goodsName,\n              goodsPrice: product.goodsPrice,\n              goodsLink: product.goodsLink,\n              imgUrl: product.imgUrl,\n              mallType: product.mallType\n            })),\n            lowestPrice: lowestPrice,\n            lowestPlatform: lowestPlatform\n          };\n        });\n        \n        console.log('Processed grouped data:', processedData); // デバッグ用ログ\n      }\n\n      // Fallback: if compare returns empty, try local catalog search\n      if (processedData.length === 0) {\n        try {\n          const localRes = await goodsApi.getGoodsPage(\n            searchQuery,\n            undefined,\n            undefined,\n            currentPage,\n            pageSize,\n            undefined,\n            undefined,\n            selectedPlatforms\n          );\n          if (localRes.data && localRes.data.code === 200) {\n            const records = localRes.data.data?.records || [];\n            setTotalItems(localRes.data.data?.total || 0);\n            processedData = records.map((g: any) => ({\n              goodsName: g.goodsName,\n              goodsList: [{\n                goodsId: g.goodsId,\n                goodsName: g.goodsName,\n                goodsPrice: g.goodsPrice,\n                goodsLink: g.goodsLink || '#',\n                imgUrl: g.imgUrl,\n                mallType: g.mallType || 0\n              }],\n              lowestPrice: g.goodsPrice,\n              lowestPlatform: getPlatformName(g.mallType || 0)\n            }));\n          }\n          // If still empty, try name-based search as last resort\n          if (processedData.length === 0) {\n            try {\n              const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n              const list = (byNameRes.data && byNameRes.data.data)\n                ? (Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data])\n                : [];\n              processedData = list.map((g: any) => ({\n                goodsName: g.goodsName,\n                goodsList: [{\n                  goodsId: g.goodsId,\n                  goodsName: g.goodsName,\n                  goodsPrice: g.goodsPrice,\n                  goodsLink: g.goodsLink || '#',\n                  imgUrl: g.imgUrl,\n                  mallType: g.mallType || 0\n                }],\n                lowestPrice: g.goodsPrice,\n                lowestPlatform: getPlatformName(g.mallType || 0)\n              }));\n            } catch (e) {\n              console.error('Name-based fallback search failed', e);\n            }\n          }\n        } catch (e) {\n          console.error('Local catalog fallback search failed', e);\n        }\n      }\n      \n      console.log('Final processed data:', processedData); // デバッグ用ログ\n      \n      setCompareGroups(processedData);\n      setLoading(false);\n    } catch (err) {\n      // On compare error, attempt fallbacks before showing error\n      try {\n        let processedData: any[] = [];\n        const localRes = await goodsApi.getGoodsPage(\n          searchQuery,\n          undefined,\n          undefined,\n          currentPage,\n          pageSize,\n          undefined,\n          undefined,\n          selectedPlatforms\n        );\n        if (localRes.data && localRes.data.code === 200) {\n          const records = localRes.data.data?.records || [];\n          setTotalItems(localRes.data.data?.total || 0);\n          processedData = records.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        if (processedData.length === 0) {\n          const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n          const list = (byNameRes.data && byNameRes.data.data)\n            ? (Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data])\n            : [];\n          processedData = list.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        setCompareGroups(processedData);\n        setLoading(false);\n      } catch (fallbackErr) {\n        setError('検索に失敗しました。後ほど再試行してください');\n        setLoading(false);\n        console.error(fallbackErr);\n      }\n      console.error(err);\n    }\n  };\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      searchProducts(query);\n    }\n  };\n\n  const getPlatformName = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '楽天';\n      case 20: return 'Yahoo!';\n      case 30: return 'Taobao';\n      case 40: return 'Amazon';\n      default: return '其他';\n    }\n  };\n\n  const getPlatformColor = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '#bf0000'; // Rakuten Red\n      case 20: return '#ff0033'; // Yahoo Red\n      case 30: return '#ff5000'; // Taobao Orange\n      case 40: return '#FF9900'; // Amazon Orange\n      default: return '#666';\n    }\n  };\n\n  const getPlatformBadgeClass = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return 'platform-badge rakuten';\n      case 20: return 'platform-badge yahoo';\n      case 30: return 'platform-badge taobao';\n      case 40: return 'platform-badge amazon';\n      default: return 'platform-badge unknown';\n    }\n  };\n\n  const allProducts: Product[] = compareGroups.flatMap(group => group.goodsList);\n  const knownBrands = ['Apple','Samsung','Sony','Xiaomi','Huawei','Lenovo','Dell','HP','ASUS','Acer','Nintendo','Microsoft','Canon','Nikon'];\n  const parseFacets = (name: string) => {\n    const n = name || '';\n    const brand = knownBrands.find(b => new RegExp(b, 'i').test(n)) || '';\n    const seriesMatch = n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);\n    const series = seriesMatch ? seriesMatch[1] : '';\n    const modelMatch = n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);\n    const model = modelMatch ? modelMatch[1] : '';\n    const storageMatch = n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);\n    const storage = storageMatch ? storageMatch[1].replace(/\\s+/g,'') : '';\n    const colorMatch = n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight|ブラック|ホワイト|シルバー|ブルー|レッド|グリーン|ゴールド|ピンク|グレー|スペースグレイ|ミッドナイト)\\b/i);\n    const color = colorMatch ? colorMatch[1] : '';\n    const sizeMatch = n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);\n    const size = sizeMatch ? sizeMatch[1] : '';\n    return { brand, series, model, storage, color, size };\n  };\n  const facetIndex = allProducts.map(p => parseFacets(p.goodsName));\n  const brands = Array.from(new Set(facetIndex.map(f => f.brand).filter(Boolean)));\n  const series = Array.from(new Set(facetIndex.map(f => f.series).filter(Boolean)));\n  const models = Array.from(new Set(facetIndex.map(f => f.model).filter(Boolean)));\n  const storages = Array.from(new Set(facetIndex.map(f => f.storage).filter(Boolean)));\n  const colors = Array.from(new Set(facetIndex.map(f => f.color).filter(Boolean)));\n  const sizes = Array.from(new Set(facetIndex.map(f => f.size).filter(Boolean)));\n  const parseCategory = (name: string) => {\n    const n = (name || '').toLowerCase();\n    if (/手机壳|ケース|保护壳|カバー/.test(n)) return { parent: 'スマホアクセサリー', child: 'ケース' };\n    if (/iphone|galaxy|xiaomi|huawei|pixel|xperia/.test(n)) return { parent: '携帯電話・スマートフォン', child: 'スマートフォン本体' };\n    if (/ipad|galaxy tab|surface|tablet/.test(n)) return { parent: 'パソコン・タブレット', child: 'タブレットPC' };\n    if (/macbook|thinkpad|notebook|laptop/.test(n)) return { parent: 'パソコン・タブレット', child: 'ノートパソコン' };\n    if (/monitor|display|显示器/.test(n)) return { parent: 'パソコン周辺機器', child: 'モニター' };\n    if (/mouse|keyboard|鼠标|键盘/.test(n)) return { parent: 'パソコン周辺機器', child: 'キーボード・マウス' };\n    if (/airpods|buds|wh-|wf-|耳机/.test(n)) return { parent: 'オーディオ・楽器', child: 'ヘッドホン・イヤホン' };\n    if (/tv|bravia|regza|电视/.test(n)) return { parent: 'テレビ・映像機器', child: 'テレビ' };\n    if (/camera|eos|alpha|相机/.test(n)) return { parent: 'カメラ', child: 'デジタルカメラ' };\n    if (/lens|镜头/.test(n)) return { parent: 'カメラ', child: 'レンズ' };\n    if (/fridge|refrigerator|冰箱/.test(n)) return { parent: '生活家電', child: '冷蔵庫' };\n    if (/washing|washer|洗衣机/.test(n)) return { parent: '生活家電', child: '洗濯機' };\n    return { parent: 'その他', child: 'その他' };\n  };\n  \n  const categoriesAll = Array.from(new Set(allProducts.map(p => {\n    const c = parseCategory(p.goodsName);\n    return `${c.parent}>${c.child}`;\n  }).filter(x => x !== '其他>其他')));\n  \n  // Build hierarchy tree\n  const categoryTree: Record<string, string[]> = {};\n  categoriesAll.forEach(c => {\n    const [p, child] = c.split('>');\n    if (!categoryTree[p]) categoryTree[p] = [];\n    if (!categoryTree[p].includes(child)) categoryTree[p].push(child);\n  });\n\n  const filteredProducts: Product[] = allProducts.filter(p => {\n    const platformOk = selectedPlatforms.length === 0 || selectedPlatforms.includes(p.mallType);\n    const minOk = minPrice === '' || (!isNaN(Number(minPrice)) && p.goodsPrice >= Number(minPrice));\n    const maxOk = maxPrice === '' || (!isNaN(Number(maxPrice)) && p.goodsPrice <= Number(maxPrice));\n    const f = parseFacets(p.goodsName);\n    const brandOk = selectedBrands.length === 0 || (f.brand && selectedBrands.includes(f.brand));\n    const seriesOk = selectedSeries.length === 0 || (f.series && selectedSeries.includes(f.series));\n    const modelOk = selectedModels.length === 0 || (f.model && selectedModels.includes(f.model));\n    const storageOk = selectedStorage.length === 0 || (f.storage && selectedStorage.includes(f.storage));\n    const colorOk = selectedColors.length === 0 || (f.color && selectedColors.includes(f.color));\n    const sizeOk = selectedSizes.length === 0 || (f.size && selectedSizes.includes(f.size));\n    \n    const cat = parseCategory(p.goodsName);\n    const catStr = `${cat.parent}>${cat.child}`;\n    // Simplified category filter: check if any selected category string matches parent or full path\n    const categoryOk = selectedCategories.length === 0 || \n      selectedCategories.some(sc => sc === cat.parent || sc === catStr);\n\n    // Filter out invalid products (no price or no link)\n    const validData = p.goodsPrice > 0 && p.goodsLink && p.goodsLink !== '#' && p.goodsLink !== '';\n\n    return platformOk && minOk && maxOk && brandOk && seriesOk && modelOk && storageOk && colorOk && sizeOk && categoryOk && validData;\n  });\n  const sortedProducts: Product[] = [...filteredProducts].sort((a, b) => {\n    if (sortOption === 'price_asc') return a.goodsPrice - b.goodsPrice;\n    if (sortOption === 'price_desc') return b.goodsPrice - a.goodsPrice;\n    if (sortOption === 'platform') return a.mallType - b.mallType;\n    if (sortOption === 'name') return a.goodsName.localeCompare(b.goodsName);\n    return 0;\n  });\n  const togglePlatform = (mt: number) => {\n    setSelectedPlatforms(prev => prev.includes(mt) ? prev.filter(x => x !== mt) : [...prev, mt]);\n  };\n\n  const totalPages = searchSource === 'local' \n    ? Math.max(1, Math.ceil(totalItems / pageSize)) \n    : Math.max(1, Math.ceil(sortedProducts.length / pageSize));\n  \n  const currentPageProducts = searchSource === 'local' \n    ? sortedProducts \n    : sortedProducts.slice((currentPage - 1) * pageSize, currentPage * pageSize);\n  const goPrev = () => setCurrentPage(p => Math.max(1, p - 1));\n  const goNext = () => setCurrentPage(p => Math.min(totalPages, p + 1));\n  const onChangePageSize = (size: number) => { setPageSize(size); setCurrentPage(1); };\n\n  const getSelectKey = (p: Product) => {\n    if (p.goodsId) return `id:${p.goodsId}`;\n    const base = `${p.mallType}-${p.goodsLink || ''}-${p.goodsName}`;\n    return `k:${base}`;\n  };\n  const isSelected = (key: string) => selectedKeys.includes(key);\n  const toggleSelect = (p: Product) => {\n    const key = getSelectKey(p);\n    setSelectedKeys(prev => prev.includes(key) ? prev.filter(x => x !== key) : [...prev, key]);\n  };\n\n  const getSellerFromLink = (url?: string) => {\n    if (!url) return '不明な店铺';\n    try {\n      const u = new URL(url.startsWith('http') ? url : ('https://' + url.replace(/^\\/\\//, '')));\n      return u.hostname.replace(/^www\\./, '');\n    } catch {\n      return '不明な店铺';\n    }\n  };\n\n  return (\n    <div className=\"compare-page\">\n      <div className=\"search-section\">\n        <h1>商品価格比較</h1>\n        <form onSubmit={handleSearch} className=\"search-form\">\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)} // 仅更新状态，不触发搜索\n            placeholder=\"商品名を入力して価格比較...\"\n            className=\"search-input\"\n          />\n          <button type=\"submit\" className=\"search-button\">搜索</button>\n        </form>\n      </div>\n\n      {loading && <div className=\"loading\">検索中...</div>}\n      {error && <div className=\"error\">{error}</div>}\n\n      {!loading && !error && allProducts.length > 0 && (\n        <div className=\"compare-container\">\n          {/* Sidebar Filters */}\n          <div className=\"sidebar\">\n            {/* Search Source Toggle */}\n            <div className=\"sidebar-section source-toggle-section\">\n                <div className=\"source-toggle\">\n                    <button \n                        className={`toggle-btn ${searchSource === 'local' ? 'active' : ''}`}\n                        onClick={() => { setSearchSource('local'); setCompareGroups([]); }}\n                    >\n                        Local Catalog\n                    </button>\n                    <button \n                        className={`toggle-btn ${searchSource === 'compare' ? 'active' : ''}`}\n                        onClick={() => { setSearchSource('compare'); setCompareGroups([]); }}\n                    >\n                        Price Compare\n                    </button>\n                </div>\n            </div>\n\n            {/* Category Tree (Local Mode) */}\n            {searchSource === 'local' && (\n                <div className=\"sidebar-section category-section\">\n                  <h3 className=\"sidebar-title\">分类筛选</h3>\n                  <ul className=\"category-tree\">\n                    {categories.map(cat => (\n                        <li key={cat.catId} className={`category-item ${currentCatId === cat.catId ? 'active' : ''}`}>\n                            <div className=\"category-label\" onClick={() => setCurrentCatId(cat.catId === currentCatId ? null : cat.catId)}>\n                                {cat.catName}\n                            </div>\n                            {cat.children && cat.children.length > 0 && (\n                                <ul className=\"category-children\">\n                                    {cat.children.map((child: any) => (\n                                        <li key={child.catId} className={`category-subitem ${currentCatId === child.catId ? 'active' : ''}`}>\n                                            <span onClick={() => setCurrentCatId(child.catId === currentCatId ? null : child.catId)}>\n                                                {child.catName}\n                                            </span>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </li>\n                    ))}\n                  </ul>\n                </div>\n            )}\n\n            {/* Dynamic Filters (Local Mode + Category Selected) */}\n            {searchSource === 'local' && dynamicFilters.length > 0 && (\n                <div className=\"sidebar-section dynamic-filters\">\n                    <h3 className=\"sidebar-title\">属性筛选</h3>\n                    {dynamicFilters.map(attr => (\n                        <div key={attr.attrId} className=\"filter-group\">\n                            <h4>{attr.attrName}</h4>\n                            <ul className=\"filter-options\">\n                                {attr.values && attr.values.map((val: string) => (\n                                    <li key={val}>\n                                        <label>\n                                            <input \n                                                type=\"checkbox\"\n                                                checked={selectedDynamicFilters[attr.attrId] === val}\n                                                onChange={() => {\n                                                    setSelectedDynamicFilters(prev => {\n                                                        if (prev[attr.attrId] === val) {\n                                                            const next = { ...prev };\n                                                            delete next[attr.attrId];\n                                                            return next;\n                                                        }\n                                                        return { ...prev, [attr.attrId]: val };\n                                                    });\n                                                }}\n                                            />\n                                            {val}\n                                        </label>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    ))}\n                </div>\n            )}\n\n            {searchSource === 'compare' && (\n                <>\n                <div className=\"sidebar-section category-section\">\n                <h3 className=\"sidebar-title\">分类筛选</h3>\n                {Object.keys(categoryTree).length > 0 ? (\n                    <ul className=\"category-list\">\n                    {Object.keys(categoryTree).map(parent => (\n                        <li key={parent} className=\"category-parent\">\n                        <div className=\"parent-label\" onClick={() => {\n                            // Select/Deselect parent means select/deselect all children\n                            // Here we just toggle the parent string in selectedCategories\n                            setSelectedCategories(prev => prev.includes(parent) ? prev.filter(x => x !== parent && !x.startsWith(parent + '>')) : [...prev, parent]);\n                        }}>\n                            <input type=\"checkbox\" checked={selectedCategories.includes(parent)} readOnly />\n                            <span>{parent}</span>\n                        </div>\n                        <ul className=\"category-children\">\n                            {categoryTree[parent].map(child => {\n                            const fullPath = `${parent}>${child}`;\n                            return (\n                                <li key={fullPath}>\n                                <label>\n                                    <input \n                                    type=\"checkbox\" \n                                    checked={selectedCategories.includes(fullPath) || selectedCategories.includes(parent)} \n                                    onChange={() => {\n                                        setSelectedCategories(prev => {\n                                        const isParentSelected = prev.includes(parent);\n                                        const isChildSelected = prev.includes(fullPath);\n                                        if (isParentSelected) {\n                                            const others = prev.filter(x => x !== parent && !x.startsWith(parent + '>'));\n                                            const siblings = categoryTree[parent].map(c => `${parent}>${c}`);\n                                            return [...others, ...siblings.filter(s => s !== fullPath)];\n                                        }\n                                        return isChildSelected ? prev.filter(x => x !== fullPath) : [...prev, fullPath];\n                                        });\n                                    }}\n                                    />\n                                    {child}\n                                </label>\n                                </li>\n                            );\n                            })}\n                        </ul>\n                        </li>\n                    ))}\n                    </ul>\n                ) : <div className=\"no-filter-data\">无分类数据</div>}\n                </div>\n\n                <div className=\"sidebar-section\">\n                <h3 className=\"sidebar-title\">制造商/品牌</h3>\n                <ul className=\"filter-list\">\n                    {brands.map(b => (\n                    <li key={b}>\n                        <label>\n                        <input \n                            type=\"checkbox\" \n                            checked={selectedBrands.includes(b)} \n                            onChange={() => setSelectedBrands(prev => prev.includes(b) ? prev.filter(x=>x!==b) : [...prev,b])} \n                        />\n                        {b}\n                        </label>\n                    </li>\n                    ))}\n                </ul>\n                </div>\n\n                <div className=\"sidebar-section\">\n                <h3 className=\"sidebar-title\">规格参数</h3>\n                {series.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>系列</h4>\n                    <ul className=\"filter-list\">\n                        {series.slice(0, 10).map(s => (\n                        <li key={s}><label><input type=\"checkbox\" checked={selectedSeries.includes(s)} onChange={() => setSelectedSeries(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])} /> {s}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                {storages.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>容量</h4>\n                    <ul className=\"filter-list\">\n                        {storages.map(s => (\n                        <li key={s}><label><input type=\"checkbox\" checked={selectedStorage.includes(s)} onChange={() => setSelectedStorage(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])} /> {s}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                {colors.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>颜色</h4>\n                    <ul className=\"filter-list\">\n                        {colors.slice(0, 8).map(c => (\n                        <li key={c}><label><input type=\"checkbox\" checked={selectedColors.includes(c)} onChange={() => setSelectedColors(prev => prev.includes(c) ? prev.filter(x=>x!==c) : [...prev,c])} /> {c}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                </div>\n                </>\n            )}\n\n            <div className=\"sidebar-section\">\n              <h3 className=\"sidebar-title\">价格区间</h3>\n              <div className=\"price-range-inputs\">\n                <input type=\"number\" placeholder=\"¥ min\" value={minPrice} onChange={e => setMinPrice(e.target.value)} />\n                <span>-</span>\n                <input type=\"number\" placeholder=\"¥ max\" value={maxPrice} onChange={e => setMaxPrice(e.target.value)} />\n              </div>\n            </div>\n            \n            <div className=\"sidebar-section\">\n               <h3 className=\"sidebar-title\">商城</h3>\n               <ul className=\"filter-list\">\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(10)} onChange={() => togglePlatform(10)} /> 楽天</label></li>\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(20)} onChange={() => togglePlatform(20)} /> Yahoo!ショッピング</label></li>\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(40)} onChange={() => togglePlatform(40)} /> Amazon</label></li>\n               </ul>\n            </div>\n          </div>\n\n          {/* Main Content Results */}\n          <div className=\"main-content\">\n            <div className=\"results-header\">\n              <h2>\"{query}\" 搜索结果 <span>({filteredProducts.length}件)</span></h2>\n              <div className=\"sort-bar\">\n                <span className=\"sort-label\">排序:</span>\n                <button className={`sort-tab ${sortOption === 'price_asc' ? 'active' : ''}`} onClick={() => setSortOption('price_asc')}>价格低到高</button>\n                <button className={`sort-tab ${sortOption === 'price_desc' ? 'active' : ''}`} onClick={() => setSortOption('price_desc')}>价格高到低</button>\n                <button className={`sort-tab ${sortOption === 'platform' ? 'active' : ''}`} onClick={() => setSortOption('platform')}>商城</button>\n              </div>\n            </div>\n\n            <div className=\"product-list-view\">\n              {currentPageProducts.map((product, index) => (\n                <div key={index} className=\"product-row\">\n                  <div className=\"p-image\">\n                    <img src={product.imgUrl || 'https://placehold.co/120x120'} alt={product.goodsName} onError={(e) => (e.target as HTMLImageElement).src = 'https://placehold.co/120x120'} />\n                  </div>\n                  <div className=\"p-info\">\n                    <div className=\"p-title-row\">\n                      <a href={product.goodsLink} target=\"_blank\" rel=\"noopener noreferrer\" className=\"p-title\" onClick={() => { if (product.goodsId) { userApi.addHistory(product.goodsId); } }}>{product.goodsName}</a>\n                    </div>\n                    <div className=\"p-specs\">\n                      {(function(){\n                        const f = parseFacets(product.goodsName);\n                        const parts = [f.brand, f.series, f.model, f.storage, f.color, f.size].filter(Boolean);\n                        return parts.join(' | ');\n                      })()}\n                    </div>\n                    <div className=\"p-meta\">\n                      <span className={`mall-tag mall-${product.mallType}`}>{getPlatformName(product.mallType)}</span>\n                      <span className=\"seller\">{getSellerFromLink(product.goodsLink)}</span>\n                    </div>\n                  </div>\n                  <div className=\"p-action\">\n                    <div className=\"p-price\">{product.goodsPrice.toLocaleString()}円</div>\n                    <a href={product.goodsLink} target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-shop\" onClick={() => { if (product.goodsId) { userApi.addHistory(product.goodsId); } }}>前往购买</a>\n                    <button className=\"btn-trend\" onClick={() => { ensureGoodsIdAndCollect(product); }}>{product.goodsId && collectedIds.has(product.goodsId) ? '取消收藏' : '收藏'}</button>\n                    <button className=\"btn-trend\" onClick={() => {\n                        const title = product.goodsName;\n                        const labels = Array.from({length:12}, (_,i)=>{\n                          const d = new Date();\n                          d.setMonth(d.getMonth() - (11 - i));\n                          const m = (d.getMonth()+1).toString().padStart(2,'0');\n                          return `${d.getFullYear()}-${m}`;\n                        });\n                        const base = Math.max(1, product.goodsPrice);\n                        let val = base * 1.0;\n                        const series = labels.map((_,i)=>{\n                          const drift = 1 + Math.sin(i/3) * 0.05;\n                          const noise = 1 + ((Math.random() - 0.5) * 0.08);\n                          val = Math.max(1, val * drift * noise);\n                          return Math.round(val);\n                        });\n                        setTrendTitle(title);\n                        setTrendLabels(labels);\n                        setTrendSeries(series);\n                        setTrendOpen(true);\n                    }}>价格走势</button>\n                    <label className=\"compare-check\">\n                      <input type=\"checkbox\" checked={isSelected(getSelectKey(product))} onChange={() => toggleSelect(product)} /> 对比\n                    </label>\n                  </div>\n                </div>\n              ))}\n            </div>\n            \n            <div className=\"pagination-controls\">\n                <button type=\"button\" onClick={goPrev} disabled={currentPage === 1}>上一页</button>\n                <span className=\"page-info\">{currentPage} / {totalPages}</span>\n                <button type=\"button\" onClick={goNext} disabled={currentPage === totalPages}>下一页</button>\n            </div>\n          </div>\n          \n          {trendOpen && (\n            <div className=\"price-trend-modal\" onClick={() => setTrendOpen(false)}>\n              <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"modal-header\">\n                  <span className=\"modal-title\">{trendTitle}</span>\n                  <button type=\"button\" className=\"modal-close\" onClick={() => setTrendOpen(false)}>×</button>\n                </div>\n                <div className=\"modal-body\">\n                  <div className=\"trend-chart\">\n                    {(function(){\n                      const width = 600;\n                      const height = 280;\n                      const padding = 32;\n                      const xs = trendSeries.map((_,i)=> padding + (i*(width - 2*padding))/(trendSeries.length-1));\n                      const minV = Math.min(...trendSeries);\n                      const maxV = Math.max(...trendSeries);\n                      const ys = trendSeries.map(v => height - padding - ((v - minV) / (Math.max(1, maxV - minV))) * (height - 2*padding));\n                      const path = xs.map((x,i)=> `${i===0?'M':'L'}${x},${ys[i]}`).join(' ');\n                      const gridY = [0.25,0.5,0.75].map(r => height - padding - r*(height - 2*padding));\n                      return (\n                        <svg width={width} height={height} role=\"img\" aria-label=\"价格趋势图\">\n                          {gridY.map((gy,i)=> (\n                            <line key={i} x1={padding} y1={gy} x2={width-padding} y2={gy} stroke=\"#eee\" />\n                          ))}\n                          <path d={path} fill=\"none\" stroke=\"#ff4400\" strokeWidth={2} />\n                          {xs.map((x,i)=> (\n                            <circle key={i} cx={x} cy={ys[i]} r={3} fill=\"#ff4400\" />\n                          ))}\n                          <text x={padding} y={height-8} fontSize={12} fill=\"#999\">{trendLabels[0]}</text>\n                          <text x={width-padding-60} y={height-8} fontSize={12} fill=\"#999\">{trendLabels[trendLabels.length-1]}</text>\n                        </svg>\n                      );\n                    })()}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {!loading && !error && compareGroups.length === 0 && query && (\n        <div className=\"no-results\">関連商品が見つかりません</div>\n      )}\n    </div>\n  );\n};\n\nexport default ComparePage;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,eAAe,QAAQ,kBAAkB;AAClD,OAAO,mBAAmB;AAC1B,SAASC,QAAQ,EAAEC,WAAW,EAAEC,OAAO,EAAEC,eAAe,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAkBlF,MAAMC,WAAqB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAClC,MAAM,CAACC,YAAY,CAAC,GAAGX,eAAe,CAAC,CAAC;EACxC,MAAM,CAACY,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAACa,YAAY,CAACG,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;EACnE,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGlB,QAAQ,CAAiB,EAAE,CAAC;EACtE,MAAM,CAACmB,OAAO,EAAEC,UAAU,CAAC,GAAGpB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACqB,KAAK,EAAEC,QAAQ,CAAC,GAAGtB,QAAQ,CAAgB,IAAI,CAAC;EACvD,MAAM,CAACuB,UAAU,EAAEC,aAAa,CAAC,GAAGxB,QAAQ,CAAC,WAAW,CAAC;EACzD,MAAM,CAACyB,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG1B,QAAQ,CAAW,EAAE,CAAC;EACxE,MAAM,CAAC2B,QAAQ,EAAEC,WAAW,CAAC,GAAG5B,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC6B,QAAQ,EAAEC,WAAW,CAAC,GAAG9B,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC+B,WAAW,EAAEC,cAAc,CAAC,GAAGhC,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACiC,QAAQ,EAAEC,WAAW,CAAC,GAAGlC,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACmC,YAAY,EAAEC,eAAe,CAAC,GAAGpC,QAAQ,CAAW,EAAE,CAAC;EAC9D,MAAM,CAACqC,cAAc,EAAEC,iBAAiB,CAAC,GAAGtC,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAACuC,cAAc,EAAEC,iBAAiB,CAAC,GAAGxC,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAACyC,cAAc,EAAEC,iBAAiB,CAAC,GAAG1C,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAAC2C,eAAe,EAAEC,kBAAkB,CAAC,GAAG5C,QAAQ,CAAW,EAAE,CAAC;EACpE,MAAM,CAAC6C,cAAc,EAAEC,iBAAiB,CAAC,GAAG9C,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAAC+C,aAAa,EAAEC,gBAAgB,CAAC,GAAGhD,QAAQ,CAAW,EAAE,CAAC;EAChE,MAAM,CAACiD,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGlD,QAAQ,CAAW,EAAE,CAAC;EAC1E,MAAM,CAACmD,SAAS,EAAEC,YAAY,CAAC,GAAGpD,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACqD,WAAW,EAAEC,cAAc,CAAC,GAAGtD,QAAQ,CAAW,EAAE,CAAC;EAC5D,MAAM,CAACuD,WAAW,EAAEC,cAAc,CAAC,GAAGxD,QAAQ,CAAW,EAAE,CAAC;EAC5D,MAAM,CAACyD,UAAU,EAAEC,aAAa,CAAC,GAAG1D,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAAC2D,YAAY,EAAEC,eAAe,CAAC,GAAG5D,QAAQ,CAAc,IAAI6D,GAAG,CAAC,CAAC,CAAC;;EAExE;EACA,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAG/D,QAAQ,CAAsB,SAAS,CAAC;EAChF,MAAM,CAACgE,aAAa,EAAEC,gBAAgB,CAAC,GAAGjE,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACkE,UAAU,EAAEC,aAAa,CAAC,GAAGnE,QAAQ,CAAC,CAAC,CAAC;;EAE/C;EACA,MAAM,CAACoE,UAAU,EAAEC,aAAa,CAAC,GAAGrE,QAAQ,CAAQ,EAAE,CAAC;EACvD,MAAM,CAACsE,cAAc,EAAEC,iBAAiB,CAAC,GAAGvE,QAAQ,CAAQ,EAAE,CAAC;EAC/D,MAAM,CAACwE,sBAAsB,EAAEC,yBAAyB,CAAC,GAAGzE,QAAQ,CAAyB,CAAC,CAAC,CAAC;EAChG,MAAM,CAAC0E,YAAY,EAAEC,eAAe,CAAC,GAAG3E,QAAQ,CAAgB,IAAI,CAAC;;EAErE;EACAC,SAAS,CAAC,MAAM;IACdG,WAAW,CAACwE,OAAO,CAAC,CAAC,CAACC,IAAI,CAACC,GAAG,IAAI;MAChC,IAAIA,GAAG,CAACC,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;QACzBX,aAAa,CAACS,GAAG,CAACC,IAAI,CAACA,IAAI,CAAC;MAC9B;IACF,CAAC,CAAC,CAACE,KAAK,CAACC,GAAG,IAAIC,OAAO,CAAC9D,KAAK,CAAC,4BAA4B,EAAE6D,GAAG,CAAC,CAAC;EACnE,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAjF,SAAS,CAAC,MAAM;IACd,IAAIa,KAAK,CAACsE,IAAI,CAAC,CAAC,EAAE;MAChBC,cAAc,CAACvE,KAAK,CAAC;IACvB;IACA;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAb,SAAS,CAAC,MAAM;IACd,IAAIyE,YAAY,EAAE;MAChBtE,WAAW,CAACkF,aAAa,CAACZ,YAAY,CAAC,CAACG,IAAI,CAACC,GAAG,IAAI;QAClD,IAAIA,GAAG,CAACC,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;UACzBT,iBAAiB,CAACO,GAAG,CAACC,IAAI,CAACA,IAAI,CAAC;QAClC;MACF,CAAC,CAAC,CAACE,KAAK,CAACC,GAAG,IAAIC,OAAO,CAAC9D,KAAK,CAAC,4BAA4B,EAAE6D,GAAG,CAAC,CAAC;IACnE,CAAC,MAAM;MACHX,iBAAiB,CAAC,EAAE,CAAC;IACzB;EACF,CAAC,EAAE,CAACG,YAAY,CAAC,CAAC;;EAElB;EACAzE,SAAS,CAAC,MAAM;IACd,IAAI6D,YAAY,KAAK,OAAO,EAAE;MAC5BuB,cAAc,CAACrB,aAAa,IAAIlD,KAAK,CAAC;IACxC;EACF,CAAC,EAAE,CAAC0D,sBAAsB,EAAEE,YAAY,EAAE3C,WAAW,EAAEE,QAAQ,EAAE6B,YAAY,EAAErC,iBAAiB,CAAC,CAAC;EAElGxB,SAAS,CAAC,MAAM;IACd,CAAC,YAAY;MACX,IAAI;QACF,MAAM6E,GAAG,GAAG,MAAM3E,QAAQ,CAACoF,YAAY,CAAC,CAAC,EAAE,GAAG,CAAC;QAC/C,IAAIT,GAAG,CAACC,IAAI,IAAID,GAAG,CAACC,IAAI,CAACC,IAAI,KAAK,GAAG,IAAIQ,KAAK,CAACC,OAAO,CAACX,GAAG,CAACC,IAAI,CAACA,IAAI,CAAC,EAAE;UACrE,MAAMW,GAAG,GAAGZ,GAAG,CAACC,IAAI,CAACA,IAAI,CAACY,GAAG,CAAEC,CAAM,IAAKA,CAAC,CAACC,OAAO,CAAC,CAACC,MAAM,CAAEC,EAAO,IAAK,OAAOA,EAAE,KAAK,QAAQ,CAAC;UAChGnC,eAAe,CAAC,IAAIC,GAAG,CAAC6B,GAAG,CAAC,CAAC;QAC/B;MACF,CAAC,CAAC,OAAOM,CAAC,EAAE,CACZ;IACF,CAAC,EAAE,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,aAAa,GAAG,MAAOJ,OAAe,IAAK;IAC/C,IAAI;MACF,IAAIlC,YAAY,CAACuC,GAAG,CAACL,OAAO,CAAC,EAAE;QAC7B,MAAMf,GAAG,GAAG,MAAMxE,eAAe,CAAC6F,aAAa,CAACN,OAAO,CAAC;QACxD,IAAIf,GAAG,CAACC,IAAI,IAAID,GAAG,CAACC,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;UACrCpB,eAAe,CAACwC,IAAI,IAAI;YACtB,MAAMC,IAAI,GAAG,IAAIxC,GAAG,CAACuC,IAAI,CAAC;YAC1BC,IAAI,CAACC,MAAM,CAACT,OAAO,CAAC;YACpB,OAAOQ,IAAI;UACb,CAAC,CAAC;QACJ;MACF,CAAC,MAAM;QACL,MAAMvB,GAAG,GAAG,MAAMxE,eAAe,CAACiG,OAAO,CAACV,OAAO,CAAC;QAClD,IAAIf,GAAG,CAACC,IAAI,IAAID,GAAG,CAACC,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;UACrCpB,eAAe,CAACwC,IAAI,IAAI;YACtB,MAAMC,IAAI,GAAG,IAAIxC,GAAG,CAACuC,IAAI,CAAC;YAC1BC,IAAI,CAACG,GAAG,CAACX,OAAO,CAAC;YACjB,OAAOQ,IAAI;UACb,CAAC,CAAC;QACJ,CAAC,MAAM;UACLI,KAAK,CAAC,MAAM,CAAC;QACf;MACF;IACF,CAAC,CAAC,OAAOT,CAAC,EAAE;MACVS,KAAK,CAAC,MAAM,CAAC;IACf;EACF,CAAC;EAED,MAAMC,uBAAuB,GAAG,MAAOC,OAAgB,IAAK;IAC1D,IAAI;MACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACF,KAAK,EAAE;QACVH,KAAK,CAAC,MAAM,CAAC;QACb;MACF;MACA,IAAIE,OAAO,CAACd,OAAO,EAAE;QACnB,MAAMI,aAAa,CAACU,OAAO,CAACd,OAAO,CAAC;QACpC;MACF;MACA,MAAMkB,OAAY,GAAG;QACnBC,SAAS,EAAEL,OAAO,CAACK,SAAS;QAC5BC,UAAU,EAAEN,OAAO,CAACM,UAAU;QAC9BC,SAAS,EAAEP,OAAO,CAACO,SAAS;QAC5BC,MAAM,EAAER,OAAO,CAACQ,MAAM;QACtBC,QAAQ,EAAET,OAAO,CAACS,QAAQ;QAC1BC,MAAM,EAAE;MACV,CAAC;MACD,MAAMC,MAAM,GAAG,MAAMnH,QAAQ,CAACoH,YAAY,CAACR,OAAO,CAAC;MACnD,IAAIO,MAAM,CAACvC,IAAI,IAAIuC,MAAM,CAACvC,IAAI,CAACC,IAAI,KAAK,GAAG,IAAIsC,MAAM,CAACvC,IAAI,CAACA,IAAI,IAAIuC,MAAM,CAACvC,IAAI,CAACA,IAAI,CAACc,OAAO,EAAE;QAC3F,MAAM2B,KAAK,GAAGF,MAAM,CAACvC,IAAI,CAACA,IAAI,CAACc,OAAiB;QAChD,MAAMI,aAAa,CAACuB,KAAK,CAAC;MAC5B,CAAC,MAAM;QACLf,KAAK,CAAC,QAAQ,CAAC;MACjB;IACF,CAAC,CAAC,OAAOT,CAAC,EAAE;MACVS,KAAK,CAAC,MAAM,CAAC;IACf;EACF,CAAC;EAED,MAAMpB,cAAc,GAAG,MAAOoC,WAAmB,IAAK;IACpD,IAAI,CAACA,WAAW,CAACrC,IAAI,CAAC,CAAC,IAAItB,YAAY,KAAK,SAAS,EAAE;IAEvDG,gBAAgB,CAACwD,WAAW,CAAC;IAC7BrG,UAAU,CAAC,IAAI,CAAC;IAChBE,QAAQ,CAAC,IAAI,CAAC;IAEd,IAAI;MACF,IAAIwC,YAAY,KAAK,OAAO,EAAE;QAC5B,MAAM4D,IAAI,GAAG/F,QAAQ,GAAGgG,MAAM,CAAChG,QAAQ,CAAC,GAAGiG,SAAS;QACpD,MAAMC,IAAI,GAAGhG,QAAQ,GAAG8F,MAAM,CAAC9F,QAAQ,CAAC,GAAG+F,SAAS;QACpDzC,OAAO,CAAC2C,GAAG,CAAC,oCAAoC,EAAE;UAAEL,WAAW;UAAEjD,sBAAsB;UAAEE,YAAY;UAAEgD,IAAI;UAAEG,IAAI;UAAEpG;QAAkB,CAAC,CAAC;QACvI,MAAMsG,QAAQ,GAAG,MAAM5H,QAAQ,CAAC6H,YAAY,CAACP,WAAW,EAAEjD,sBAAsB,EAAEE,YAAY,IAAIkD,SAAS,EAAE7F,WAAW,EAAEE,QAAQ,EAAEyF,IAAI,EAAEG,IAAI,EAAEpG,iBAAiB,CAAC;QAClK0D,OAAO,CAAC2C,GAAG,CAAC,qBAAqB,EAAEC,QAAQ,CAAChD,IAAI,CAAC;QAEjD,IAAIgD,QAAQ,CAAChD,IAAI,IAAIgD,QAAQ,CAAChD,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;UAC/C,MAAMiD,OAAO,GAAGF,QAAQ,CAAChD,IAAI,CAACA,IAAI,CAACkD,OAAO,IAAI,EAAE;UAChD9D,aAAa,CAAC4D,QAAQ,CAAChD,IAAI,CAACA,IAAI,CAACmD,KAAK,IAAI,CAAC,CAAC;UAC5C,MAAMC,aAAa,GAAGF,OAAO,CAACtC,GAAG,CAAEC,CAAM,KAAM;YAC7CoB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;YACtBoB,SAAS,EAAE,CAAC;cACVvC,OAAO,EAAED,CAAC,CAACC,OAAO;cAClBmB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;cACtBC,UAAU,EAAErB,CAAC,CAACqB,UAAU;cACxBC,SAAS,EAAEtB,CAAC,CAACsB,SAAS,IAAI,GAAG;cAC7BC,MAAM,EAAEvB,CAAC,CAACuB,MAAM;cAChBC,QAAQ,EAAExB,CAAC,CAACwB,QAAQ,IAAI;YAC1B,CAAC,CAAC;YACFiB,WAAW,EAAEzC,CAAC,CAACqB,UAAU;YACzBqB,cAAc,EAAEC,eAAe,CAAC3C,CAAC,CAACwB,QAAQ,IAAI,CAAC;UACjD,CAAC,CAAC,CAAC;UACH,IAAIe,aAAa,CAACK,MAAM,KAAK,CAAC,EAAE;YAC9B,IAAI;cACF,MAAMC,MAAM,GAAG,MAAMtI,QAAQ,CAACuI,YAAY,CAACjB,WAAW,CAAC;cACvD,IAAIkB,YAAmB,GAAG,EAAE;cAC5B,IAAIF,MAAM,CAAC1D,IAAI,IAAI0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,EAAE;gBACnC4D,YAAY,GAAGnD,KAAK,CAACC,OAAO,CAACgD,MAAM,CAAC1D,IAAI,CAACA,IAAI,CAAC,GAAG0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,GAAG,CAAC0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,CAAC;cACxF;cACA,IAAI6D,YAAmB,GAAG,EAAE;cAC5B,IAAID,YAAY,CAACH,MAAM,GAAG,CAAC,EAAE;gBAC3BI,YAAY,GAAGD,YAAY,CAAChD,GAAG,CAAEkD,KAAU,IAAK;kBAC9C,MAAMT,SAAS,GAAG5C,KAAK,CAACC,OAAO,CAACoD,KAAK,CAACT,SAAS,CAAC,GAAGS,KAAK,CAACT,SAAS,GAAG,EAAE;kBACvE,IAAIC,WAA0B,GAAG,IAAI;kBACrC,IAAIC,cAAc,GAAG,IAAI;kBACzB,IAAIF,SAAS,CAACI,MAAM,GAAG,CAAC,EAAE;oBACxB,MAAMM,aAAa,GAAGV,SAAS,CAACW,MAAM,CAAC,CAACC,MAAW,EAAEC,OAAY,KAC/DA,OAAO,CAAChC,UAAU,GAAG+B,MAAM,CAAC/B,UAAU,GAAGgC,OAAO,GAAGD,MAAM,EAAEZ,SAAS,CAAC,CAAC,CAAC,CAAC;oBAC1EC,WAAW,GAAGS,aAAa,CAAC7B,UAAU;oBACtCqB,cAAc,GAAGC,eAAe,CAACO,aAAa,CAAC1B,QAAQ,CAAC;kBAC1D;kBACA,OAAO;oBACLJ,SAAS,EAAE6B,KAAK,CAAC7B,SAAS,IAAI,OAAO;oBACrCoB,SAAS,EAAEA,SAAS,CAACzC,GAAG,CAAEgB,OAAY,KAAM;sBAC1Cd,OAAO,EAAEc,OAAO,CAACd,OAAO;sBACxBmB,SAAS,EAAEL,OAAO,CAACK,SAAS;sBAC5BC,UAAU,EAAEN,OAAO,CAACM,UAAU;sBAC9BC,SAAS,EAAEP,OAAO,CAACO,SAAS;sBAC5BC,MAAM,EAAER,OAAO,CAACQ,MAAM;sBACtBC,QAAQ,EAAET,OAAO,CAACS;oBACpB,CAAC,CAAC,CAAC;oBACHiB,WAAW;oBACXC;kBACF,CAAC;gBACH,CAAC,CAAC;cACJ;cACApH,gBAAgB,CAAC0H,YAAY,CAAC;cAC9BxH,UAAU,CAAC,KAAK,CAAC;cACjB;YACF,CAAC,CAAC,OAAO4E,CAAC,EAAE;cACVb,OAAO,CAAC9D,KAAK,CAAC,gCAAgC,EAAE2E,CAAC,CAAC;YACpD;UACF;UACA9E,gBAAgB,CAACiH,aAAa,CAAC;QACjC,CAAC,MAAM;UACLjH,gBAAgB,CAAC,EAAE,CAAC;UACpBiD,aAAa,CAAC,CAAC,CAAC;UAChB,IAAI;YACF,MAAMsE,MAAM,GAAG,MAAMtI,QAAQ,CAACuI,YAAY,CAACjB,WAAW,CAAC;YACvD,IAAIkB,YAAmB,GAAG,EAAE;YAC5B,IAAIF,MAAM,CAAC1D,IAAI,IAAI0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,EAAE;cACnC4D,YAAY,GAAGnD,KAAK,CAACC,OAAO,CAACgD,MAAM,CAAC1D,IAAI,CAACA,IAAI,CAAC,GAAG0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,GAAG,CAAC0D,MAAM,CAAC1D,IAAI,CAACA,IAAI,CAAC;YACxF;YACA,IAAIoD,aAAoB,GAAG,EAAE;YAC7B,IAAIQ,YAAY,CAACH,MAAM,GAAG,CAAC,EAAE;cAC3BL,aAAa,GAAGQ,YAAY,CAAChD,GAAG,CAAEkD,KAAU,IAAK;gBAC/C,MAAMT,SAAS,GAAG5C,KAAK,CAACC,OAAO,CAACoD,KAAK,CAACT,SAAS,CAAC,GAAGS,KAAK,CAACT,SAAS,GAAG,EAAE;gBACvE,IAAIC,WAA0B,GAAG,IAAI;gBACrC,IAAIC,cAAc,GAAG,IAAI;gBACzB,IAAIF,SAAS,CAACI,MAAM,GAAG,CAAC,EAAE;kBACxB,MAAMM,aAAa,GAAGV,SAAS,CAACW,MAAM,CAAC,CAACC,MAAW,EAAEC,OAAY,KAC/DA,OAAO,CAAChC,UAAU,GAAG+B,MAAM,CAAC/B,UAAU,GAAGgC,OAAO,GAAGD,MAAM,EAAEZ,SAAS,CAAC,CAAC,CAAC,CAAC;kBAC1EC,WAAW,GAAGS,aAAa,CAAC7B,UAAU;kBACtCqB,cAAc,GAAGC,eAAe,CAACO,aAAa,CAAC1B,QAAQ,CAAC;gBAC1D;gBACA,OAAO;kBACLJ,SAAS,EAAE6B,KAAK,CAAC7B,SAAS,IAAI,OAAO;kBACrCoB,SAAS,EAAEA,SAAS,CAACzC,GAAG,CAAEgB,OAAY,KAAM;oBAC1Cd,OAAO,EAAEc,OAAO,CAACd,OAAO;oBACxBmB,SAAS,EAAEL,OAAO,CAACK,SAAS;oBAC5BC,UAAU,EAAEN,OAAO,CAACM,UAAU;oBAC9BC,SAAS,EAAEP,OAAO,CAACO,SAAS;oBAC5BC,MAAM,EAAER,OAAO,CAACQ,MAAM;oBACtBC,QAAQ,EAAET,OAAO,CAACS;kBACpB,CAAC,CAAC,CAAC;kBACHiB,WAAW;kBACXC;gBACF,CAAC;cACH,CAAC,CAAC;YACJ;YACApH,gBAAgB,CAACiH,aAAa,CAAC;UACjC,CAAC,CAAC,OAAOnC,CAAC,EAAE;YACVb,OAAO,CAAC9D,KAAK,CAAC,gCAAgC,EAAE2E,CAAC,CAAC;UACpD;QACF;QACA5E,UAAU,CAAC,KAAK,CAAC;QACjB;MACF;MAEA+D,OAAO,CAAC2C,GAAG,CAAC,gDAAgD,EAAEL,WAAW,CAAC,CAAC,CAAC;;MAE5E;MACA,MAAMM,QAAQ,GAAG,MAAM5H,QAAQ,CAACuI,YAAY,CAACjB,WAAW,CAAC;MAEzDtC,OAAO,CAAC2C,GAAG,CAAC,eAAe,EAAEC,QAAQ,CAAChD,IAAI,CAAC,CAAC,CAAC;;MAE7C,IAAI4D,YAAY,GAAG,EAAE;MACrB,IAAIZ,QAAQ,CAAChD,IAAI,IAAIgD,QAAQ,CAAChD,IAAI,CAACA,IAAI,EAAE;QACvC4D,YAAY,GAAGnD,KAAK,CAACC,OAAO,CAACsC,QAAQ,CAAChD,IAAI,CAACA,IAAI,CAAC,GAAGgD,QAAQ,CAAChD,IAAI,CAACA,IAAI,GAAG,CAACgD,QAAQ,CAAChD,IAAI,CAACA,IAAI,CAAC;MAC9F,CAAC,MAAM;QACL4D,YAAY,GAAG,EAAE;MACnB;MAEAxD,OAAO,CAAC2C,GAAG,CAAC,oBAAoB,EAAEa,YAAY,CAAC,CAAC,CAAC;;MAEjD;MACA,IAAIR,aAAoB,GAAG,EAAE;MAE7B,IAAIQ,YAAY,CAACH,MAAM,GAAG,CAAC,EAAE;QAC3B;QACAL,aAAa,GAAGQ,YAAY,CAAChD,GAAG,CAAEkD,KAAU,IAAK;UAC/C;UACA,MAAMT,SAAS,GAAG5C,KAAK,CAACC,OAAO,CAACoD,KAAK,CAACT,SAAS,CAAC,GAAGS,KAAK,CAACT,SAAS,GAAG,EAAE;;UAEvE;UACA,IAAIC,WAAW,GAAG,IAAI;UACtB,IAAIC,cAAc,GAAG,IAAI;;UAEzB;UACA,IAAIF,SAAS,CAACI,MAAM,GAAG,CAAC,EAAE;YACxB,MAAMM,aAAa,GAAGV,SAAS,CAACW,MAAM,CAAC,CAACC,MAAW,EAAEC,OAAY,KAC/DA,OAAO,CAAChC,UAAU,GAAG+B,MAAM,CAAC/B,UAAU,GAAGgC,OAAO,GAAGD,MAAM,EAAEZ,SAAS,CAAC,CAAC,CAAC,CAAC;YAE1EC,WAAW,GAAGS,aAAa,CAAC7B,UAAU;YACtCqB,cAAc,GAAGC,eAAe,CAACO,aAAa,CAAC1B,QAAQ,CAAC;UAC1D;UAEA,OAAO;YACLJ,SAAS,EAAE6B,KAAK,CAAC7B,SAAS,IAAI,OAAO;YACrCoB,SAAS,EAAEA,SAAS,CAACzC,GAAG,CAAEgB,OAAY,KAAM;cAC1Cd,OAAO,EAAEc,OAAO,CAACd,OAAO;cACxBmB,SAAS,EAAEL,OAAO,CAACK,SAAS;cAC5BC,UAAU,EAAEN,OAAO,CAACM,UAAU;cAC9BC,SAAS,EAAEP,OAAO,CAACO,SAAS;cAC5BC,MAAM,EAAER,OAAO,CAACQ,MAAM;cACtBC,QAAQ,EAAET,OAAO,CAACS;YACpB,CAAC,CAAC,CAAC;YACHiB,WAAW,EAAEA,WAAW;YACxBC,cAAc,EAAEA;UAClB,CAAC;QACH,CAAC,CAAC;QAEFnD,OAAO,CAAC2C,GAAG,CAAC,yBAAyB,EAAEK,aAAa,CAAC,CAAC,CAAC;MACzD;;MAEA;MACA,IAAIA,aAAa,CAACK,MAAM,KAAK,CAAC,EAAE;QAC9B,IAAI;UACF,MAAMU,QAAQ,GAAG,MAAM/I,QAAQ,CAAC6H,YAAY,CAC1CP,WAAW,EACXG,SAAS,EACTA,SAAS,EACT7F,WAAW,EACXE,QAAQ,EACR2F,SAAS,EACTA,SAAS,EACTnG,iBACF,CAAC;UACD,IAAIyH,QAAQ,CAACnE,IAAI,IAAImE,QAAQ,CAACnE,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;YAAA,IAAAmE,mBAAA,EAAAC,oBAAA;YAC/C,MAAMnB,OAAO,GAAG,EAAAkB,mBAAA,GAAAD,QAAQ,CAACnE,IAAI,CAACA,IAAI,cAAAoE,mBAAA,uBAAlBA,mBAAA,CAAoBlB,OAAO,KAAI,EAAE;YACjD9D,aAAa,CAAC,EAAAiF,oBAAA,GAAAF,QAAQ,CAACnE,IAAI,CAACA,IAAI,cAAAqE,oBAAA,uBAAlBA,oBAAA,CAAoBlB,KAAK,KAAI,CAAC,CAAC;YAC7CC,aAAa,GAAGF,OAAO,CAACtC,GAAG,CAAEC,CAAM,KAAM;cACvCoB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;cACtBoB,SAAS,EAAE,CAAC;gBACVvC,OAAO,EAAED,CAAC,CAACC,OAAO;gBAClBmB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;gBACtBC,UAAU,EAAErB,CAAC,CAACqB,UAAU;gBACxBC,SAAS,EAAEtB,CAAC,CAACsB,SAAS,IAAI,GAAG;gBAC7BC,MAAM,EAAEvB,CAAC,CAACuB,MAAM;gBAChBC,QAAQ,EAAExB,CAAC,CAACwB,QAAQ,IAAI;cAC1B,CAAC,CAAC;cACFiB,WAAW,EAAEzC,CAAC,CAACqB,UAAU;cACzBqB,cAAc,EAAEC,eAAe,CAAC3C,CAAC,CAACwB,QAAQ,IAAI,CAAC;YACjD,CAAC,CAAC,CAAC;UACL;UACA;UACA,IAAIe,aAAa,CAACK,MAAM,KAAK,CAAC,EAAE;YAC9B,IAAI;cACF,MAAMa,SAAS,GAAG,MAAMlJ,QAAQ,CAACmJ,iBAAiB,CAAC7B,WAAW,CAAC;cAC/D,MAAM8B,IAAI,GAAIF,SAAS,CAACtE,IAAI,IAAIsE,SAAS,CAACtE,IAAI,CAACA,IAAI,GAC9CS,KAAK,CAACC,OAAO,CAAC4D,SAAS,CAACtE,IAAI,CAACA,IAAI,CAAC,GAAGsE,SAAS,CAACtE,IAAI,CAACA,IAAI,GAAG,CAACsE,SAAS,CAACtE,IAAI,CAACA,IAAI,CAAC,GACjF,EAAE;cACNoD,aAAa,GAAGoB,IAAI,CAAC5D,GAAG,CAAEC,CAAM,KAAM;gBACpCoB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;gBACtBoB,SAAS,EAAE,CAAC;kBACVvC,OAAO,EAAED,CAAC,CAACC,OAAO;kBAClBmB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;kBACtBC,UAAU,EAAErB,CAAC,CAACqB,UAAU;kBACxBC,SAAS,EAAEtB,CAAC,CAACsB,SAAS,IAAI,GAAG;kBAC7BC,MAAM,EAAEvB,CAAC,CAACuB,MAAM;kBAChBC,QAAQ,EAAExB,CAAC,CAACwB,QAAQ,IAAI;gBAC1B,CAAC,CAAC;gBACFiB,WAAW,EAAEzC,CAAC,CAACqB,UAAU;gBACzBqB,cAAc,EAAEC,eAAe,CAAC3C,CAAC,CAACwB,QAAQ,IAAI,CAAC;cACjD,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,OAAOpB,CAAC,EAAE;cACVb,OAAO,CAAC9D,KAAK,CAAC,mCAAmC,EAAE2E,CAAC,CAAC;YACvD;UACF;QACF,CAAC,CAAC,OAAOA,CAAC,EAAE;UACVb,OAAO,CAAC9D,KAAK,CAAC,sCAAsC,EAAE2E,CAAC,CAAC;QAC1D;MACF;MAEAb,OAAO,CAAC2C,GAAG,CAAC,uBAAuB,EAAEK,aAAa,CAAC,CAAC,CAAC;;MAErDjH,gBAAgB,CAACiH,aAAa,CAAC;MAC/B/G,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC,OAAO8D,GAAG,EAAE;MACZ;MACA,IAAI;QACF,IAAIiD,aAAoB,GAAG,EAAE;QAC7B,MAAMe,QAAQ,GAAG,MAAM/I,QAAQ,CAAC6H,YAAY,CAC1CP,WAAW,EACXG,SAAS,EACTA,SAAS,EACT7F,WAAW,EACXE,QAAQ,EACR2F,SAAS,EACTA,SAAS,EACTnG,iBACF,CAAC;QACD,IAAIyH,QAAQ,CAACnE,IAAI,IAAImE,QAAQ,CAACnE,IAAI,CAACC,IAAI,KAAK,GAAG,EAAE;UAAA,IAAAwE,oBAAA,EAAAC,oBAAA;UAC/C,MAAMxB,OAAO,GAAG,EAAAuB,oBAAA,GAAAN,QAAQ,CAACnE,IAAI,CAACA,IAAI,cAAAyE,oBAAA,uBAAlBA,oBAAA,CAAoBvB,OAAO,KAAI,EAAE;UACjD9D,aAAa,CAAC,EAAAsF,oBAAA,GAAAP,QAAQ,CAACnE,IAAI,CAACA,IAAI,cAAA0E,oBAAA,uBAAlBA,oBAAA,CAAoBvB,KAAK,KAAI,CAAC,CAAC;UAC7CC,aAAa,GAAGF,OAAO,CAACtC,GAAG,CAAEC,CAAM,KAAM;YACvCoB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;YACtBoB,SAAS,EAAE,CAAC;cACVvC,OAAO,EAAED,CAAC,CAACC,OAAO;cAClBmB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;cACtBC,UAAU,EAAErB,CAAC,CAACqB,UAAU;cACxBC,SAAS,EAAEtB,CAAC,CAACsB,SAAS,IAAI,GAAG;cAC7BC,MAAM,EAAEvB,CAAC,CAACuB,MAAM;cAChBC,QAAQ,EAAExB,CAAC,CAACwB,QAAQ,IAAI;YAC1B,CAAC,CAAC;YACFiB,WAAW,EAAEzC,CAAC,CAACqB,UAAU;YACzBqB,cAAc,EAAEC,eAAe,CAAC3C,CAAC,CAACwB,QAAQ,IAAI,CAAC;UACjD,CAAC,CAAC,CAAC;QACL;QACA,IAAIe,aAAa,CAACK,MAAM,KAAK,CAAC,EAAE;UAC9B,MAAMa,SAAS,GAAG,MAAMlJ,QAAQ,CAACmJ,iBAAiB,CAAC7B,WAAW,CAAC;UAC/D,MAAM8B,IAAI,GAAIF,SAAS,CAACtE,IAAI,IAAIsE,SAAS,CAACtE,IAAI,CAACA,IAAI,GAC9CS,KAAK,CAACC,OAAO,CAAC4D,SAAS,CAACtE,IAAI,CAACA,IAAI,CAAC,GAAGsE,SAAS,CAACtE,IAAI,CAACA,IAAI,GAAG,CAACsE,SAAS,CAACtE,IAAI,CAACA,IAAI,CAAC,GACjF,EAAE;UACNoD,aAAa,GAAGoB,IAAI,CAAC5D,GAAG,CAAEC,CAAM,KAAM;YACpCoB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;YACtBoB,SAAS,EAAE,CAAC;cACVvC,OAAO,EAAED,CAAC,CAACC,OAAO;cAClBmB,SAAS,EAAEpB,CAAC,CAACoB,SAAS;cACtBC,UAAU,EAAErB,CAAC,CAACqB,UAAU;cACxBC,SAAS,EAAEtB,CAAC,CAACsB,SAAS,IAAI,GAAG;cAC7BC,MAAM,EAAEvB,CAAC,CAACuB,MAAM;cAChBC,QAAQ,EAAExB,CAAC,CAACwB,QAAQ,IAAI;YAC1B,CAAC,CAAC;YACFiB,WAAW,EAAEzC,CAAC,CAACqB,UAAU;YACzBqB,cAAc,EAAEC,eAAe,CAAC3C,CAAC,CAACwB,QAAQ,IAAI,CAAC;UACjD,CAAC,CAAC,CAAC;QACL;QACAlG,gBAAgB,CAACiH,aAAa,CAAC;QAC/B/G,UAAU,CAAC,KAAK,CAAC;MACnB,CAAC,CAAC,OAAOsI,WAAW,EAAE;QACpBpI,QAAQ,CAAC,wBAAwB,CAAC;QAClCF,UAAU,CAAC,KAAK,CAAC;QACjB+D,OAAO,CAAC9D,KAAK,CAACqI,WAAW,CAAC;MAC5B;MACAvE,OAAO,CAAC9D,KAAK,CAAC6D,GAAG,CAAC;IACpB;EACF,CAAC;EAED,MAAMyE,YAAY,GAAI3D,CAAkB,IAAK;IAC3CA,CAAC,CAAC4D,cAAc,CAAC,CAAC;IAClB,IAAI9I,KAAK,CAACsE,IAAI,CAAC,CAAC,EAAE;MAChBC,cAAc,CAACvE,KAAK,CAAC;IACvB;EACF,CAAC;EAED,MAAMyH,eAAe,GAAInB,QAAgB,IAAa;IACpD,QAAQA,QAAQ;MACd,KAAK,EAAE;QAAE,OAAO,IAAI;MACpB,KAAK,EAAE;QAAE,OAAO,QAAQ;MACxB,KAAK,EAAE;QAAE,OAAO,QAAQ;MACxB,KAAK,EAAE;QAAE,OAAO,QAAQ;MACxB;QAAS,OAAO,IAAI;IACtB;EACF,CAAC;EAED,MAAMyC,gBAAgB,GAAIzC,QAAgB,IAAa;IACrD,QAAQA,QAAQ;MACd,KAAK,EAAE;QAAE,OAAO,SAAS;MAAE;MAC3B,KAAK,EAAE;QAAE,OAAO,SAAS;MAAE;MAC3B,KAAK,EAAE;QAAE,OAAO,SAAS;MAAE;MAC3B,KAAK,EAAE;QAAE,OAAO,SAAS;MAAE;MAC3B;QAAS,OAAO,MAAM;IACxB;EACF,CAAC;EAED,MAAM0C,qBAAqB,GAAI1C,QAAgB,IAAa;IAC1D,QAAQA,QAAQ;MACd,KAAK,EAAE;QAAE,OAAO,wBAAwB;MACxC,KAAK,EAAE;QAAE,OAAO,sBAAsB;MACtC,KAAK,EAAE;QAAE,OAAO,uBAAuB;MACvC,KAAK,EAAE;QAAE,OAAO,uBAAuB;MACvC;QAAS,OAAO,wBAAwB;IAC1C;EACF,CAAC;EAED,MAAM2C,WAAsB,GAAG9I,aAAa,CAAC+I,OAAO,CAACnB,KAAK,IAAIA,KAAK,CAACT,SAAS,CAAC;EAC9E,MAAM6B,WAAW,GAAG,CAAC,OAAO,EAAC,SAAS,EAAC,MAAM,EAAC,QAAQ,EAAC,QAAQ,EAAC,QAAQ,EAAC,MAAM,EAAC,IAAI,EAAC,MAAM,EAAC,MAAM,EAAC,UAAU,EAAC,WAAW,EAAC,OAAO,EAAC,OAAO,CAAC;EAC1I,MAAMC,WAAW,GAAIC,IAAY,IAAK;IACpC,MAAMC,CAAC,GAAGD,IAAI,IAAI,EAAE;IACpB,MAAME,KAAK,GAAGJ,WAAW,CAACK,IAAI,CAACC,CAAC,IAAI,IAAIC,MAAM,CAACD,CAAC,EAAE,GAAG,CAAC,CAACE,IAAI,CAACL,CAAC,CAAC,CAAC,IAAI,EAAE;IACrE,MAAMM,WAAW,GAAGN,CAAC,CAACO,KAAK,CAAC,uGAAuG,CAAC;IACpI,MAAMC,MAAM,GAAGF,WAAW,GAAGA,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE;IAChD,MAAMG,UAAU,GAAGT,CAAC,CAACO,KAAK,CAAC,6FAA6F,CAAC;IACzH,MAAMG,KAAK,GAAGD,UAAU,GAAGA,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE;IAC7C,MAAME,YAAY,GAAGX,CAAC,CAACO,KAAK,CAAC,0BAA0B,CAAC;IACxD,MAAMK,OAAO,GAAGD,YAAY,GAAGA,YAAY,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,MAAM,EAAC,EAAE,CAAC,GAAG,EAAE;IACtE,MAAMC,UAAU,GAAGd,CAAC,CAACO,KAAK,CAAC,qIAAqI,CAAC;IACjK,MAAMQ,KAAK,GAAGD,UAAU,GAAGA,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE;IAC7C,MAAME,SAAS,GAAGhB,CAAC,CAACO,KAAK,CAAC,yCAAyC,CAAC;IACpE,MAAMU,IAAI,GAAGD,SAAS,GAAGA,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE;IAC1C,OAAO;MAAEf,KAAK;MAAEO,MAAM;MAAEE,KAAK;MAAEE,OAAO;MAAEG,KAAK;MAAEE;IAAK,CAAC;EACvD,CAAC;EACD,MAAMC,UAAU,GAAGvB,WAAW,CAACpE,GAAG,CAAC4F,CAAC,IAAIrB,WAAW,CAACqB,CAAC,CAACvE,SAAS,CAAC,CAAC;EACjE,MAAMwE,MAAM,GAAGhG,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACrB,KAAK,CAAC,CAACvE,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EAChF,MAAMf,MAAM,GAAGpF,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACd,MAAM,CAAC,CAAC9E,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EACjF,MAAMC,MAAM,GAAGpG,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACZ,KAAK,CAAC,CAAChF,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EAChF,MAAME,QAAQ,GAAGrG,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACV,OAAO,CAAC,CAAClF,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EACpF,MAAMG,MAAM,GAAGtG,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACP,KAAK,CAAC,CAACrF,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EAChF,MAAMI,KAAK,GAAGvG,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACyH,UAAU,CAAC3F,GAAG,CAAC+F,CAAC,IAAIA,CAAC,CAACL,IAAI,CAAC,CAACvF,MAAM,CAAC6F,OAAO,CAAC,CAAC,CAAC;EAC9E,MAAMK,aAAa,GAAI7B,IAAY,IAAK;IACtC,MAAMC,CAAC,GAAG,CAACD,IAAI,IAAI,EAAE,EAAE8B,WAAW,CAAC,CAAC;IACpC,IAAI,iBAAiB,CAACxB,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,WAAW;MAAEC,KAAK,EAAE;IAAM,CAAC;IAC3E,IAAI,0CAA0C,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,cAAc;MAAEC,KAAK,EAAE;IAAY,CAAC;IAC7G,IAAI,gCAAgC,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,YAAY;MAAEC,KAAK,EAAE;IAAU,CAAC;IAC/F,IAAI,kCAAkC,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,YAAY;MAAEC,KAAK,EAAE;IAAU,CAAC;IACjG,IAAI,qBAAqB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,UAAU;MAAEC,KAAK,EAAE;IAAO,CAAC;IAC/E,IAAI,sBAAsB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,UAAU;MAAEC,KAAK,EAAE;IAAY,CAAC;IACrF,IAAI,yBAAyB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,UAAU;MAAEC,KAAK,EAAE;IAAa,CAAC;IACzF,IAAI,oBAAoB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,UAAU;MAAEC,KAAK,EAAE;IAAM,CAAC;IAC7E,IAAI,qBAAqB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,KAAK;MAAEC,KAAK,EAAE;IAAU,CAAC;IAC7E,IAAI,SAAS,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,KAAK;MAAEC,KAAK,EAAE;IAAM,CAAC;IAC7D,IAAI,wBAAwB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,MAAM;MAAEC,KAAK,EAAE;IAAM,CAAC;IAC7E,IAAI,oBAAoB,CAAC1B,IAAI,CAACL,CAAC,CAAC,EAAE,OAAO;MAAE8B,MAAM,EAAE,MAAM;MAAEC,KAAK,EAAE;IAAM,CAAC;IACzE,OAAO;MAAED,MAAM,EAAE,KAAK;MAAEC,KAAK,EAAE;IAAM,CAAC;EACxC,CAAC;EAED,MAAMC,aAAa,GAAG5G,KAAK,CAACiG,IAAI,CAAC,IAAI5H,GAAG,CAACkG,WAAW,CAACpE,GAAG,CAAC4F,CAAC,IAAI;IAC5D,MAAMc,CAAC,GAAGL,aAAa,CAACT,CAAC,CAACvE,SAAS,CAAC;IACpC,OAAO,GAAGqF,CAAC,CAACH,MAAM,IAAIG,CAAC,CAACF,KAAK,EAAE;EACjC,CAAC,CAAC,CAACrG,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAK,OAAO,CAAC,CAAC,CAAC;;EAE/B;EACA,MAAMC,YAAsC,GAAG,CAAC,CAAC;EACjDH,aAAa,CAACI,OAAO,CAACH,CAAC,IAAI;IACzB,MAAM,CAACd,CAAC,EAAEY,KAAK,CAAC,GAAGE,CAAC,CAACI,KAAK,CAAC,GAAG,CAAC;IAC/B,IAAI,CAACF,YAAY,CAAChB,CAAC,CAAC,EAAEgB,YAAY,CAAChB,CAAC,CAAC,GAAG,EAAE;IAC1C,IAAI,CAACgB,YAAY,CAAChB,CAAC,CAAC,CAACmB,QAAQ,CAACP,KAAK,CAAC,EAAEI,YAAY,CAAChB,CAAC,CAAC,CAACoB,IAAI,CAACR,KAAK,CAAC;EACnE,CAAC,CAAC;EAEF,MAAMS,gBAA2B,GAAG7C,WAAW,CAACjE,MAAM,CAACyF,CAAC,IAAI;IAC1D,MAAMsB,UAAU,GAAGpL,iBAAiB,CAAC+G,MAAM,KAAK,CAAC,IAAI/G,iBAAiB,CAACiL,QAAQ,CAACnB,CAAC,CAACnE,QAAQ,CAAC;IAC3F,MAAM0F,KAAK,GAAGnL,QAAQ,KAAK,EAAE,IAAK,CAACoL,KAAK,CAACpF,MAAM,CAAChG,QAAQ,CAAC,CAAC,IAAI4J,CAAC,CAACtE,UAAU,IAAIU,MAAM,CAAChG,QAAQ,CAAE;IAC/F,MAAMqL,KAAK,GAAGnL,QAAQ,KAAK,EAAE,IAAK,CAACkL,KAAK,CAACpF,MAAM,CAAC9F,QAAQ,CAAC,CAAC,IAAI0J,CAAC,CAACtE,UAAU,IAAIU,MAAM,CAAC9F,QAAQ,CAAE;IAC/F,MAAM6J,CAAC,GAAGxB,WAAW,CAACqB,CAAC,CAACvE,SAAS,CAAC;IAClC,MAAMiG,OAAO,GAAG5K,cAAc,CAACmG,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACrB,KAAK,IAAIhI,cAAc,CAACqK,QAAQ,CAAChB,CAAC,CAACrB,KAAK,CAAE;IAC5F,MAAM6C,QAAQ,GAAG3K,cAAc,CAACiG,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACd,MAAM,IAAIrI,cAAc,CAACmK,QAAQ,CAAChB,CAAC,CAACd,MAAM,CAAE;IAC/F,MAAMuC,OAAO,GAAG1K,cAAc,CAAC+F,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACZ,KAAK,IAAIrI,cAAc,CAACiK,QAAQ,CAAChB,CAAC,CAACZ,KAAK,CAAE;IAC5F,MAAMsC,SAAS,GAAGzK,eAAe,CAAC6F,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACV,OAAO,IAAIrI,eAAe,CAAC+J,QAAQ,CAAChB,CAAC,CAACV,OAAO,CAAE;IACpG,MAAMqC,OAAO,GAAGxK,cAAc,CAAC2F,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACP,KAAK,IAAItI,cAAc,CAAC6J,QAAQ,CAAChB,CAAC,CAACP,KAAK,CAAE;IAC5F,MAAMmC,MAAM,GAAGvK,aAAa,CAACyF,MAAM,KAAK,CAAC,IAAKkD,CAAC,CAACL,IAAI,IAAItI,aAAa,CAAC2J,QAAQ,CAAChB,CAAC,CAACL,IAAI,CAAE;IAEvF,MAAMkC,GAAG,GAAGvB,aAAa,CAACT,CAAC,CAACvE,SAAS,CAAC;IACtC,MAAMwG,MAAM,GAAG,GAAGD,GAAG,CAACrB,MAAM,IAAIqB,GAAG,CAACpB,KAAK,EAAE;IAC3C;IACA,MAAMsB,UAAU,GAAGxK,kBAAkB,CAACuF,MAAM,KAAK,CAAC,IAChDvF,kBAAkB,CAACyK,IAAI,CAACC,EAAE,IAAIA,EAAE,KAAKJ,GAAG,CAACrB,MAAM,IAAIyB,EAAE,KAAKH,MAAM,CAAC;;IAEnE;IACA,MAAMI,SAAS,GAAGrC,CAAC,CAACtE,UAAU,GAAG,CAAC,IAAIsE,CAAC,CAACrE,SAAS,IAAIqE,CAAC,CAACrE,SAAS,KAAK,GAAG,IAAIqE,CAAC,CAACrE,SAAS,KAAK,EAAE;IAE9F,OAAO2F,UAAU,IAAIC,KAAK,IAAIE,KAAK,IAAIC,OAAO,IAAIC,QAAQ,IAAIC,OAAO,IAAIC,SAAS,IAAIC,OAAO,IAAIC,MAAM,IAAIG,UAAU,IAAIG,SAAS;EACpI,CAAC,CAAC;EACF,MAAMC,cAAyB,GAAG,CAAC,GAAGjB,gBAAgB,CAAC,CAACkB,IAAI,CAAC,CAACC,CAAC,EAAExD,CAAC,KAAK;IACrE,IAAIhJ,UAAU,KAAK,WAAW,EAAE,OAAOwM,CAAC,CAAC9G,UAAU,GAAGsD,CAAC,CAACtD,UAAU;IAClE,IAAI1F,UAAU,KAAK,YAAY,EAAE,OAAOgJ,CAAC,CAACtD,UAAU,GAAG8G,CAAC,CAAC9G,UAAU;IACnE,IAAI1F,UAAU,KAAK,UAAU,EAAE,OAAOwM,CAAC,CAAC3G,QAAQ,GAAGmD,CAAC,CAACnD,QAAQ;IAC7D,IAAI7F,UAAU,KAAK,MAAM,EAAE,OAAOwM,CAAC,CAAC/G,SAAS,CAACgH,aAAa,CAACzD,CAAC,CAACvD,SAAS,CAAC;IACxE,OAAO,CAAC;EACV,CAAC,CAAC;EACF,MAAMiH,cAAc,GAAIC,EAAU,IAAK;IACrCxM,oBAAoB,CAAC0E,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAACwB,EAAE,CAAC,GAAG9H,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAK4B,EAAE,CAAC,GAAG,CAAC,GAAG9H,IAAI,EAAE8H,EAAE,CAAC,CAAC;EAC9F,CAAC;EAED,MAAMC,UAAU,GAAGrK,YAAY,KAAK,OAAO,GACvCsK,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACE,IAAI,CAACpK,UAAU,GAAGjC,QAAQ,CAAC,CAAC,GAC7CmM,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACE,IAAI,CAACT,cAAc,CAACrF,MAAM,GAAGvG,QAAQ,CAAC,CAAC;EAE5D,MAAMsM,mBAAmB,GAAGzK,YAAY,KAAK,OAAO,GAChD+J,cAAc,GACdA,cAAc,CAACW,KAAK,CAAC,CAACzM,WAAW,GAAG,CAAC,IAAIE,QAAQ,EAAEF,WAAW,GAAGE,QAAQ,CAAC;EAC9E,MAAMwM,MAAM,GAAGA,CAAA,KAAMzM,cAAc,CAACuJ,CAAC,IAAI6C,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE9C,CAAC,GAAG,CAAC,CAAC,CAAC;EAC5D,MAAMmD,MAAM,GAAGA,CAAA,KAAM1M,cAAc,CAACuJ,CAAC,IAAI6C,IAAI,CAACO,GAAG,CAACR,UAAU,EAAE5C,CAAC,GAAG,CAAC,CAAC,CAAC;EACrE,MAAMqD,gBAAgB,GAAIvD,IAAY,IAAK;IAAEnJ,WAAW,CAACmJ,IAAI,CAAC;IAAErJ,cAAc,CAAC,CAAC,CAAC;EAAE,CAAC;EAEpF,MAAM6M,YAAY,GAAItD,CAAU,IAAK;IACnC,IAAIA,CAAC,CAAC1F,OAAO,EAAE,OAAO,MAAM0F,CAAC,CAAC1F,OAAO,EAAE;IACvC,MAAMiJ,IAAI,GAAG,GAAGvD,CAAC,CAACnE,QAAQ,IAAImE,CAAC,CAACrE,SAAS,IAAI,EAAE,IAAIqE,CAAC,CAACvE,SAAS,EAAE;IAChE,OAAO,KAAK8H,IAAI,EAAE;EACpB,CAAC;EACD,MAAMC,UAAU,GAAIC,GAAW,IAAK7M,YAAY,CAACuK,QAAQ,CAACsC,GAAG,CAAC;EAC9D,MAAMC,YAAY,GAAI1D,CAAU,IAAK;IACnC,MAAMyD,GAAG,GAAGH,YAAY,CAACtD,CAAC,CAAC;IAC3BnJ,eAAe,CAACgE,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAACsC,GAAG,CAAC,GAAG5I,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAK0C,GAAG,CAAC,GAAG,CAAC,GAAG5I,IAAI,EAAE4I,GAAG,CAAC,CAAC;EAC5F,CAAC;EAED,MAAME,iBAAiB,GAAIC,GAAY,IAAK;IAC1C,IAAI,CAACA,GAAG,EAAE,OAAO,OAAO;IACxB,IAAI;MACF,MAAMC,CAAC,GAAG,IAAIC,GAAG,CAACF,GAAG,CAACG,UAAU,CAAC,MAAM,CAAC,GAAGH,GAAG,GAAI,UAAU,GAAGA,GAAG,CAAClE,OAAO,CAAC,OAAO,EAAE,EAAE,CAAE,CAAC;MACzF,OAAOmE,CAAC,CAACG,QAAQ,CAACtE,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;IACzC,CAAC,CAAC,MAAM;MACN,OAAO,OAAO;IAChB;EACF,CAAC;EAED,oBACEzK,OAAA;IAAKgP,SAAS,EAAC,cAAc;IAAAC,QAAA,gBAC3BjP,OAAA;MAAKgP,SAAS,EAAC,gBAAgB;MAAAC,QAAA,gBAC7BjP,OAAA;QAAAiP,QAAA,EAAI;MAAM;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACfrP,OAAA;QAAMsP,QAAQ,EAAEnG,YAAa;QAAC6F,SAAS,EAAC,aAAa;QAAAC,QAAA,gBACnDjP,OAAA;UACEuP,IAAI,EAAC,MAAM;UACXC,KAAK,EAAElP,KAAM;UACbmP,QAAQ,EAAGjK,CAAC,IAAKjF,QAAQ,CAACiF,CAAC,CAACkK,MAAM,CAACF,KAAK,CAAE,CAAC;UAAA;UAC3CG,WAAW,EAAC,6EAAiB;UAC7BX,SAAS,EAAC;QAAc;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzB,CAAC,eACFrP,OAAA;UAAQuP,IAAI,EAAC,QAAQ;UAACP,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAC;QAAE;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvD,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC,EAEL1O,OAAO,iBAAIX,OAAA;MAAKgP,SAAS,EAAC,SAAS;MAAAC,QAAA,EAAC;IAAM;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,EAChDxO,KAAK,iBAAIb,OAAA;MAAKgP,SAAS,EAAC,OAAO;MAAAC,QAAA,EAAEpO;IAAK;MAAAqO,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,EAE7C,CAAC1O,OAAO,IAAI,CAACE,KAAK,IAAI0I,WAAW,CAACvB,MAAM,GAAG,CAAC,iBAC3ChI,OAAA;MAAKgP,SAAS,EAAC,mBAAmB;MAAAC,QAAA,gBAEhCjP,OAAA;QAAKgP,SAAS,EAAC,SAAS;QAAAC,QAAA,gBAEtBjP,OAAA;UAAKgP,SAAS,EAAC,uCAAuC;UAAAC,QAAA,eAClDjP,OAAA;YAAKgP,SAAS,EAAC,eAAe;YAAAC,QAAA,gBAC1BjP,OAAA;cACIgP,SAAS,EAAE,cAAc1L,YAAY,KAAK,OAAO,GAAG,QAAQ,GAAG,EAAE,EAAG;cACpEsM,OAAO,EAAEA,CAAA,KAAM;gBAAErM,eAAe,CAAC,OAAO,CAAC;gBAAE7C,gBAAgB,CAAC,EAAE,CAAC;cAAE,CAAE;cAAAuO,QAAA,EACtE;YAED;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACTrP,OAAA;cACIgP,SAAS,EAAE,cAAc1L,YAAY,KAAK,SAAS,GAAG,QAAQ,GAAG,EAAE,EAAG;cACtEsM,OAAO,EAAEA,CAAA,KAAM;gBAAErM,eAAe,CAAC,SAAS,CAAC;gBAAE7C,gBAAgB,CAAC,EAAE,CAAC;cAAE,CAAE;cAAAuO,QAAA,EACxE;YAED;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACR;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC,EAGL/L,YAAY,KAAK,OAAO,iBACrBtD,OAAA;UAAKgP,SAAS,EAAC,kCAAkC;UAAAC,QAAA,gBAC/CjP,OAAA;YAAIgP,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACvCrP,OAAA;YAAIgP,SAAS,EAAC,eAAe;YAAAC,QAAA,EAC1BrL,UAAU,CAACuB,GAAG,CAAC4H,GAAG,iBACf/M,OAAA;cAAoBgP,SAAS,EAAE,iBAAiB9K,YAAY,KAAK6I,GAAG,CAAC8C,KAAK,GAAG,QAAQ,GAAG,EAAE,EAAG;cAAAZ,QAAA,gBACzFjP,OAAA;gBAAKgP,SAAS,EAAC,gBAAgB;gBAACY,OAAO,EAAEA,CAAA,KAAMzL,eAAe,CAAC4I,GAAG,CAAC8C,KAAK,KAAK3L,YAAY,GAAG,IAAI,GAAG6I,GAAG,CAAC8C,KAAK,CAAE;gBAAAZ,QAAA,EACzGlC,GAAG,CAAC+C;cAAO;gBAAAZ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACX,CAAC,EACLtC,GAAG,CAACkC,QAAQ,IAAIlC,GAAG,CAACkC,QAAQ,CAACjH,MAAM,GAAG,CAAC,iBACpChI,OAAA;gBAAIgP,SAAS,EAAC,mBAAmB;gBAAAC,QAAA,EAC5BlC,GAAG,CAACkC,QAAQ,CAAC9J,GAAG,CAAEwG,KAAU,iBACzB3L,OAAA;kBAAsBgP,SAAS,EAAE,oBAAoB9K,YAAY,KAAKyH,KAAK,CAACkE,KAAK,GAAG,QAAQ,GAAG,EAAE,EAAG;kBAAAZ,QAAA,eAChGjP,OAAA;oBAAM4P,OAAO,EAAEA,CAAA,KAAMzL,eAAe,CAACwH,KAAK,CAACkE,KAAK,KAAK3L,YAAY,GAAG,IAAI,GAAGyH,KAAK,CAACkE,KAAK,CAAE;oBAAAZ,QAAA,EACnFtD,KAAK,CAACmE;kBAAO;oBAAAZ,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACZ;gBAAC,GAHF1D,KAAK,CAACkE,KAAK;kBAAAX,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAIhB,CACP;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACF,CACP;YAAA,GAdItC,GAAG,CAAC8C,KAAK;cAAAX,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAed,CACP;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACF,CACR,EAGA/L,YAAY,KAAK,OAAO,IAAIQ,cAAc,CAACkE,MAAM,GAAG,CAAC,iBAClDhI,OAAA;UAAKgP,SAAS,EAAC,iCAAiC;UAAAC,QAAA,gBAC5CjP,OAAA;YAAIgP,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACtCvL,cAAc,CAACqB,GAAG,CAAC4K,IAAI,iBACpB/P,OAAA;YAAuBgP,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAC3CjP,OAAA;cAAAiP,QAAA,EAAKc,IAAI,CAACC;YAAQ;cAAAd,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC,eACxBrP,OAAA;cAAIgP,SAAS,EAAC,gBAAgB;cAAAC,QAAA,EACzBc,IAAI,CAACE,MAAM,IAAIF,IAAI,CAACE,MAAM,CAAC9K,GAAG,CAAE+K,GAAW,iBACxClQ,OAAA;gBAAAiP,QAAA,eACIjP,OAAA;kBAAAiP,QAAA,gBACIjP,OAAA;oBACIuP,IAAI,EAAC,UAAU;oBACfY,OAAO,EAAEnM,sBAAsB,CAAC+L,IAAI,CAACK,MAAM,CAAC,KAAKF,GAAI;oBACrDT,QAAQ,EAAEA,CAAA,KAAM;sBACZxL,yBAAyB,CAAC2B,IAAI,IAAI;wBAC9B,IAAIA,IAAI,CAACmK,IAAI,CAACK,MAAM,CAAC,KAAKF,GAAG,EAAE;0BAC3B,MAAMrK,IAAI,GAAG;4BAAE,GAAGD;0BAAK,CAAC;0BACxB,OAAOC,IAAI,CAACkK,IAAI,CAACK,MAAM,CAAC;0BACxB,OAAOvK,IAAI;wBACf;wBACA,OAAO;0BAAE,GAAGD,IAAI;0BAAE,CAACmK,IAAI,CAACK,MAAM,GAAGF;wBAAI,CAAC;sBAC1C,CAAC,CAAC;oBACN;kBAAE;oBAAAhB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACL,CAAC,EACDa,GAAG;gBAAA;kBAAAhB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACD;cAAC,GAjBHa,GAAG;gBAAAhB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAkBR,CACP;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACF,CAAC;UAAA,GAxBCU,IAAI,CAACK,MAAM;YAAAlB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAyBhB,CACR,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CACR,EAEA/L,YAAY,KAAK,SAAS,iBACvBtD,OAAA,CAAAE,SAAA;UAAA+O,QAAA,gBACAjP,OAAA;YAAKgP,SAAS,EAAC,kCAAkC;YAAAC,QAAA,gBACjDjP,OAAA;cAAIgP,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAI;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,EACtCgB,MAAM,CAACC,IAAI,CAACvE,YAAY,CAAC,CAAC/D,MAAM,GAAG,CAAC,gBACjChI,OAAA;cAAIgP,SAAS,EAAC,eAAe;cAAAC,QAAA,EAC5BoB,MAAM,CAACC,IAAI,CAACvE,YAAY,CAAC,CAAC5G,GAAG,CAACuG,MAAM,iBACjC1L,OAAA;gBAAiBgP,SAAS,EAAC,iBAAiB;gBAAAC,QAAA,gBAC5CjP,OAAA;kBAAKgP,SAAS,EAAC,cAAc;kBAACY,OAAO,EAAEA,CAAA,KAAM;oBACzC;oBACA;oBACAlN,qBAAqB,CAACkD,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAACR,MAAM,CAAC,GAAG9F,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAKJ,MAAM,IAAI,CAACI,CAAC,CAACgD,UAAU,CAACpD,MAAM,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG9F,IAAI,EAAE8F,MAAM,CAAC,CAAC;kBAC5I,CAAE;kBAAAuD,QAAA,gBACEjP,OAAA;oBAAOuP,IAAI,EAAC,UAAU;oBAACY,OAAO,EAAE1N,kBAAkB,CAACyJ,QAAQ,CAACR,MAAM,CAAE;oBAAC6E,QAAQ;kBAAA;oBAAArB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eAChFrP,OAAA;oBAAAiP,QAAA,EAAOvD;kBAAM;oBAAAwD,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACpB,CAAC,eACNrP,OAAA;kBAAIgP,SAAS,EAAC,mBAAmB;kBAAAC,QAAA,EAC5BlD,YAAY,CAACL,MAAM,CAAC,CAACvG,GAAG,CAACwG,KAAK,IAAI;oBACnC,MAAM6E,QAAQ,GAAG,GAAG9E,MAAM,IAAIC,KAAK,EAAE;oBACrC,oBACI3L,OAAA;sBAAAiP,QAAA,eACAjP,OAAA;wBAAAiP,QAAA,gBACIjP,OAAA;0BACAuP,IAAI,EAAC,UAAU;0BACfY,OAAO,EAAE1N,kBAAkB,CAACyJ,QAAQ,CAACsE,QAAQ,CAAC,IAAI/N,kBAAkB,CAACyJ,QAAQ,CAACR,MAAM,CAAE;0BACtF+D,QAAQ,EAAEA,CAAA,KAAM;4BACZ/M,qBAAqB,CAACkD,IAAI,IAAI;8BAC9B,MAAM6K,gBAAgB,GAAG7K,IAAI,CAACsG,QAAQ,CAACR,MAAM,CAAC;8BAC9C,MAAMgF,eAAe,GAAG9K,IAAI,CAACsG,QAAQ,CAACsE,QAAQ,CAAC;8BAC/C,IAAIC,gBAAgB,EAAE;gCAClB,MAAME,MAAM,GAAG/K,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAKJ,MAAM,IAAI,CAACI,CAAC,CAACgD,UAAU,CAACpD,MAAM,GAAG,GAAG,CAAC,CAAC;gCAC5E,MAAMkF,QAAQ,GAAG7E,YAAY,CAACL,MAAM,CAAC,CAACvG,GAAG,CAAC0G,CAAC,IAAI,GAAGH,MAAM,IAAIG,CAAC,EAAE,CAAC;gCAChE,OAAO,CAAC,GAAG8E,MAAM,EAAE,GAAGC,QAAQ,CAACtL,MAAM,CAACuL,CAAC,IAAIA,CAAC,KAAKL,QAAQ,CAAC,CAAC;8BAC/D;8BACA,OAAOE,eAAe,GAAG9K,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAIA,CAAC,KAAK0E,QAAQ,CAAC,GAAG,CAAC,GAAG5K,IAAI,EAAE4K,QAAQ,CAAC;4BAC/E,CAAC,CAAC;0BACN;wBAAE;0BAAAtB,QAAA,EAAAC,YAAA;0BAAAC,UAAA;0BAAAC,YAAA;wBAAA,OACD,CAAC,EACD1D,KAAK;sBAAA;wBAAAuD,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OACH;oBAAC,GAnBCmB,QAAQ;sBAAAtB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAoBb,CAAC;kBAET,CAAC;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACF,CAAC;cAAA,GApCI3D,MAAM;gBAAAwD,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAqCX,CACP;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,gBACLrP,OAAA;cAAKgP,SAAS,EAAC,gBAAgB;cAAAC,QAAA,EAAC;YAAK;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1C,CAAC,eAENrP,OAAA;YAAKgP,SAAS,EAAC,iBAAiB;YAAAC,QAAA,gBAChCjP,OAAA;cAAIgP,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAM;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACzCrP,OAAA;cAAIgP,SAAS,EAAC,aAAa;cAAAC,QAAA,EACtBjE,MAAM,CAAC7F,GAAG,CAAC4E,CAAC,iBACb/J,OAAA;gBAAAiP,QAAA,eACIjP,OAAA;kBAAAiP,QAAA,gBACAjP,OAAA;oBACIuP,IAAI,EAAC,UAAU;oBACfY,OAAO,EAAEtO,cAAc,CAACqK,QAAQ,CAACnC,CAAC,CAAE;oBACpC0F,QAAQ,EAAEA,CAAA,KAAM3N,iBAAiB,CAAC8D,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAACnC,CAAC,CAAC,GAAGnE,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAEA,CAAC,KAAG/B,CAAC,CAAC,GAAG,CAAC,GAAGnE,IAAI,EAACmE,CAAC,CAAC;kBAAE;oBAAAmF,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrG,CAAC,EACDtF,CAAC;gBAAA;kBAAAmF,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACK;cAAC,GARHtF,CAAC;gBAAAmF,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OASN,CACH;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACF,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CAAC,eAENrP,OAAA;YAAKgP,SAAS,EAAC,iBAAiB;YAAAC,QAAA,gBAChCjP,OAAA;cAAIgP,SAAS,EAAC,eAAe;cAAAC,QAAA,EAAC;YAAI;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,EACtCjF,MAAM,CAACpC,MAAM,GAAG,CAAC,iBACdhI,OAAA;cAAKgP,SAAS,EAAC,YAAY;cAAAC,QAAA,gBAC3BjP,OAAA;gBAAAiP,QAAA,EAAI;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACXrP,OAAA;gBAAIgP,SAAS,EAAC,aAAa;gBAAAC,QAAA,EACtB7E,MAAM,CAAC4D,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC7I,GAAG,CAAC0L,CAAC,iBAC1B7Q,OAAA;kBAAAiP,QAAA,eAAYjP,OAAA;oBAAAiP,QAAA,gBAAOjP,OAAA;sBAAOuP,IAAI,EAAC,UAAU;sBAACY,OAAO,EAAEpO,cAAc,CAACmK,QAAQ,CAAC2E,CAAC,CAAE;sBAACpB,QAAQ,EAAEA,CAAA,KAAMzN,iBAAiB,CAAC4D,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAAC2E,CAAC,CAAC,GAAGjL,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAEA,CAAC,KAAG+E,CAAC,CAAC,GAAG,CAAC,GAAGjL,IAAI,EAACiL,CAAC,CAAC;oBAAE;sBAAA3B,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,KAAC,EAACwB,CAAC;kBAAA;oBAAA3B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ;gBAAC,GAAvLwB,CAAC;kBAAA3B,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAA0L,CACnM;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACF,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CACR,EACAhE,QAAQ,CAACrD,MAAM,GAAG,CAAC,iBAChBhI,OAAA;cAAKgP,SAAS,EAAC,YAAY;cAAAC,QAAA,gBAC3BjP,OAAA;gBAAAiP,QAAA,EAAI;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACXrP,OAAA;gBAAIgP,SAAS,EAAC,aAAa;gBAAAC,QAAA,EACtB5D,QAAQ,CAAClG,GAAG,CAAC0L,CAAC,iBACf7Q,OAAA;kBAAAiP,QAAA,eAAYjP,OAAA;oBAAAiP,QAAA,gBAAOjP,OAAA;sBAAOuP,IAAI,EAAC,UAAU;sBAACY,OAAO,EAAEhO,eAAe,CAAC+J,QAAQ,CAAC2E,CAAC,CAAE;sBAACpB,QAAQ,EAAEA,CAAA,KAAMrN,kBAAkB,CAACwD,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAAC2E,CAAC,CAAC,GAAGjL,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAEA,CAAC,KAAG+E,CAAC,CAAC,GAAG,CAAC,GAAGjL,IAAI,EAACiL,CAAC,CAAC;oBAAE;sBAAA3B,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,KAAC,EAACwB,CAAC;kBAAA;oBAAA3B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ;gBAAC,GAAzLwB,CAAC;kBAAA3B,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAA4L,CACrM;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACF,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CACR,EACA/D,MAAM,CAACtD,MAAM,GAAG,CAAC,iBACdhI,OAAA;cAAKgP,SAAS,EAAC,YAAY;cAAAC,QAAA,gBAC3BjP,OAAA;gBAAAiP,QAAA,EAAI;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACXrP,OAAA;gBAAIgP,SAAS,EAAC,aAAa;gBAAAC,QAAA,EACtB3D,MAAM,CAAC0C,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC7I,GAAG,CAAC0G,CAAC,iBACzB7L,OAAA;kBAAAiP,QAAA,eAAYjP,OAAA;oBAAAiP,QAAA,gBAAOjP,OAAA;sBAAOuP,IAAI,EAAC,UAAU;sBAACY,OAAO,EAAE9N,cAAc,CAAC6J,QAAQ,CAACL,CAAC,CAAE;sBAAC4D,QAAQ,EAAEA,CAAA,KAAMnN,iBAAiB,CAACsD,IAAI,IAAIA,IAAI,CAACsG,QAAQ,CAACL,CAAC,CAAC,GAAGjG,IAAI,CAACN,MAAM,CAACwG,CAAC,IAAEA,CAAC,KAAGD,CAAC,CAAC,GAAG,CAAC,GAAGjG,IAAI,EAACiG,CAAC,CAAC;oBAAE;sBAAAqD,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAE,CAAC,KAAC,EAACxD,CAAC;kBAAA;oBAAAqD,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ;gBAAC,GAAvLxD,CAAC;kBAAAqD,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAA0L,CACnM;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACF,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CACR;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACI,CAAC;QAAA,eACJ,CACL,eAEDrP,OAAA;UAAKgP,SAAS,EAAC,iBAAiB;UAAAC,QAAA,gBAC9BjP,OAAA;YAAIgP,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACvCrP,OAAA;YAAKgP,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACjCjP,OAAA;cAAOuP,IAAI,EAAC,QAAQ;cAACI,WAAW,EAAC,UAAO;cAACH,KAAK,EAAErO,QAAS;cAACsO,QAAQ,EAAEjK,CAAC,IAAIpE,WAAW,CAACoE,CAAC,CAACkK,MAAM,CAACF,KAAK;YAAE;cAAAN,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACxGrP,OAAA;cAAAiP,QAAA,EAAM;YAAC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACdrP,OAAA;cAAOuP,IAAI,EAAC,QAAQ;cAACI,WAAW,EAAC,UAAO;cAACH,KAAK,EAAEnO,QAAS;cAACoO,QAAQ,EAAEjK,CAAC,IAAIlE,WAAW,CAACkE,CAAC,CAACkK,MAAM,CAACF,KAAK;YAAE;cAAAN,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENrP,OAAA;UAAKgP,SAAS,EAAC,iBAAiB;UAAAC,QAAA,gBAC7BjP,OAAA;YAAIgP,SAAS,EAAC,eAAe;YAAAC,QAAA,EAAC;UAAE;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACrCrP,OAAA;YAAIgP,SAAS,EAAC,aAAa;YAAAC,QAAA,gBACzBjP,OAAA;cAAAiP,QAAA,eAAIjP,OAAA;gBAAAiP,QAAA,gBAAOjP,OAAA;kBAAOuP,IAAI,EAAC,UAAU;kBAACY,OAAO,EAAElP,iBAAiB,CAACiL,QAAQ,CAAC,EAAE,CAAE;kBAACuD,QAAQ,EAAEA,CAAA,KAAMhC,cAAc,CAAC,EAAE;gBAAE;kBAAAyB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,iBAAG;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACjIrP,OAAA;cAAAiP,QAAA,eAAIjP,OAAA;gBAAAiP,QAAA,gBAAOjP,OAAA;kBAAOuP,IAAI,EAAC,UAAU;kBAACY,OAAO,EAAElP,iBAAiB,CAACiL,QAAQ,CAAC,EAAE,CAAE;kBAACuD,QAAQ,EAAEA,CAAA,KAAMhC,cAAc,CAAC,EAAE;gBAAE;kBAAAyB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,+CAAa;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAC3IrP,OAAA;cAAAiP,QAAA,eAAIjP,OAAA;gBAAAiP,QAAA,gBAAOjP,OAAA;kBAAOuP,IAAI,EAAC,UAAU;kBAACY,OAAO,EAAElP,iBAAiB,CAACiL,QAAQ,CAAC,EAAE,CAAE;kBAACuD,QAAQ,EAAEA,CAAA,KAAMhC,cAAc,CAAC,EAAE;gBAAE;kBAAAyB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,WAAO;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnI,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNrP,OAAA;QAAKgP,SAAS,EAAC,cAAc;QAAAC,QAAA,gBAC3BjP,OAAA;UAAKgP,SAAS,EAAC,gBAAgB;UAAAC,QAAA,gBAC7BjP,OAAA;YAAAiP,QAAA,GAAI,IAAC,EAAC3O,KAAK,EAAC,8BAAO,eAAAN,OAAA;cAAAiP,QAAA,GAAM,GAAC,EAAC7C,gBAAgB,CAACpE,MAAM,EAAC,SAAE;YAAA;cAAAkH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACjErP,OAAA;YAAKgP,SAAS,EAAC,UAAU;YAAAC,QAAA,gBACvBjP,OAAA;cAAMgP,SAAS,EAAC,YAAY;cAAAC,QAAA,EAAC;YAAG;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eACvCrP,OAAA;cAAQgP,SAAS,EAAE,YAAYjO,UAAU,KAAK,WAAW,GAAG,QAAQ,GAAG,EAAE,EAAG;cAAC6O,OAAO,EAAEA,CAAA,KAAM5O,aAAa,CAAC,WAAW,CAAE;cAAAiO,QAAA,EAAC;YAAK;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACtIrP,OAAA;cAAQgP,SAAS,EAAE,YAAYjO,UAAU,KAAK,YAAY,GAAG,QAAQ,GAAG,EAAE,EAAG;cAAC6O,OAAO,EAAEA,CAAA,KAAM5O,aAAa,CAAC,YAAY,CAAE;cAAAiO,QAAA,EAAC;YAAK;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACxIrP,OAAA;cAAQgP,SAAS,EAAE,YAAYjO,UAAU,KAAK,UAAU,GAAG,QAAQ,GAAG,EAAE,EAAG;cAAC6O,OAAO,EAAEA,CAAA,KAAM5O,aAAa,CAAC,UAAU,CAAE;cAAAiO,QAAA,EAAC;YAAE;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9H,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAENrP,OAAA;UAAKgP,SAAS,EAAC,mBAAmB;UAAAC,QAAA,EAC/BlB,mBAAmB,CAAC5I,GAAG,CAAC,CAACgB,OAAO,EAAE2K,KAAK,kBACtC9Q,OAAA;YAAiBgP,SAAS,EAAC,aAAa;YAAAC,QAAA,gBACtCjP,OAAA;cAAKgP,SAAS,EAAC,SAAS;cAAAC,QAAA,eACtBjP,OAAA;gBAAK+Q,GAAG,EAAE5K,OAAO,CAACQ,MAAM,IAAI,8BAA+B;gBAACqK,GAAG,EAAE7K,OAAO,CAACK,SAAU;gBAACyK,OAAO,EAAGzL,CAAC,IAAMA,CAAC,CAACkK,MAAM,CAAsBqB,GAAG,GAAG;cAA+B;gBAAA7B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxK,CAAC,eACNrP,OAAA;cAAKgP,SAAS,EAAC,QAAQ;cAAAC,QAAA,gBACrBjP,OAAA;gBAAKgP,SAAS,EAAC,aAAa;gBAAAC,QAAA,eAC1BjP,OAAA;kBAAGkR,IAAI,EAAE/K,OAAO,CAACO,SAAU;kBAACgJ,MAAM,EAAC,QAAQ;kBAACyB,GAAG,EAAC,qBAAqB;kBAACnC,SAAS,EAAC,SAAS;kBAACY,OAAO,EAAEA,CAAA,KAAM;oBAAE,IAAIzJ,OAAO,CAACd,OAAO,EAAE;sBAAExF,OAAO,CAACuR,UAAU,CAACjL,OAAO,CAACd,OAAO,CAAC;oBAAE;kBAAE,CAAE;kBAAA4J,QAAA,EAAE9I,OAAO,CAACK;gBAAS;kBAAA0I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChM,CAAC,eACNrP,OAAA;gBAAKgP,SAAS,EAAC,SAAS;gBAAAC,QAAA,EACpB,YAAU;kBACV,MAAM/D,CAAC,GAAGxB,WAAW,CAACvD,OAAO,CAACK,SAAS,CAAC;kBACxC,MAAM6K,KAAK,GAAG,CAACnG,CAAC,CAACrB,KAAK,EAAEqB,CAAC,CAACd,MAAM,EAAEc,CAAC,CAACZ,KAAK,EAAEY,CAAC,CAACV,OAAO,EAAEU,CAAC,CAACP,KAAK,EAAEO,CAAC,CAACL,IAAI,CAAC,CAACvF,MAAM,CAAC6F,OAAO,CAAC;kBACtF,OAAOkG,KAAK,CAACC,IAAI,CAAC,KAAK,CAAC;gBAC1B,CAAC,CAAE;cAAC;gBAAApC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC,eACNrP,OAAA;gBAAKgP,SAAS,EAAC,QAAQ;gBAAAC,QAAA,gBACrBjP,OAAA;kBAAMgP,SAAS,EAAE,iBAAiB7I,OAAO,CAACS,QAAQ,EAAG;kBAAAqI,QAAA,EAAElH,eAAe,CAAC5B,OAAO,CAACS,QAAQ;gBAAC;kBAAAsI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC,eAChGrP,OAAA;kBAAMgP,SAAS,EAAC,QAAQ;kBAAAC,QAAA,EAAEP,iBAAiB,CAACvI,OAAO,CAACO,SAAS;gBAAC;kBAAAwI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACNrP,OAAA;cAAKgP,SAAS,EAAC,UAAU;cAAAC,QAAA,gBACvBjP,OAAA;gBAAKgP,SAAS,EAAC,SAAS;gBAAAC,QAAA,GAAE9I,OAAO,CAACM,UAAU,CAAC8K,cAAc,CAAC,CAAC,EAAC,QAAC;cAAA;gBAAArC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACrErP,OAAA;gBAAGkR,IAAI,EAAE/K,OAAO,CAACO,SAAU;gBAACgJ,MAAM,EAAC,QAAQ;gBAACyB,GAAG,EAAC,qBAAqB;gBAACnC,SAAS,EAAC,UAAU;gBAACY,OAAO,EAAEA,CAAA,KAAM;kBAAE,IAAIzJ,OAAO,CAACd,OAAO,EAAE;oBAAExF,OAAO,CAACuR,UAAU,CAACjL,OAAO,CAACd,OAAO,CAAC;kBAAE;gBAAE,CAAE;gBAAA4J,QAAA,EAAC;cAAI;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eACrLrP,OAAA;gBAAQgP,SAAS,EAAC,WAAW;gBAACY,OAAO,EAAEA,CAAA,KAAM;kBAAE1J,uBAAuB,CAACC,OAAO,CAAC;gBAAE,CAAE;gBAAA8I,QAAA,EAAE9I,OAAO,CAACd,OAAO,IAAIlC,YAAY,CAACuC,GAAG,CAACS,OAAO,CAACd,OAAO,CAAC,GAAG,MAAM,GAAG;cAAI;gBAAA6J,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAS,CAAC,eACnKrP,OAAA;gBAAQgP,SAAS,EAAC,WAAW;gBAACY,OAAO,EAAEA,CAAA,KAAM;kBACzC,MAAM4B,KAAK,GAAGrL,OAAO,CAACK,SAAS;kBAC/B,MAAMiL,MAAM,GAAGzM,KAAK,CAACiG,IAAI,CAAC;oBAACjD,MAAM,EAAC;kBAAE,CAAC,EAAE,CAAC0J,CAAC,EAACC,CAAC,KAAG;oBAC5C,MAAMC,CAAC,GAAG,IAAIC,IAAI,CAAC,CAAC;oBACpBD,CAAC,CAACE,QAAQ,CAACF,CAAC,CAACG,QAAQ,CAAC,CAAC,IAAI,EAAE,GAAGJ,CAAC,CAAC,CAAC;oBACnC,MAAMK,CAAC,GAAG,CAACJ,CAAC,CAACG,QAAQ,CAAC,CAAC,GAAC,CAAC,EAAEE,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAC,GAAG,CAAC;oBACrD,OAAO,GAAGN,CAAC,CAACO,WAAW,CAAC,CAAC,IAAIH,CAAC,EAAE;kBAClC,CAAC,CAAC;kBACF,MAAM1D,IAAI,GAAGV,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE1H,OAAO,CAACM,UAAU,CAAC;kBAC5C,IAAIyJ,GAAG,GAAG5B,IAAI,GAAG,GAAG;kBACpB,MAAMlE,MAAM,GAAGqH,MAAM,CAACtM,GAAG,CAAC,CAACuM,CAAC,EAACC,CAAC,KAAG;oBAC/B,MAAMS,KAAK,GAAG,CAAC,GAAGxE,IAAI,CAACyE,GAAG,CAACV,CAAC,GAAC,CAAC,CAAC,GAAG,IAAI;oBACtC,MAAMW,KAAK,GAAG,CAAC,GAAI,CAAC1E,IAAI,CAAC2E,MAAM,CAAC,CAAC,GAAG,GAAG,IAAI,IAAK;oBAChDrC,GAAG,GAAGtC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEqC,GAAG,GAAGkC,KAAK,GAAGE,KAAK,CAAC;oBACtC,OAAO1E,IAAI,CAAC4E,KAAK,CAACtC,GAAG,CAAC;kBACxB,CAAC,CAAC;kBACFhN,aAAa,CAACsO,KAAK,CAAC;kBACpB1O,cAAc,CAAC2O,MAAM,CAAC;kBACtBzO,cAAc,CAACoH,MAAM,CAAC;kBACtBxH,YAAY,CAAC,IAAI,CAAC;gBACtB,CAAE;gBAAAqM,QAAA,EAAC;cAAI;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eAChBrP,OAAA;gBAAOgP,SAAS,EAAC,eAAe;gBAAAC,QAAA,gBAC9BjP,OAAA;kBAAOuP,IAAI,EAAC,UAAU;kBAACY,OAAO,EAAE5B,UAAU,CAACF,YAAY,CAAClI,OAAO,CAAC,CAAE;kBAACsJ,QAAQ,EAAEA,CAAA,KAAMhB,YAAY,CAACtI,OAAO;gBAAE;kBAAA+I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,iBAC9G;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL,CAAC;UAAA,GAhDEyB,KAAK;YAAA5B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAiDV,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eAENrP,OAAA;UAAKgP,SAAS,EAAC,qBAAqB;UAAAC,QAAA,gBAChCjP,OAAA;YAAQuP,IAAI,EAAC,QAAQ;YAACK,OAAO,EAAE3B,MAAO;YAACwE,QAAQ,EAAElR,WAAW,KAAK,CAAE;YAAA0N,QAAA,EAAC;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAChFrP,OAAA;YAAMgP,SAAS,EAAC,WAAW;YAAAC,QAAA,GAAE1N,WAAW,EAAC,KAAG,EAACoM,UAAU;UAAA;YAAAuB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC/DrP,OAAA;YAAQuP,IAAI,EAAC,QAAQ;YAACK,OAAO,EAAE1B,MAAO;YAACuE,QAAQ,EAAElR,WAAW,KAAKoM,UAAW;YAAAsB,QAAA,EAAC;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxF,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EAEL1M,SAAS,iBACR3C,OAAA;QAAKgP,SAAS,EAAC,mBAAmB;QAACY,OAAO,EAAEA,CAAA,KAAMhN,YAAY,CAAC,KAAK,CAAE;QAAAqM,QAAA,eACpEjP,OAAA;UAAKgP,SAAS,EAAC,eAAe;UAACY,OAAO,EAAGpK,CAAC,IAAKA,CAAC,CAACkN,eAAe,CAAC,CAAE;UAAAzD,QAAA,gBACjEjP,OAAA;YAAKgP,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAC3BjP,OAAA;cAAMgP,SAAS,EAAC,aAAa;cAAAC,QAAA,EAAEhM;YAAU;cAAAiM,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACjDrP,OAAA;cAAQuP,IAAI,EAAC,QAAQ;cAACP,SAAS,EAAC,aAAa;cAACY,OAAO,EAAEA,CAAA,KAAMhN,YAAY,CAAC,KAAK,CAAE;cAAAqM,QAAA,EAAC;YAAC;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzF,CAAC,eACNrP,OAAA;YAAKgP,SAAS,EAAC,YAAY;YAAAC,QAAA,eACzBjP,OAAA;cAAKgP,SAAS,EAAC,aAAa;cAAAC,QAAA,EACxB,YAAU;gBACV,MAAM0D,KAAK,GAAG,GAAG;gBACjB,MAAMC,MAAM,GAAG,GAAG;gBAClB,MAAMC,OAAO,GAAG,EAAE;gBAClB,MAAMC,EAAE,GAAG/P,WAAW,CAACoC,GAAG,CAAC,CAACuM,CAAC,EAACC,CAAC,KAAIkB,OAAO,GAAIlB,CAAC,IAAEgB,KAAK,GAAG,CAAC,GAACE,OAAO,CAAC,IAAG9P,WAAW,CAACiF,MAAM,GAAC,CAAC,CAAC,CAAC;gBAC5F,MAAM+K,IAAI,GAAGnF,IAAI,CAACO,GAAG,CAAC,GAAGpL,WAAW,CAAC;gBACrC,MAAMiQ,IAAI,GAAGpF,IAAI,CAACC,GAAG,CAAC,GAAG9K,WAAW,CAAC;gBACrC,MAAMkQ,EAAE,GAAGlQ,WAAW,CAACoC,GAAG,CAAC+N,CAAC,IAAIN,MAAM,GAAGC,OAAO,GAAI,CAACK,CAAC,GAAGH,IAAI,IAAKnF,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEmF,IAAI,GAAGD,IAAI,CAAE,IAAKH,MAAM,GAAG,CAAC,GAACC,OAAO,CAAC,CAAC;gBACpH,MAAMM,IAAI,GAAGL,EAAE,CAAC3N,GAAG,CAAC,CAAC2G,CAAC,EAAC6F,CAAC,KAAI,GAAGA,CAAC,KAAG,CAAC,GAAC,GAAG,GAAC,GAAG,GAAG7F,CAAC,IAAImH,EAAE,CAACtB,CAAC,CAAC,EAAE,CAAC,CAACL,IAAI,CAAC,GAAG,CAAC;gBACtE,MAAM8B,KAAK,GAAG,CAAC,IAAI,EAAC,GAAG,EAAC,IAAI,CAAC,CAACjO,GAAG,CAACkO,CAAC,IAAIT,MAAM,GAAGC,OAAO,GAAGQ,CAAC,IAAET,MAAM,GAAG,CAAC,GAACC,OAAO,CAAC,CAAC;gBACjF,oBACE7S,OAAA;kBAAK2S,KAAK,EAAEA,KAAM;kBAACC,MAAM,EAAEA,MAAO;kBAACU,IAAI,EAAC,KAAK;kBAAC,cAAW,gCAAO;kBAAArE,QAAA,GAC7DmE,KAAK,CAACjO,GAAG,CAAC,CAACoO,EAAE,EAAC5B,CAAC,kBACd3R,OAAA;oBAAcwT,EAAE,EAAEX,OAAQ;oBAACY,EAAE,EAAEF,EAAG;oBAACG,EAAE,EAAEf,KAAK,GAACE,OAAQ;oBAACc,EAAE,EAAEJ,EAAG;oBAACK,MAAM,EAAC;kBAAM,GAAhEjC,CAAC;oBAAAzC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAiE,CAC9E,CAAC,eACFrP,OAAA;oBAAM4R,CAAC,EAAEuB,IAAK;oBAACU,IAAI,EAAC,MAAM;oBAACD,MAAM,EAAC,SAAS;oBAACE,WAAW,EAAE;kBAAE;oBAAA5E,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,EAC7DyD,EAAE,CAAC3N,GAAG,CAAC,CAAC2G,CAAC,EAAC6F,CAAC,kBACV3R,OAAA;oBAAgB+T,EAAE,EAAEjI,CAAE;oBAACkI,EAAE,EAAEf,EAAE,CAACtB,CAAC,CAAE;oBAAC0B,CAAC,EAAE,CAAE;oBAACQ,IAAI,EAAC;kBAAS,GAAzClC,CAAC;oBAAAzC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAA0C,CACzD,CAAC,eACFrP,OAAA;oBAAM8L,CAAC,EAAE+G,OAAQ;oBAACoB,CAAC,EAAErB,MAAM,GAAC,CAAE;oBAACsB,QAAQ,EAAE,EAAG;oBAACL,IAAI,EAAC,MAAM;oBAAA5E,QAAA,EAAEpM,WAAW,CAAC,CAAC;kBAAC;oBAAAqM,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC,eAChFrP,OAAA;oBAAM8L,CAAC,EAAE6G,KAAK,GAACE,OAAO,GAAC,EAAG;oBAACoB,CAAC,EAAErB,MAAM,GAAC,CAAE;oBAACsB,QAAQ,EAAE,EAAG;oBAACL,IAAI,EAAC,MAAM;oBAAA5E,QAAA,EAAEpM,WAAW,CAACA,WAAW,CAACmF,MAAM,GAAC,CAAC;kBAAC;oBAAAkH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACzG,CAAC;cAEV,CAAC,CAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CACN,EAEA,CAAC1O,OAAO,IAAI,CAACE,KAAK,IAAIJ,aAAa,CAACuH,MAAM,KAAK,CAAC,IAAI1H,KAAK,iBACxDN,OAAA;MAAKgP,SAAS,EAAC,YAAY;MAAAC,QAAA,EAAC;IAAY;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAC9C;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACjP,EAAA,CAn7BID,WAAqB;EAAA,QACFT,eAAe;AAAA;AAAAyU,EAAA,GADlChU,WAAqB;AAq7B3B,eAAeA,WAAW;AAAC,IAAAgU,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}