{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useSearchParams}from'react-router-dom';import'./ComparePage.css';import{goodsApi}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ComparePage=()=>{const[searchParams]=useSearchParams();const[query,setQuery]=useState(searchParams.get('query')||'');const[compareGroups,setCompareGroups]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[sortOption,setSortOption]=useState('price_asc');const[selectedPlatforms,setSelectedPlatforms]=useState([]);const[minPrice,setMinPrice]=useState('');const[maxPrice,setMaxPrice]=useState('');const[viewMode,setViewMode]=useState('grid');const[currentPage,setCurrentPage]=useState(1);const[pageSize,setPageSize]=useState(20);const[selectedKeys,setSelectedKeys]=useState([]);const[selectedBrands,setSelectedBrands]=useState([]);const[selectedSeries,setSelectedSeries]=useState([]);const[selectedModels,setSelectedModels]=useState([]);const[selectedStorage,setSelectedStorage]=useState([]);const[selectedColors,setSelectedColors]=useState([]);const[selectedSizes,setSelectedSizes]=useState([]);// 仅在页面加载时，如果有URL参数，则执行搜索\nuseEffect(()=>{if(query.trim()){searchProducts(query);}},[]);const searchProducts=async searchQuery=>{if(!searchQuery.trim())return;// 如果查询为空则不执行搜索\nsetLoading(true);setError(null);try{console.log('Calling API: goodsApi.compareGoods with query:',searchQuery);// デバッグ用ログ\n// 使用api.ts中定义的API服务\nconst response=await goodsApi.compareGoods(searchQuery);console.log('API Response:',response.data);// デバッグ用ログ\nlet responseData=[];if(response.data&&response.data.data){responseData=Array.isArray(response.data.data)?response.data.data:[response.data.data];}else{responseData=[];}console.log('Raw Response Data:',responseData);// デバッグ用ログ\n// レスポンスデータを処理\nlet processedData=[];if(responseData.length>0){// APIが返すグループデータを適切に処理\nprocessedData=responseData.map(group=>{// グループ内の商品リストを処理\nconst goodsList=Array.isArray(group.goodsList)?group.goodsList:[];// 最低価格とプラットフォームを特定\nlet lowestPrice=null;let lowestPlatform='不明';// 最低価格を計算\nif(goodsList.length>0){const lowestProduct=goodsList.reduce((lowest,current)=>current.goodsPrice<lowest.goodsPrice?current:lowest,goodsList[0]);lowestPrice=lowestProduct.goodsPrice;lowestPlatform=getPlatformName(lowestProduct.mallType);}return{goodsName:group.goodsName||'不明な商品',goodsList:goodsList.map(product=>({goodsId:product.goodsId,goodsName:product.goodsName,goodsPrice:product.goodsPrice,goodsLink:product.goodsLink,imgUrl:product.imgUrl,mallType:product.mallType})),lowestPrice:lowestPrice,lowestPlatform:lowestPlatform};});console.log('Processed grouped data:',processedData);// デバッグ用ログ\n}console.log('Final processed data:',processedData);// デバッグ用ログ\nsetCompareGroups(processedData);setLoading(false);}catch(err){setError('検索に失敗しました。後ほど再試行してください');setLoading(false);console.error(err);}};const handleSearch=e=>{e.preventDefault();if(query.trim()){searchProducts(query);}};const getPlatformName=mallType=>{switch(mallType){case 10:return'楽天';case 20:return'ヤフー';case 30:return'タオバオ';default:return'不明なプラットフォーム';}};const getPlatformColor=mallType=>{switch(mallType){case 10:return'#bf0000';// Rakuten Red\ncase 20:return'#ff0033';// Yahoo Red (adjusted)\ncase 30:return'#ff5000';// Taobao Orange\ndefault:return'#666';}};const getPlatformBadgeClass=mallType=>{switch(mallType){case 10:return'platform-badge rakuten';case 20:return'platform-badge yahoo';case 30:return'platform-badge taobao';default:return'platform-badge unknown';}};const allProducts=compareGroups.flatMap(group=>group.goodsList);const knownBrands=['Apple','Samsung','Sony','Xiaomi','Huawei','Lenovo','Dell','HP','ASUS','Acer','Nintendo','Microsoft','Canon','Nikon'];const parseFacets=name=>{const n=name||'';const brand=knownBrands.find(b=>new RegExp(b,'i').test(n))||'';const seriesMatch=n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);const series=seriesMatch?seriesMatch[1]:'';const modelMatch=n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);const model=modelMatch?modelMatch[1]:'';const storageMatch=n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);const storage=storageMatch?storageMatch[1].replace(/\\s+/g,''):'';const colorMatch=n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight)\\b/i);const color=colorMatch?colorMatch[1]:'';const sizeMatch=n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);const size=sizeMatch?sizeMatch[1]:'';return{brand,series,model,storage,color,size};};const facetIndex=allProducts.map(p=>parseFacets(p.goodsName));const brands=Array.from(new Set(facetIndex.map(f=>f.brand).filter(Boolean)));const series=Array.from(new Set(facetIndex.map(f=>f.series).filter(Boolean)));const models=Array.from(new Set(facetIndex.map(f=>f.model).filter(Boolean)));const storages=Array.from(new Set(facetIndex.map(f=>f.storage).filter(Boolean)));const colors=Array.from(new Set(facetIndex.map(f=>f.color).filter(Boolean)));const sizes=Array.from(new Set(facetIndex.map(f=>f.size).filter(Boolean)));const filteredProducts=allProducts.filter(p=>{const platformOk=selectedPlatforms.length===0||selectedPlatforms.includes(p.mallType);const minOk=minPrice===''||!isNaN(Number(minPrice))&&p.goodsPrice>=Number(minPrice);const maxOk=maxPrice===''||!isNaN(Number(maxPrice))&&p.goodsPrice<=Number(maxPrice);const f=parseFacets(p.goodsName);const brandOk=selectedBrands.length===0||f.brand&&selectedBrands.includes(f.brand);const seriesOk=selectedSeries.length===0||f.series&&selectedSeries.includes(f.series);const modelOk=selectedModels.length===0||f.model&&selectedModels.includes(f.model);const storageOk=selectedStorage.length===0||f.storage&&selectedStorage.includes(f.storage);const colorOk=selectedColors.length===0||f.color&&selectedColors.includes(f.color);const sizeOk=selectedSizes.length===0||f.size&&selectedSizes.includes(f.size);return platformOk&&minOk&&maxOk&&brandOk&&seriesOk&&modelOk&&storageOk&&colorOk&&sizeOk;});const sortedProducts=[...filteredProducts].sort((a,b)=>{if(sortOption==='price_asc')return a.goodsPrice-b.goodsPrice;if(sortOption==='price_desc')return b.goodsPrice-a.goodsPrice;if(sortOption==='platform')return a.mallType-b.mallType;if(sortOption==='name')return a.goodsName.localeCompare(b.goodsName);return 0;});const togglePlatform=mt=>{setSelectedPlatforms(prev=>prev.includes(mt)?prev.filter(x=>x!==mt):[...prev,mt]);};const totalPages=Math.max(1,Math.ceil(sortedProducts.length/pageSize));const currentPageProducts=sortedProducts.slice((currentPage-1)*pageSize,currentPage*pageSize);const goPrev=()=>setCurrentPage(p=>Math.max(1,p-1));const goNext=()=>setCurrentPage(p=>Math.min(totalPages,p+1));const setPage=p=>setCurrentPage(Math.min(Math.max(1,p),totalPages));const onChangePageSize=size=>{setPageSize(size);setCurrentPage(1);};const getSelectKey=p=>{if(p.goodsId)return\"id:\".concat(p.goodsId);const base=\"\".concat(p.mallType,\"-\").concat(p.goodsLink||'',\"-\").concat(p.goodsName);return\"k:\".concat(base);};const isSelected=key=>selectedKeys.includes(key);const toggleSelect=p=>{const key=getSelectKey(p);setSelectedKeys(prev=>prev.includes(key)?prev.filter(x=>x!==key):[...prev,key]);};const getSellerFromLink=url=>{if(!url)return'不明な店铺';try{const u=new URL(url.startsWith('http')?url:'https://'+url.replace(/^\\/\\//,''));return u.hostname.replace(/^www\\./,'');}catch(_unused){return'不明な店铺';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"compare-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u5546\\u54C1\\u4FA1\\u683C\\u6BD4\\u8F03\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:query,onChange:e=>setQuery(e.target.value)// 仅更新状态，不触发搜索\n,placeholder:\"\\u5546\\u54C1\\u540D\\u3092\\u5165\\u529B\\u3057\\u3066\\u4FA1\\u683C\\u6BD4\\u8F03...\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:\"\\u641C\\u7D22\"})]})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u691C\\u7D22\\u4E2D...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),!loading&&!error&&allProducts.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"compare-results\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u4FA1\\u683C\\u6BD4\\u8F03\\u7D50\\u679C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u6392\\u5E8F\"}),/*#__PURE__*/_jsxs(\"select\",{value:sortOption,onChange:e=>setSortOption(e.target.value),className:\"sort-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"price_asc\",children:\"\\u4EF7\\u683C\\u5347\\u5E8F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price_desc\",children:\"\\u4EF7\\u683C\\u964D\\u5E8F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"platform\",children:\"\\u5E73\\u53F0\"}),/*#__PURE__*/_jsx(\"option\",{value:\"name\",children:\"\\u540D\\u79F0\"})]})]}),brands.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u54C1\\u724C\"}),/*#__PURE__*/_jsx(\"div\",{className:\"platform-options\",children:brands.map(b=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedBrands.includes(b)?'active':'',onClick:()=>setSelectedBrands(prev=>prev.includes(b)?prev.filter(x=>x!==b):[...prev,b]),children:b},b))})]}),series.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u7CFB\\u5217\"}),/*#__PURE__*/_jsx(\"div\",{className:\"platform-options\",children:series.map(s=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedSeries.includes(s)?'active':'',onClick:()=>setSelectedSeries(prev=>prev.includes(s)?prev.filter(x=>x!==s):[...prev,s]),children:s},s))})]}),models.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u578B\\u53F7\"}),/*#__PURE__*/_jsx(\"div\",{className:\"platform-options\",children:models.map(m=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedModels.includes(m)?'active':'',onClick:()=>setSelectedModels(prev=>prev.includes(m)?prev.filter(x=>x!==m):[...prev,m]),children:m},m))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group platform-filters\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5E73\\u53F0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"platform-options\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedPlatforms.includes(10)?'active':'',onClick:()=>togglePlatform(10),children:\"\\u697D\\u5929\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedPlatforms.includes(20)?'active':'',onClick:()=>togglePlatform(20),children:\"\\u30E4\\u30D5\\u30FC\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedPlatforms.includes(30)?'active':'',onClick:()=>togglePlatform(30),children:\"\\u30BF\\u30AA\\u30D0\\u30AA\"})]})]}),(storages.length>0||colors.length>0||sizes.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"control-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u89C4\\u683C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"platform-options\",children:[storages.map(s=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedStorage.includes(s)?'active':'',onClick:()=>setSelectedStorage(prev=>prev.includes(s)?prev.filter(x=>x!==s):[...prev,s]),children:s},s)),colors.map(c=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedColors.includes(c)?'active':'',onClick:()=>setSelectedColors(prev=>prev.includes(c)?prev.filter(x=>x!==c):[...prev,c]),children:c},c)),sizes.map(siz=>/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:selectedSizes.includes(siz)?'active':'',onClick:()=>setSelectedSizes(prev=>prev.includes(siz)?prev.filter(x=>x!==siz):[...prev,siz]),children:siz},siz))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group price-filter\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u4EF7\\u683C\\u533A\\u95F4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",placeholder:\"\\u6700\\u5C0F\",value:minPrice,onChange:e=>setMinPrice(e.target.value.replace(/[^0-9]/g,''))}),/*#__PURE__*/_jsx(\"span\",{children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",placeholder:\"\\u6700\\u5927\",value:maxPrice,onChange:e=>setMaxPrice(e.target.value.replace(/[^0-9]/g,''))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group view-toggle\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u89C6\\u56FE\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"view-options\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:viewMode==='grid'?'active':'',onClick:()=>setViewMode('grid'),children:\"\\u7F51\\u683C\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:viewMode==='list'?'active':'',onClick:()=>setViewMode('list'),children:\"\\u5217\\u8868\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"control-group pagination-controls\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u5206\\u9875\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination-inner\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:goPrev,disabled:currentPage===1,children:\"\\u4E0A\\u4E00\\u9875\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-info\",children:[currentPage,\" / \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:goNext,disabled:currentPage===totalPages,children:\"\\u4E0B\\u4E00\\u9875\"}),/*#__PURE__*/_jsxs(\"select\",{value:pageSize,onChange:e=>onChangePageSize(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:12,children:\"12\"}),/*#__PURE__*/_jsx(\"option\",{value:20,children:\"20\"}),/*#__PURE__*/_jsx(\"option\",{value:40,children:\"40\"})]})]})]})]}),selectedKeys.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"compare-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[\"\\u5DF2\\u9009\\u5BF9\\u6BD4\\uFF08\",selectedKeys.length,\"\\uFF09\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-body\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u540D\\u79F0\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u4EF7\\u683C\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u5E73\\u53F0\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u5E97\\u94FA\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:sortedProducts.filter(p=>selectedKeys.includes(getSelectKey(p))).map((p,i)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:p.goodsName}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\xA5\",p.goodsPrice.toLocaleString()]}),/*#__PURE__*/_jsx(\"td\",{children:getPlatformName(p.mallType)}),/*#__PURE__*/_jsx(\"td\",{children:getSellerFromLink(p.goodsLink)})]},i))})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"compare-group\",children:/*#__PURE__*/_jsx(\"div\",{className:\"product-grid \".concat(viewMode==='list'?'list':''),children:currentPageProducts.map((product,productIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-card \".concat(viewMode==='list'?'list':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"select-row\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"select-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected(getSelectKey(product)),onChange:()=>toggleSelect(product)}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5BF9\\u6BD4\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"seller-name\",children:getSellerFromLink(product.goodsLink)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-image-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.imgUrl||'https://via.placeholder.com/200x200?text=No+Image',alt:product.goodsName,onError:e=>{e.target.src='https://via.placeholder.com/200x200?text=Image+Error';}}),/*#__PURE__*/_jsx(\"div\",{className:getPlatformBadgeClass(product.mallType),children:getPlatformName(product.mallType)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-card-content\",children:[/*#__PURE__*/_jsx(\"h4\",{title:product.goodsName,children:product.goodsName}),function(){const f=parseFacets(product.goodsName);const parts=[f.brand,f.series,f.model,f.storage,f.color,f.size].filter(Boolean);return parts.length?/*#__PURE__*/_jsx(\"div\",{className:\"spec-line\",children:parts.join(' / ')}):null;}(),/*#__PURE__*/_jsxs(\"div\",{className:\"price-section\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"currency\",children:\"\\xA5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"amount\",children:product.goodsPrice.toLocaleString()})]}),/*#__PURE__*/_jsx(\"a\",{href:product.goodsLink,target:\"_blank\",rel:\"noopener noreferrer\",className:\"shop-button \".concat(product.mallType===10?'btn-rakuten':product.mallType===20?'btn-yahoo':''),children:\"\\u7ACB\\u5373\\u8D2D\\u4E70\"})]})]},productIndex))})})]}),!loading&&!error&&compareGroups.length===0&&query&&/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"\\u95A2\\u9023\\u5546\\u54C1\\u304C\\u898B\\u3064\\u304B\\u308A\\u307E\\u305B\\u3093\"})]});};export default ComparePage;","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","goodsApi","jsx","_jsx","jsxs","_jsxs","ComparePage","searchParams","query","setQuery","get","compareGroups","setCompareGroups","loading","setLoading","error","setError","sortOption","setSortOption","selectedPlatforms","setSelectedPlatforms","minPrice","setMinPrice","maxPrice","setMaxPrice","viewMode","setViewMode","currentPage","setCurrentPage","pageSize","setPageSize","selectedKeys","setSelectedKeys","selectedBrands","setSelectedBrands","selectedSeries","setSelectedSeries","selectedModels","setSelectedModels","selectedStorage","setSelectedStorage","selectedColors","setSelectedColors","selectedSizes","setSelectedSizes","trim","searchProducts","searchQuery","console","log","response","compareGoods","data","responseData","Array","isArray","processedData","length","map","group","goodsList","lowestPrice","lowestPlatform","lowestProduct","reduce","lowest","current","goodsPrice","getPlatformName","mallType","goodsName","product","goodsId","goodsLink","imgUrl","err","handleSearch","e","preventDefault","getPlatformColor","getPlatformBadgeClass","allProducts","flatMap","knownBrands","parseFacets","name","n","brand","find","b","RegExp","test","seriesMatch","match","series","modelMatch","model","storageMatch","storage","replace","colorMatch","color","sizeMatch","size","facetIndex","p","brands","from","Set","f","filter","Boolean","models","storages","colors","sizes","filteredProducts","platformOk","includes","minOk","isNaN","Number","maxOk","brandOk","seriesOk","modelOk","storageOk","colorOk","sizeOk","sortedProducts","sort","a","localeCompare","togglePlatform","mt","prev","x","totalPages","Math","max","ceil","currentPageProducts","slice","goPrev","goNext","min","setPage","onChangePageSize","getSelectKey","concat","base","isSelected","key","toggleSelect","getSellerFromLink","url","u","URL","startsWith","hostname","_unused","className","children","onSubmit","type","value","onChange","target","placeholder","onClick","s","m","c","siz","disabled","i","toLocaleString","productIndex","checked","src","alt","onError","title","parts","join","href","rel"],"sources":["C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/src/pages/ComparePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport './ComparePage.css';\nimport { goodsApi } from '../services/api';\n\ninterface Product {\n  goodsId?: number;\n  goodsName: string;\n  goodsPrice: number;\n  goodsLink: string;\n  imgUrl?: string;\n  mallType: number;\n}\n\ninterface CompareGroup {\n  goodsName: string;\n  goodsList: Product[];\n  lowestPrice: number | null;\n  lowestPlatform?: string;\n}\n\nconst ComparePage: React.FC = () => {\n  const [searchParams] = useSearchParams();\n  const [query, setQuery] = useState(searchParams.get('query') || '');\n  const [compareGroups, setCompareGroups] = useState<CompareGroup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [sortOption, setSortOption] = useState('price_asc');\n  const [selectedPlatforms, setSelectedPlatforms] = useState<number[]>([]);\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(20);\n  const [selectedKeys, setSelectedKeys] = useState<string[]>([]);\n  const [selectedBrands, setSelectedBrands] = useState<string[]>([]);\n  const [selectedSeries, setSelectedSeries] = useState<string[]>([]);\n  const [selectedModels, setSelectedModels] = useState<string[]>([]);\n  const [selectedStorage, setSelectedStorage] = useState<string[]>([]);\n  const [selectedColors, setSelectedColors] = useState<string[]>([]);\n  const [selectedSizes, setSelectedSizes] = useState<string[]>([]);\n\n  // 仅在页面加载时，如果有URL参数，则执行搜索\n  useEffect(() => {\n    if (query.trim()) {\n      searchProducts(query);\n    }\n  }, []);\n\n  const searchProducts = async (searchQuery: string) => {\n    if (!searchQuery.trim()) return; // 如果查询为空则不执行搜索\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      console.log('Calling API: goodsApi.compareGoods with query:', searchQuery); // デバッグ用ログ\n      \n      // 使用api.ts中定义的API服务\n      const response = await goodsApi.compareGoods(searchQuery);\n      \n      console.log('API Response:', response.data); // デバッグ用ログ\n      \n      let responseData = [];\n      if (response.data && response.data.data) {\n        responseData = Array.isArray(response.data.data) ? response.data.data : [response.data.data];\n      } else {\n        responseData = [];\n      }\n      \n      console.log('Raw Response Data:', responseData); // デバッグ用ログ\n      \n      // レスポンスデータを処理\n      let processedData = [];\n      \n      if (responseData.length > 0) {\n        // APIが返すグループデータを適切に処理\n        processedData = responseData.map((group: any) => {\n          // グループ内の商品リストを処理\n          const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n          \n          // 最低価格とプラットフォームを特定\n          let lowestPrice = null;\n          let lowestPlatform = '不明';\n          \n          // 最低価格を計算\n          if (goodsList.length > 0) {\n            const lowestProduct = goodsList.reduce((lowest: any, current: any) => \n              current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n            \n            lowestPrice = lowestProduct.goodsPrice;\n            lowestPlatform = getPlatformName(lowestProduct.mallType);\n          }\n          \n          return {\n            goodsName: group.goodsName || '不明な商品',\n            goodsList: goodsList.map((product: any) => ({\n              goodsId: product.goodsId,\n              goodsName: product.goodsName,\n              goodsPrice: product.goodsPrice,\n              goodsLink: product.goodsLink,\n              imgUrl: product.imgUrl,\n              mallType: product.mallType\n            })),\n            lowestPrice: lowestPrice,\n            lowestPlatform: lowestPlatform\n          };\n        });\n        \n        console.log('Processed grouped data:', processedData); // デバッグ用ログ\n      }\n      \n      console.log('Final processed data:', processedData); // デバッグ用ログ\n      \n      setCompareGroups(processedData);\n      setLoading(false);\n    } catch (err) {\n      setError('検索に失敗しました。後ほど再試行してください');\n      setLoading(false);\n      console.error(err);\n    }\n  };\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      searchProducts(query);\n    }\n  };\n\n  const getPlatformName = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '楽天';\n      case 20: return 'ヤフー';\n      case 30: return 'タオバオ';\n      default: return '不明なプラットフォーム';\n    }\n  };\n\n  const getPlatformColor = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '#bf0000'; // Rakuten Red\n      case 20: return '#ff0033'; // Yahoo Red (adjusted)\n      case 30: return '#ff5000'; // Taobao Orange\n      default: return '#666';\n    }\n  };\n\n  const getPlatformBadgeClass = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return 'platform-badge rakuten';\n      case 20: return 'platform-badge yahoo';\n      case 30: return 'platform-badge taobao';\n      default: return 'platform-badge unknown';\n    }\n  };\n\n  const allProducts: Product[] = compareGroups.flatMap(group => group.goodsList);\n  const knownBrands = ['Apple','Samsung','Sony','Xiaomi','Huawei','Lenovo','Dell','HP','ASUS','Acer','Nintendo','Microsoft','Canon','Nikon'];\n  const parseFacets = (name: string) => {\n    const n = name || '';\n    const brand = knownBrands.find(b => new RegExp(b, 'i').test(n)) || '';\n    const seriesMatch = n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);\n    const series = seriesMatch ? seriesMatch[1] : '';\n    const modelMatch = n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);\n    const model = modelMatch ? modelMatch[1] : '';\n    const storageMatch = n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);\n    const storage = storageMatch ? storageMatch[1].replace(/\\s+/g,'') : '';\n    const colorMatch = n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight)\\b/i);\n    const color = colorMatch ? colorMatch[1] : '';\n    const sizeMatch = n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);\n    const size = sizeMatch ? sizeMatch[1] : '';\n    return { brand, series, model, storage, color, size };\n  };\n  const facetIndex = allProducts.map(p => parseFacets(p.goodsName));\n  const brands = Array.from(new Set(facetIndex.map(f => f.brand).filter(Boolean)));\n  const series = Array.from(new Set(facetIndex.map(f => f.series).filter(Boolean)));\n  const models = Array.from(new Set(facetIndex.map(f => f.model).filter(Boolean)));\n  const storages = Array.from(new Set(facetIndex.map(f => f.storage).filter(Boolean)));\n  const colors = Array.from(new Set(facetIndex.map(f => f.color).filter(Boolean)));\n  const sizes = Array.from(new Set(facetIndex.map(f => f.size).filter(Boolean)));\n  const filteredProducts: Product[] = allProducts.filter(p => {\n    const platformOk = selectedPlatforms.length === 0 || selectedPlatforms.includes(p.mallType);\n    const minOk = minPrice === '' || (!isNaN(Number(minPrice)) && p.goodsPrice >= Number(minPrice));\n    const maxOk = maxPrice === '' || (!isNaN(Number(maxPrice)) && p.goodsPrice <= Number(maxPrice));\n    const f = parseFacets(p.goodsName);\n    const brandOk = selectedBrands.length === 0 || (f.brand && selectedBrands.includes(f.brand));\n    const seriesOk = selectedSeries.length === 0 || (f.series && selectedSeries.includes(f.series));\n    const modelOk = selectedModels.length === 0 || (f.model && selectedModels.includes(f.model));\n    const storageOk = selectedStorage.length === 0 || (f.storage && selectedStorage.includes(f.storage));\n    const colorOk = selectedColors.length === 0 || (f.color && selectedColors.includes(f.color));\n    const sizeOk = selectedSizes.length === 0 || (f.size && selectedSizes.includes(f.size));\n    return platformOk && minOk && maxOk && brandOk && seriesOk && modelOk && storageOk && colorOk && sizeOk;\n  });\n  const sortedProducts: Product[] = [...filteredProducts].sort((a, b) => {\n    if (sortOption === 'price_asc') return a.goodsPrice - b.goodsPrice;\n    if (sortOption === 'price_desc') return b.goodsPrice - a.goodsPrice;\n    if (sortOption === 'platform') return a.mallType - b.mallType;\n    if (sortOption === 'name') return a.goodsName.localeCompare(b.goodsName);\n    return 0;\n  });\n  const togglePlatform = (mt: number) => {\n    setSelectedPlatforms(prev => prev.includes(mt) ? prev.filter(x => x !== mt) : [...prev, mt]);\n  };\n\n  const totalPages = Math.max(1, Math.ceil(sortedProducts.length / pageSize));\n  const currentPageProducts = sortedProducts.slice((currentPage - 1) * pageSize, currentPage * pageSize);\n  const goPrev = () => setCurrentPage(p => Math.max(1, p - 1));\n  const goNext = () => setCurrentPage(p => Math.min(totalPages, p + 1));\n  const setPage = (p: number) => setCurrentPage(Math.min(Math.max(1, p), totalPages));\n  const onChangePageSize = (size: number) => { setPageSize(size); setCurrentPage(1); };\n\n  const getSelectKey = (p: Product) => {\n    if (p.goodsId) return `id:${p.goodsId}`;\n    const base = `${p.mallType}-${p.goodsLink || ''}-${p.goodsName}`;\n    return `k:${base}`;\n  };\n  const isSelected = (key: string) => selectedKeys.includes(key);\n  const toggleSelect = (p: Product) => {\n    const key = getSelectKey(p);\n    setSelectedKeys(prev => prev.includes(key) ? prev.filter(x => x !== key) : [...prev, key]);\n  };\n\n  const getSellerFromLink = (url?: string) => {\n    if (!url) return '不明な店铺';\n    try {\n      const u = new URL(url.startsWith('http') ? url : ('https://' + url.replace(/^\\/\\//, '')));\n      return u.hostname.replace(/^www\\./, '');\n    } catch {\n      return '不明な店铺';\n    }\n  };\n\n  return (\n    <div className=\"compare-page\">\n      <div className=\"search-section\">\n        <h1>商品価格比較</h1>\n        <form onSubmit={handleSearch} className=\"search-form\">\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)} // 仅更新状态，不触发搜索\n            placeholder=\"商品名を入力して価格比較...\"\n            className=\"search-input\"\n          />\n          <button type=\"submit\" className=\"search-button\">搜索</button>\n        </form>\n      </div>\n\n      {loading && <div className=\"loading\">検索中...</div>}\n      {error && <div className=\"error\">{error}</div>}\n\n      {!loading && !error && allProducts.length > 0 && (\n        <div className=\"compare-results\">\n          <h2>価格比較結果</h2>\n          <div className=\"controls\">\n            <div className=\"control-group\">\n              <label>排序</label>\n              <select value={sortOption} onChange={(e) => setSortOption(e.target.value)} className=\"sort-select\">\n                <option value=\"price_asc\">价格升序</option>\n                <option value=\"price_desc\">价格降序</option>\n                <option value=\"platform\">平台</option>\n                <option value=\"name\">名称</option>\n              </select>\n            </div>\n            {brands.length > 0 && (\n              <div className=\"control-group\">\n                <label>品牌</label>\n                <div className=\"platform-options\">\n                  {brands.map(b => (\n                    <button type=\"button\" key={b} className={selectedBrands.includes(b) ? 'active' : ''} onClick={() => setSelectedBrands(prev => prev.includes(b) ? prev.filter(x=>x!==b) : [...prev,b])}>{b}</button>\n                  ))}\n                </div>\n              </div>\n            )}\n            {series.length > 0 && (\n              <div className=\"control-group\">\n                <label>系列</label>\n                <div className=\"platform-options\">\n                  {series.map(s => (\n                    <button type=\"button\" key={s} className={selectedSeries.includes(s) ? 'active' : ''} onClick={() => setSelectedSeries(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])}>{s}</button>\n                  ))}\n                </div>\n              </div>\n            )}\n            {models.length > 0 && (\n              <div className=\"control-group\">\n                <label>型号</label>\n                <div className=\"platform-options\">\n                  {models.map(m => (\n                    <button type=\"button\" key={m} className={selectedModels.includes(m) ? 'active' : ''} onClick={() => setSelectedModels(prev => prev.includes(m) ? prev.filter(x=>x!==m) : [...prev,m])}>{m}</button>\n                  ))}\n                </div>\n              </div>\n            )}\n            <div className=\"control-group platform-filters\">\n              <label>平台</label>\n              <div className=\"platform-options\">\n                <button type=\"button\" className={selectedPlatforms.includes(10) ? 'active' : ''} onClick={() => togglePlatform(10)}>楽天</button>\n                <button type=\"button\" className={selectedPlatforms.includes(20) ? 'active' : ''} onClick={() => togglePlatform(20)}>ヤフー</button>\n                <button type=\"button\" className={selectedPlatforms.includes(30) ? 'active' : ''} onClick={() => togglePlatform(30)}>タオバオ</button>\n              </div>\n            </div>\n            {(storages.length > 0 || colors.length > 0 || sizes.length > 0) && (\n              <div className=\"control-group\">\n                <label>规格</label>\n                <div className=\"platform-options\">\n                  {storages.map(s => (\n                    <button type=\"button\" key={s} className={selectedStorage.includes(s) ? 'active' : ''} onClick={() => setSelectedStorage(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])}>{s}</button>\n                  ))}\n                  {colors.map(c => (\n                    <button type=\"button\" key={c} className={selectedColors.includes(c) ? 'active' : ''} onClick={() => setSelectedColors(prev => prev.includes(c) ? prev.filter(x=>x!==c) : [...prev,c])}>{c}</button>\n                  ))}\n                  {sizes.map(siz => (\n                    <button type=\"button\" key={siz} className={selectedSizes.includes(siz) ? 'active' : ''} onClick={() => setSelectedSizes(prev => prev.includes(siz) ? prev.filter(x=>x!==siz) : [...prev,siz])}>{siz}</button>\n                  ))}\n                </div>\n              </div>\n            )}\n            <div className=\"control-group price-filter\">\n              <label>价格区间</label>\n              <div className=\"price-inputs\">\n                <input type=\"number\" min=\"0\" placeholder=\"最小\" value={minPrice} onChange={(e) => setMinPrice(e.target.value.replace(/[^0-9]/g, ''))} />\n                <span>-</span>\n                <input type=\"number\" min=\"0\" placeholder=\"最大\" value={maxPrice} onChange={(e) => setMaxPrice(e.target.value.replace(/[^0-9]/g, ''))} />\n              </div>\n            </div>\n            <div className=\"control-group view-toggle\">\n              <label>视图</label>\n              <div className=\"view-options\">\n                <button type=\"button\" className={viewMode === 'grid' ? 'active' : ''} onClick={() => setViewMode('grid')}>网格</button>\n                <button type=\"button\" className={viewMode === 'list' ? 'active' : ''} onClick={() => setViewMode('list')}>列表</button>\n              </div>\n            </div>\n            <div className=\"control-group pagination-controls\">\n              <label>分页</label>\n              <div className=\"pagination-inner\">\n                <button type=\"button\" onClick={goPrev} disabled={currentPage === 1}>上一页</button>\n                <span className=\"page-info\">{currentPage} / {totalPages}</span>\n                <button type=\"button\" onClick={goNext} disabled={currentPage === totalPages}>下一页</button>\n                <select value={pageSize} onChange={(e) => onChangePageSize(Number(e.target.value))}>\n                  <option value={12}>12</option>\n                  <option value={20}>20</option>\n                  <option value={40}>40</option>\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {selectedKeys.length > 0 && (\n            <div className=\"compare-table\">\n              <div className=\"table-header\">已选对比（{selectedKeys.length}）</div>\n              <div className=\"table-body\">\n                <table>\n                  <thead>\n                    <tr>\n                      <th>名称</th>\n                      <th>价格</th>\n                      <th>平台</th>\n                      <th>店铺</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {sortedProducts.filter(p => selectedKeys.includes(getSelectKey(p))).map((p, i) => (\n                      <tr key={i}>\n                        <td>{p.goodsName}</td>\n                        <td>¥{p.goodsPrice.toLocaleString()}</td>\n                        <td>{getPlatformName(p.mallType)}</td>\n                        <td>{getSellerFromLink(p.goodsLink)}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n          <div className=\"compare-group\">\n            <div className={`product-grid ${viewMode === 'list' ? 'list' : ''}`}>\n              {currentPageProducts.map((product, productIndex) => (\n                <div \n                    key={productIndex} \n                    className={`product-card ${viewMode === 'list' ? 'list' : ''}`}\n                >\n                  <div className=\"select-row\">\n                    <label className=\"select-checkbox\">\n                      <input type=\"checkbox\" checked={isSelected(getSelectKey(product))} onChange={() => toggleSelect(product)} />\n                      <span>对比</span>\n                    </label>\n                    <span className=\"seller-name\">{getSellerFromLink(product.goodsLink)}</span>\n                  </div>\n                  \n                  <div className=\"product-image-container\">\n                    <img \n                      src={product.imgUrl || 'https://via.placeholder.com/200x200?text=No+Image'} \n                        alt={product.goodsName} \n                        onError={(e) => {\n                          (e.target as HTMLImageElement).src = 'https://via.placeholder.com/200x200?text=Image+Error';\n                        }}\n                      />\n                      <div className={getPlatformBadgeClass(product.mallType)}>\n                        {getPlatformName(product.mallType)}\n                      </div>\n                    </div>\n                    \n                    <div className=\"product-card-content\">\n                      <h4 title={product.goodsName}>{product.goodsName}</h4>\n                      {(function(){\n                        const f = parseFacets(product.goodsName);\n                        const parts = [f.brand, f.series, f.model, f.storage, f.color, f.size].filter(Boolean);\n                        return parts.length ? (<div className=\"spec-line\">{parts.join(' / ')}</div>) : null;\n                      })()}\n                      \n                      <div className=\"price-section\">\n                        <span className=\"currency\">¥</span>\n                        <span className=\"amount\">{product.goodsPrice.toLocaleString()}</span>\n                      </div>\n                      \n                      <a \n                        href={product.goodsLink} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\" \n                        className={`shop-button ${product.mallType === 10 ? 'btn-rakuten' : product.mallType === 20 ? 'btn-yahoo' : ''}`}\n                      >\n                        立即购买\n                      </a>\n                    </div>\n                  </div>\n                ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {!loading && !error && compareGroups.length === 0 && query && (\n        <div className=\"no-results\">関連商品が見つかりません</div>\n      )}\n    </div>\n  );\n};\n\nexport default ComparePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}