{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate,useLocation}from'react-router-dom';import'./Header.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Header=()=>{const navigate=useNavigate();const location=useLocation();const[isLoggedIn,setIsLoggedIn]=useState(false);const[username,setUsername]=useState('');// 检查当前是否在比价页面\nconst isComparePage=location.pathname==='/compare';const isHomePage=location.pathname==='/';// 检查用户登录状态\nuseEffect(()=>{const token=localStorage.getItem('token');if(token){setIsLoggedIn(true);// 通常这里会调用API获取用户信息\n// 模拟获取用户名\ntry{// 解析JWT token获取用户名（如果有的话）\nconst tokenData=JSON.parse(atob(token.split('.')[1]));setUsername(tokenData.username||'ユーザー');}catch(e){setUsername('ユーザー');}}else{setIsLoggedIn(false);setUsername('');}},[]);const handleSearch=e=>{var _formData$get;e.preventDefault();const formData=new FormData(e.target);const query=(_formData$get=formData.get('query'))===null||_formData$get===void 0?void 0:_formData$get.toString();if(query){// 可以跳转到比价页面并传递搜索参数\nnavigate(\"/compare?query=\".concat(encodeURIComponent(query)));}};return/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-top\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"\\u60E0\\u8CFC\\u4FA1\\u683C\\u6BD4\\u8F03\"})}),/*#__PURE__*/_jsxs(\"nav\",{className:\"nav\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"\\u30DB\\u30FC\\u30E0\"}),/*#__PURE__*/_jsx(Link,{to:\"/compare\",children:\"\\u4FA1\\u683C\\u6BD4\\u8F03\"}),/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:\"\\u30DE\\u30A4\\u30DA\\u30FC\\u30B8\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"user-actions\",children:isLoggedIn?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:username}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{localStorage.removeItem('token');setIsLoggedIn(false);navigate('/');},className:\"logout-button\",children:\"\\u30ED\\u30B0\\u30A2\\u30A6\\u30C8\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"\\u30ED\\u30B0\\u30A4\\u30F3\"}),/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"\\u767B\\u9332\"})]})})]}),!isComparePage&&!isHomePage&&/*#__PURE__*/_jsx(\"div\",{className:\"header-search\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"query\",placeholder:\"\\u5546\\u54C1\\u3092\\u691C\\u7D22...\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:\"\\u691C\\u7D22\"})]})})]});};export default Header;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Header","navigate","location","isLoggedIn","setIsLoggedIn","username","setUsername","isComparePage","pathname","isHomePage","token","localStorage","getItem","tokenData","JSON","parse","atob","split","e","handleSearch","_formData$get","preventDefault","formData","FormData","target","query","get","toString","concat","encodeURIComponent","className","children","to","onClick","removeItem","onSubmit","type","name","placeholder"],"sources":["C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/src/components/Header.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport './Header.css';\n\nconst Header: React.FC = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [username, setUsername] = useState('');\n\n  // 检查当前是否在比价页面\n  const isComparePage = location.pathname === '/compare';\n  const isHomePage = location.pathname === '/';\n\n  // 检查用户登录状态\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      setIsLoggedIn(true);\n      // 通常这里会调用API获取用户信息\n      // 模拟获取用户名\n      try {\n        // 解析JWT token获取用户名（如果有的话）\n        const tokenData = JSON.parse(atob(token.split('.')[1]));\n        setUsername(tokenData.username || 'ユーザー');\n      } catch (e) {\n        setUsername('ユーザー');\n      }\n    } else {\n      setIsLoggedIn(false);\n      setUsername('');\n    }\n  }, []);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    const formData = new FormData(e.target as HTMLFormElement);\n    const query = formData.get('query')?.toString();\n    if (query) {\n      // 可以跳转到比价页面并传递搜索参数\n      navigate(`/compare?query=${encodeURIComponent(query)}`);\n    }\n  };\n\n  return (\n    <header className=\"header\">\n      <div className=\"header-top\">\n        <div className=\"logo\">\n          <Link to=\"/\">惠購価格比較</Link>\n        </div>\n        <nav className=\"nav\">\n          <Link to=\"/\">ホーム</Link>\n          <Link to=\"/compare\">価格比較</Link>\n          <Link to=\"/profile\">マイページ</Link>\n        </nav>\n        <div className=\"user-actions\">\n          {isLoggedIn ? (\n            <>\n              <Link to=\"/profile\">{username}</Link>\n              <button \n                onClick={() => {\n                  localStorage.removeItem('token');\n                  setIsLoggedIn(false);\n                  navigate('/');\n                }}\n                className=\"logout-button\"\n              >\n                ログアウト\n              </button>\n            </>\n          ) : (\n            <>\n              <Link to=\"/login\">ログイン</Link>\n              <Link to=\"/register\">登録</Link>\n            </>\n          )}\n        </div>\n      </div>\n      {!isComparePage && !isHomePage && (\n        <div className=\"header-search\">\n          <form onSubmit={handleSearch}>\n            <input \n              type=\"text\" \n              name=\"query\" \n              placeholder=\"商品を検索...\" \n              className=\"search-input\"\n            />\n            <button type=\"submit\" className=\"search-button\">検索</button>\n          </form>\n        </div>\n      )}\n    </header>\n  );\n};\n\nexport default Header;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}