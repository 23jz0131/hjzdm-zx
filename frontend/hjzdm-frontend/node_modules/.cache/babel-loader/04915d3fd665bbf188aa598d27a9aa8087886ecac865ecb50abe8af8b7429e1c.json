{"ast":null,"code":"import _objectSpread from\"C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useSearchParams}from'react-router-dom';import'./ComparePage.css';import{goodsApi,categoryApi,userApi,goodsOperateApi}from'../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ComparePage=()=>{const[searchParams]=useSearchParams();const[query,setQuery]=useState(searchParams.get('query')||'');const[compareGroups,setCompareGroups]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[sortOption,setSortOption]=useState('price_asc');const[selectedPlatforms,setSelectedPlatforms]=useState([]);const[minPrice,setMinPrice]=useState('');const[maxPrice,setMaxPrice]=useState('');const[currentPage,setCurrentPage]=useState(1);const[pageSize,setPageSize]=useState(50);const[selectedKeys,setSelectedKeys]=useState([]);const[selectedBrands,setSelectedBrands]=useState([]);const[selectedSeries,setSelectedSeries]=useState([]);const[selectedModels,setSelectedModels]=useState([]);const[selectedStorage,setSelectedStorage]=useState([]);const[selectedColors,setSelectedColors]=useState([]);const[selectedSizes,setSelectedSizes]=useState([]);const[selectedCategories,setSelectedCategories]=useState([]);const[trendOpen,setTrendOpen]=useState(false);const[trendLabels,setTrendLabels]=useState([]);const[trendSeries,setTrendSeries]=useState([]);const[trendTitle,setTrendTitle]=useState('');const[collectedIds,setCollectedIds]=useState(new Set());// Search Source\nconst[searchSource,setSearchSource]=useState('compare');const[executedQuery,setExecutedQuery]=useState('');const[totalItems,setTotalItems]=useState(0);// Dynamic Filters State\nconst[categories,setCategories]=useState([]);const[dynamicFilters,setDynamicFilters]=useState([]);const[selectedDynamicFilters,setSelectedDynamicFilters]=useState({});const[currentCatId,setCurrentCatId]=useState(null);// Fetch categories on mount\nuseEffect(()=>{categoryApi.getList().then(res=>{if(res.data.code===200){setCategories(res.data.data);}}).catch(err=>console.error(\"Failed to fetch categories\",err));},[]);// 仅在页面加载时，如果有URL参数，则执行搜索\nuseEffect(()=>{if(query.trim()){searchProducts(query);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Fetch dynamic attributes when category changes\nuseEffect(()=>{if(currentCatId){categoryApi.getAttributes(currentCatId).then(res=>{if(res.data.code===200){setDynamicFilters(res.data.data);}}).catch(err=>console.error(\"Failed to fetch attributes\",err));}else{setDynamicFilters([]);}},[currentCatId]);// Auto-search when filters change (Local Mode only)\nuseEffect(()=>{if(searchSource==='local'){searchProducts(executedQuery||query);}},[selectedDynamicFilters,currentCatId,currentPage,pageSize,searchSource,selectedPlatforms]);useEffect(()=>{(async()=>{try{const res=await goodsApi.getMyCollect(1,500);if(res.data&&res.data.code===200&&Array.isArray(res.data.data)){const ids=res.data.data.map(g=>g.goodsId).filter(id=>typeof id==='number');setCollectedIds(new Set(ids));}}catch(e){}})();},[]);const toggleCollect=async goodsId=>{try{if(collectedIds.has(goodsId)){const res=await goodsOperateApi.cancelCollect(goodsId);if(res.data&&res.data.code===200){setCollectedIds(prev=>{const next=new Set(prev);next.delete(goodsId);return next;});}}else{const res=await goodsOperateApi.collect(goodsId);if(res.data&&res.data.code===200){setCollectedIds(prev=>{const next=new Set(prev);next.add(goodsId);return next;});}else{alert('请先登录');}}}catch(e){alert('操作失败');}};const ensureGoodsIdAndCollect=async product=>{try{const token=localStorage.getItem('token');if(!token){alert('请先登录');return;}if(product.goodsId){await toggleCollect(product.goodsId);return;}const payload={goodsName:product.goodsName,goodsPrice:product.goodsPrice,goodsLink:product.goodsLink,imgUrl:product.imgUrl,mallType:product.mallType,status:1};const addRes=await goodsApi.addAndReturn(payload);if(addRes.data&&addRes.data.code===200&&addRes.data.data&&addRes.data.data.goodsId){const newId=addRes.data.data.goodsId;await toggleCollect(newId);}else{alert('新增商品失败');}}catch(e){alert('操作失败');}};const searchProducts=async searchQuery=>{if(!searchQuery.trim()&&searchSource==='compare')return;setExecutedQuery(searchQuery);setLoading(true);setError(null);try{if(searchSource==='local'){const minP=minPrice?Number(minPrice):undefined;const maxP=maxPrice?Number(maxPrice):undefined;console.log('Calling API: goodsApi.getGoodsPage',{searchQuery,selectedDynamicFilters,currentCatId,minP,maxP,selectedPlatforms});const response=await goodsApi.getGoodsPage(searchQuery,selectedDynamicFilters,currentCatId||undefined,currentPage,pageSize,minP,maxP,selectedPlatforms);console.log('Local API Response:',response.data);if(response.data&&response.data.code===200){const records=response.data.data.records||[];setTotalItems(response.data.data.total||0);const processedData=records.map(g=>({goodsName:g.goodsName,goodsList:[{goodsId:g.goodsId,goodsName:g.goodsName,goodsPrice:g.goodsPrice,goodsLink:g.goodsLink||'#',imgUrl:g.imgUrl,mallType:g.mallType||0}],lowestPrice:g.goodsPrice,lowestPlatform:getPlatformName(g.mallType||0)}));if(processedData.length===0){try{const cmpRes=await goodsApi.compareGoods(searchQuery);let responseData=[];if(cmpRes.data&&cmpRes.data.data){responseData=Array.isArray(cmpRes.data.data)?cmpRes.data.data:[cmpRes.data.data];}let cmpProcessed=[];if(responseData.length>0){cmpProcessed=responseData.map(group=>{const goodsList=Array.isArray(group.goodsList)?group.goodsList:[];let lowestPrice=null;let lowestPlatform='不明';if(goodsList.length>0){const lowestProduct=goodsList.reduce((lowest,current)=>current.goodsPrice<lowest.goodsPrice?current:lowest,goodsList[0]);lowestPrice=lowestProduct.goodsPrice;lowestPlatform=getPlatformName(lowestProduct.mallType);}return{goodsName:group.goodsName||'不明な商品',goodsList:goodsList.map(product=>({goodsId:product.goodsId,goodsName:product.goodsName,goodsPrice:product.goodsPrice,goodsLink:product.goodsLink,imgUrl:product.imgUrl,mallType:product.mallType})),lowestPrice,lowestPlatform};});}setCompareGroups(cmpProcessed);setLoading(false);return;}catch(e){console.error('Fallback compare search failed',e);}}setCompareGroups(processedData);}else{setCompareGroups([]);setTotalItems(0);try{const cmpRes=await goodsApi.compareGoods(searchQuery);let responseData=[];if(cmpRes.data&&cmpRes.data.data){responseData=Array.isArray(cmpRes.data.data)?cmpRes.data.data:[cmpRes.data.data];}let processedData=[];if(responseData.length>0){processedData=responseData.map(group=>{const goodsList=Array.isArray(group.goodsList)?group.goodsList:[];let lowestPrice=null;let lowestPlatform='不明';if(goodsList.length>0){const lowestProduct=goodsList.reduce((lowest,current)=>current.goodsPrice<lowest.goodsPrice?current:lowest,goodsList[0]);lowestPrice=lowestProduct.goodsPrice;lowestPlatform=getPlatformName(lowestProduct.mallType);}return{goodsName:group.goodsName||'不明な商品',goodsList:goodsList.map(product=>({goodsId:product.goodsId,goodsName:product.goodsName,goodsPrice:product.goodsPrice,goodsLink:product.goodsLink,imgUrl:product.imgUrl,mallType:product.mallType})),lowestPrice,lowestPlatform};});}setCompareGroups(processedData);}catch(e){console.error('Fallback compare search failed',e);}}setLoading(false);return;}console.log('Calling API: goodsApi.compareGoods with query:',searchQuery);// デバッグ用ログ\n// 使用api.ts中定义的API服务\nconst response=await goodsApi.compareGoods(searchQuery);console.log('API Response:',response.data);// デバッグ用ログ\nlet responseData=[];if(response.data&&response.data.data){responseData=Array.isArray(response.data.data)?response.data.data:[response.data.data];}else{responseData=[];}console.log('Raw Response Data:',responseData);// デバッグ用ログ\n// レスポンスデータを処理\nlet processedData=[];if(responseData.length>0){// APIが返すグループデータを適切に処理\nprocessedData=responseData.map(group=>{// グループ内の商品リストを処理\nconst goodsList=Array.isArray(group.goodsList)?group.goodsList:[];// 最低価格とプラットフォームを特定\nlet lowestPrice=null;let lowestPlatform='不明';// 最低価格を計算\nif(goodsList.length>0){const lowestProduct=goodsList.reduce((lowest,current)=>current.goodsPrice<lowest.goodsPrice?current:lowest,goodsList[0]);lowestPrice=lowestProduct.goodsPrice;lowestPlatform=getPlatformName(lowestProduct.mallType);}return{goodsName:group.goodsName||'不明な商品',goodsList:goodsList.map(product=>({goodsId:product.goodsId,goodsName:product.goodsName,goodsPrice:product.goodsPrice,goodsLink:product.goodsLink,imgUrl:product.imgUrl,mallType:product.mallType})),lowestPrice:lowestPrice,lowestPlatform:lowestPlatform};});console.log('Processed grouped data:',processedData);// デバッグ用ログ\n}// Fallback: if compare returns empty, try local catalog search\nif(processedData.length===0){try{const localRes=await goodsApi.getGoodsPage(searchQuery,undefined,undefined,currentPage,pageSize,undefined,undefined,selectedPlatforms);if(localRes.data&&localRes.data.code===200){var _localRes$data$data,_localRes$data$data2;const records=((_localRes$data$data=localRes.data.data)===null||_localRes$data$data===void 0?void 0:_localRes$data$data.records)||[];setTotalItems(((_localRes$data$data2=localRes.data.data)===null||_localRes$data$data2===void 0?void 0:_localRes$data$data2.total)||0);processedData=records.map(g=>({goodsName:g.goodsName,goodsList:[{goodsId:g.goodsId,goodsName:g.goodsName,goodsPrice:g.goodsPrice,goodsLink:g.goodsLink||'#',imgUrl:g.imgUrl,mallType:g.mallType||0}],lowestPrice:g.goodsPrice,lowestPlatform:getPlatformName(g.mallType||0)}));}// If still empty, try name-based search as last resort\nif(processedData.length===0){try{const byNameRes=await goodsApi.searchGoodsByName(searchQuery);const list=byNameRes.data&&byNameRes.data.data?Array.isArray(byNameRes.data.data)?byNameRes.data.data:[byNameRes.data.data]:[];processedData=list.map(g=>({goodsName:g.goodsName,goodsList:[{goodsId:g.goodsId,goodsName:g.goodsName,goodsPrice:g.goodsPrice,goodsLink:g.goodsLink||'#',imgUrl:g.imgUrl,mallType:g.mallType||0}],lowestPrice:g.goodsPrice,lowestPlatform:getPlatformName(g.mallType||0)}));}catch(e){console.error('Name-based fallback search failed',e);}}}catch(e){console.error('Local catalog fallback search failed',e);}}console.log('Final processed data:',processedData);// デバッグ用ログ\nsetCompareGroups(processedData);setLoading(false);}catch(err){// On compare error, attempt fallbacks before showing error\ntry{let processedData=[];const localRes=await goodsApi.getGoodsPage(searchQuery,undefined,undefined,currentPage,pageSize,undefined,undefined,selectedPlatforms);if(localRes.data&&localRes.data.code===200){var _localRes$data$data3,_localRes$data$data4;const records=((_localRes$data$data3=localRes.data.data)===null||_localRes$data$data3===void 0?void 0:_localRes$data$data3.records)||[];setTotalItems(((_localRes$data$data4=localRes.data.data)===null||_localRes$data$data4===void 0?void 0:_localRes$data$data4.total)||0);processedData=records.map(g=>({goodsName:g.goodsName,goodsList:[{goodsId:g.goodsId,goodsName:g.goodsName,goodsPrice:g.goodsPrice,goodsLink:g.goodsLink||'#',imgUrl:g.imgUrl,mallType:g.mallType||0}],lowestPrice:g.goodsPrice,lowestPlatform:getPlatformName(g.mallType||0)}));}if(processedData.length===0){const byNameRes=await goodsApi.searchGoodsByName(searchQuery);const list=byNameRes.data&&byNameRes.data.data?Array.isArray(byNameRes.data.data)?byNameRes.data.data:[byNameRes.data.data]:[];processedData=list.map(g=>({goodsName:g.goodsName,goodsList:[{goodsId:g.goodsId,goodsName:g.goodsName,goodsPrice:g.goodsPrice,goodsLink:g.goodsLink||'#',imgUrl:g.imgUrl,mallType:g.mallType||0}],lowestPrice:g.goodsPrice,lowestPlatform:getPlatformName(g.mallType||0)}));}setCompareGroups(processedData);setLoading(false);}catch(fallbackErr){setError('検索に失敗しました。後ほど再試行してください');setLoading(false);console.error(fallbackErr);}console.error(err);}};const handleSearch=e=>{e.preventDefault();if(query.trim()){searchProducts(query);}};const getPlatformName=mallType=>{switch(mallType){case 10:return'楽天';case 20:return'ヤフー';case 30:return'タオバオ';default:return'不明なプラットフォーム';}};const getPlatformColor=mallType=>{switch(mallType){case 10:return'#bf0000';// Rakuten Red\ncase 20:return'#ff0033';// Yahoo Red (adjusted)\ncase 30:return'#ff5000';// Taobao Orange\ndefault:return'#666';}};const getPlatformBadgeClass=mallType=>{switch(mallType){case 10:return'platform-badge rakuten';case 20:return'platform-badge yahoo';case 30:return'platform-badge taobao';default:return'platform-badge unknown';}};const allProducts=compareGroups.flatMap(group=>group.goodsList);const knownBrands=['Apple','Samsung','Sony','Xiaomi','Huawei','Lenovo','Dell','HP','ASUS','Acer','Nintendo','Microsoft','Canon','Nikon'];const parseFacets=name=>{const n=name||'';const brand=knownBrands.find(b=>new RegExp(b,'i').test(n))||'';const seriesMatch=n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);const series=seriesMatch?seriesMatch[1]:'';const modelMatch=n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);const model=modelMatch?modelMatch[1]:'';const storageMatch=n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);const storage=storageMatch?storageMatch[1].replace(/\\s+/g,''):'';const colorMatch=n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight|ブラック|ホワイト|シルバー|ブルー|レッド|グリーン|ゴールド|ピンク|グレー|スペースグレイ|ミッドナイト)\\b/i);const color=colorMatch?colorMatch[1]:'';const sizeMatch=n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);const size=sizeMatch?sizeMatch[1]:'';return{brand,series,model,storage,color,size};};const facetIndex=allProducts.map(p=>parseFacets(p.goodsName));const brands=Array.from(new Set(facetIndex.map(f=>f.brand).filter(Boolean)));const series=Array.from(new Set(facetIndex.map(f=>f.series).filter(Boolean)));const models=Array.from(new Set(facetIndex.map(f=>f.model).filter(Boolean)));const storages=Array.from(new Set(facetIndex.map(f=>f.storage).filter(Boolean)));const colors=Array.from(new Set(facetIndex.map(f=>f.color).filter(Boolean)));const sizes=Array.from(new Set(facetIndex.map(f=>f.size).filter(Boolean)));const parseCategory=name=>{const n=(name||'').toLowerCase();if(/手机壳|ケース|保护壳|カバー/.test(n))return{parent:'スマホアクセサリー',child:'ケース'};if(/iphone|galaxy|xiaomi|huawei|pixel|xperia/.test(n))return{parent:'携帯電話・スマートフォン',child:'スマートフォン本体'};if(/ipad|galaxy tab|surface|tablet/.test(n))return{parent:'パソコン・タブレット',child:'タブレットPC'};if(/macbook|thinkpad|notebook|laptop/.test(n))return{parent:'パソコン・タブレット',child:'ノートパソコン'};if(/monitor|display|显示器/.test(n))return{parent:'パソコン周辺機器',child:'モニター'};if(/mouse|keyboard|鼠标|键盘/.test(n))return{parent:'パソコン周辺機器',child:'キーボード・マウス'};if(/airpods|buds|wh-|wf-|耳机/.test(n))return{parent:'オーディオ・楽器',child:'ヘッドホン・イヤホン'};if(/tv|bravia|regza|电视/.test(n))return{parent:'テレビ・映像機器',child:'テレビ'};if(/camera|eos|alpha|相机/.test(n))return{parent:'カメラ',child:'デジタルカメラ'};if(/lens|镜头/.test(n))return{parent:'カメラ',child:'レンズ'};if(/fridge|refrigerator|冰箱/.test(n))return{parent:'生活家電',child:'冷蔵庫'};if(/washing|washer|洗衣机/.test(n))return{parent:'生活家電',child:'洗濯機'};return{parent:'その他',child:'その他'};};const categoriesAll=Array.from(new Set(allProducts.map(p=>{const c=parseCategory(p.goodsName);return\"\".concat(c.parent,\">\").concat(c.child);}).filter(x=>x!=='其他>其他')));// Build hierarchy tree\nconst categoryTree={};categoriesAll.forEach(c=>{const[p,child]=c.split('>');if(!categoryTree[p])categoryTree[p]=[];if(!categoryTree[p].includes(child))categoryTree[p].push(child);});const filteredProducts=allProducts.filter(p=>{const platformOk=selectedPlatforms.length===0||selectedPlatforms.includes(p.mallType);const minOk=minPrice===''||!isNaN(Number(minPrice))&&p.goodsPrice>=Number(minPrice);const maxOk=maxPrice===''||!isNaN(Number(maxPrice))&&p.goodsPrice<=Number(maxPrice);const f=parseFacets(p.goodsName);const brandOk=selectedBrands.length===0||f.brand&&selectedBrands.includes(f.brand);const seriesOk=selectedSeries.length===0||f.series&&selectedSeries.includes(f.series);const modelOk=selectedModels.length===0||f.model&&selectedModels.includes(f.model);const storageOk=selectedStorage.length===0||f.storage&&selectedStorage.includes(f.storage);const colorOk=selectedColors.length===0||f.color&&selectedColors.includes(f.color);const sizeOk=selectedSizes.length===0||f.size&&selectedSizes.includes(f.size);const cat=parseCategory(p.goodsName);const catStr=\"\".concat(cat.parent,\">\").concat(cat.child);// Simplified category filter: check if any selected category string matches parent or full path\nconst categoryOk=selectedCategories.length===0||selectedCategories.some(sc=>sc===cat.parent||sc===catStr);return platformOk&&minOk&&maxOk&&brandOk&&seriesOk&&modelOk&&storageOk&&colorOk&&sizeOk&&categoryOk;});const sortedProducts=[...filteredProducts].sort((a,b)=>{if(sortOption==='price_asc')return a.goodsPrice-b.goodsPrice;if(sortOption==='price_desc')return b.goodsPrice-a.goodsPrice;if(sortOption==='platform')return a.mallType-b.mallType;if(sortOption==='name')return a.goodsName.localeCompare(b.goodsName);return 0;});const togglePlatform=mt=>{setSelectedPlatforms(prev=>prev.includes(mt)?prev.filter(x=>x!==mt):[...prev,mt]);};const totalPages=searchSource==='local'?Math.max(1,Math.ceil(totalItems/pageSize)):Math.max(1,Math.ceil(sortedProducts.length/pageSize));const currentPageProducts=searchSource==='local'?sortedProducts:sortedProducts.slice((currentPage-1)*pageSize,currentPage*pageSize);const goPrev=()=>setCurrentPage(p=>Math.max(1,p-1));const goNext=()=>setCurrentPage(p=>Math.min(totalPages,p+1));const onChangePageSize=size=>{setPageSize(size);setCurrentPage(1);};const getSelectKey=p=>{if(p.goodsId)return\"id:\".concat(p.goodsId);const base=\"\".concat(p.mallType,\"-\").concat(p.goodsLink||'',\"-\").concat(p.goodsName);return\"k:\".concat(base);};const isSelected=key=>selectedKeys.includes(key);const toggleSelect=p=>{const key=getSelectKey(p);setSelectedKeys(prev=>prev.includes(key)?prev.filter(x=>x!==key):[...prev,key]);};const getSellerFromLink=url=>{if(!url)return'不明な店铺';try{const u=new URL(url.startsWith('http')?url:'https://'+url.replace(/^\\/\\//,''));return u.hostname.replace(/^www\\./,'');}catch(_unused){return'不明な店铺';}};return/*#__PURE__*/_jsxs(\"div\",{className:\"compare-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u5546\\u54C1\\u4FA1\\u683C\\u6BD4\\u8F03\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:query,onChange:e=>setQuery(e.target.value)// 仅更新状态，不触发搜索\n,placeholder:\"\\u5546\\u54C1\\u540D\\u3092\\u5165\\u529B\\u3057\\u3066\\u4FA1\\u683C\\u6BD4\\u8F03...\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:\"\\u641C\\u7D22\"})]})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u691C\\u7D22\\u4E2D...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),!loading&&!error&&allProducts.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"compare-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-section source-toggle-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"source-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(searchSource==='local'?'active':''),onClick:()=>{setSearchSource('local');setCompareGroups([]);},children:\"Local Catalog\"}),/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(searchSource==='compare'?'active':''),onClick:()=>{setSearchSource('compare');setCompareGroups([]);},children:\"Price Compare\"})]})}),searchSource==='local'&&/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section category-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u5206\\u7C7B\\u7B5B\\u9009\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"category-tree\",children:categories.map(cat=>/*#__PURE__*/_jsxs(\"li\",{className:\"category-item \".concat(currentCatId===cat.catId?'active':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"category-label\",onClick:()=>setCurrentCatId(cat.catId===currentCatId?null:cat.catId),children:cat.catName}),cat.children&&cat.children.length>0&&/*#__PURE__*/_jsx(\"ul\",{className:\"category-children\",children:cat.children.map(child=>/*#__PURE__*/_jsx(\"li\",{className:\"category-subitem \".concat(currentCatId===child.catId?'active':''),children:/*#__PURE__*/_jsx(\"span\",{onClick:()=>setCurrentCatId(child.catId===currentCatId?null:child.catId),children:child.catName})},child.catId))})]},cat.catId))})]}),searchSource==='local'&&dynamicFilters.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section dynamic-filters\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u5C5E\\u6027\\u7B5B\\u9009\"}),dynamicFilters.map(attr=>/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:attr.attrName}),/*#__PURE__*/_jsx(\"ul\",{className:\"filter-options\",children:attr.values&&attr.values.map(val=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedDynamicFilters[attr.attrId]===val,onChange:()=>{setSelectedDynamicFilters(prev=>{if(prev[attr.attrId]===val){const next=_objectSpread({},prev);delete next[attr.attrId];return next;}return _objectSpread(_objectSpread({},prev),{},{[attr.attrId]:val});});}}),val]})},val))})]},attr.attrId))]}),searchSource==='compare'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section category-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u5206\\u7C7B\\u7B5B\\u9009\"}),Object.keys(categoryTree).length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"category-list\",children:Object.keys(categoryTree).map(parent=>/*#__PURE__*/_jsxs(\"li\",{className:\"category-parent\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"parent-label\",onClick:()=>{// Select/Deselect parent means select/deselect all children\n// Here we just toggle the parent string in selectedCategories\nsetSelectedCategories(prev=>prev.includes(parent)?prev.filter(x=>x!==parent&&!x.startsWith(parent+'>')):[...prev,parent]);},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedCategories.includes(parent),readOnly:true}),/*#__PURE__*/_jsx(\"span\",{children:parent})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"category-children\",children:categoryTree[parent].map(child=>{const fullPath=\"\".concat(parent,\">\").concat(child);return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedCategories.includes(fullPath)||selectedCategories.includes(parent),onChange:()=>{setSelectedCategories(prev=>{const isParentSelected=prev.includes(parent);const isChildSelected=prev.includes(fullPath);if(isParentSelected){const others=prev.filter(x=>x!==parent&&!x.startsWith(parent+'>'));const siblings=categoryTree[parent].map(c=>\"\".concat(parent,\">\").concat(c));return[...others,...siblings.filter(s=>s!==fullPath)];}return isChildSelected?prev.filter(x=>x!==fullPath):[...prev,fullPath];});}}),child]})},fullPath);})})]},parent))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-filter-data\",children:\"\\u65E0\\u5206\\u7C7B\\u6570\\u636E\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u5236\\u9020\\u5546/\\u54C1\\u724C\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"filter-list\",children:brands.map(b=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedBrands.includes(b),onChange:()=>setSelectedBrands(prev=>prev.includes(b)?prev.filter(x=>x!==b):[...prev,b])}),b]})},b))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u89C4\\u683C\\u53C2\\u6570\"}),series.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"spec-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u7CFB\\u5217\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"filter-list\",children:series.slice(0,10).map(s=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedSeries.includes(s),onChange:()=>setSelectedSeries(prev=>prev.includes(s)?prev.filter(x=>x!==s):[...prev,s])}),\" \",s]})},s))})]}),storages.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"spec-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u5BB9\\u91CF\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"filter-list\",children:storages.map(s=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedStorage.includes(s),onChange:()=>setSelectedStorage(prev=>prev.includes(s)?prev.filter(x=>x!==s):[...prev,s])}),\" \",s]})},s))})]}),colors.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"spec-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u989C\\u8272\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"filter-list\",children:colors.slice(0,8).map(c=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedColors.includes(c),onChange:()=>setSelectedColors(prev=>prev.includes(c)?prev.filter(x=>x!==c):[...prev,c])}),\" \",c]})},c))})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u4EF7\\u683C\\u533A\\u95F4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-range-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\xA5 min\",value:minPrice,onChange:e=>setMinPrice(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\xA5 max\",value:maxPrice,onChange:e=>setMaxPrice(e.target.value)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"\\u5546\\u57CE\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"filter-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedPlatforms.includes(10),onChange:()=>togglePlatform(10)}),\" \\u697D\\u5929\"]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedPlatforms.includes(20),onChange:()=>togglePlatform(20)}),\" Yahoo!\\u30B7\\u30E7\\u30C3\\u30D4\\u30F3\\u30B0\"]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedPlatforms.includes(40),onChange:()=>togglePlatform(40)}),\" Amazon\"]})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"results-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\\"\",query,\"\\\" \\u641C\\u7D22\\u7ED3\\u679C \",/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",filteredProducts.length,\"\\u4EF6)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sort-bar\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sort-label\",children:\"\\u6392\\u5E8F:\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sort-tab \".concat(sortOption==='price_asc'?'active':''),onClick:()=>setSortOption('price_asc'),children:\"\\u4EF7\\u683C\\u4F4E\\u5230\\u9AD8\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sort-tab \".concat(sortOption==='price_desc'?'active':''),onClick:()=>setSortOption('price_desc'),children:\"\\u4EF7\\u683C\\u9AD8\\u5230\\u4F4E\"}),/*#__PURE__*/_jsx(\"button\",{className:\"sort-tab \".concat(sortOption==='platform'?'active':''),onClick:()=>setSortOption('platform'),children:\"\\u5546\\u57CE\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"product-list-view\",children:currentPageProducts.map((product,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-image\",children:/*#__PURE__*/_jsx(\"img\",{src:product.imgUrl||'https://via.placeholder.com/120',alt:product.goodsName,onError:e=>e.target.src='https://via.placeholder.com/120'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-title-row\",children:/*#__PURE__*/_jsx(\"a\",{href:product.goodsLink,target:\"_blank\",rel:\"noopener noreferrer\",className:\"p-title\",onClick:()=>{if(product.goodsId){userApi.addHistory(product.goodsId);}},children:product.goodsName})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-specs\",children:function(){const f=parseFacets(product.goodsName);const parts=[f.brand,f.series,f.model,f.storage,f.color,f.size].filter(Boolean);return parts.join(' | ');}()}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mall-tag mall-\".concat(product.mallType),children:getPlatformName(product.mallType)}),/*#__PURE__*/_jsx(\"span\",{className:\"seller\",children:getSellerFromLink(product.goodsLink)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-action\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-price\",children:[product.goodsPrice.toLocaleString(),\"\\u5186\"]}),/*#__PURE__*/_jsx(\"a\",{href:product.goodsLink,target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn-shop\",onClick:()=>{if(product.goodsId){userApi.addHistory(product.goodsId);}},children:\"\\u524D\\u5F80\\u8D2D\\u4E70\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-trend\",onClick:()=>{ensureGoodsIdAndCollect(product);},children:product.goodsId&&collectedIds.has(product.goodsId)?'取消收藏':'收藏'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-trend\",onClick:()=>{const title=product.goodsName;const labels=Array.from({length:12},(_,i)=>{const d=new Date();d.setMonth(d.getMonth()-(11-i));const m=(d.getMonth()+1).toString().padStart(2,'0');return\"\".concat(d.getFullYear(),\"-\").concat(m);});const base=Math.max(1,product.goodsPrice);let val=base*1.0;const series=labels.map((_,i)=>{const drift=1+Math.sin(i/3)*0.05;const noise=1+(Math.random()-0.5)*0.08;val=Math.max(1,val*drift*noise);return Math.round(val);});setTrendTitle(title);setTrendLabels(labels);setTrendSeries(series);setTrendOpen(true);},children:\"\\u4EF7\\u683C\\u8D70\\u52BF\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"compare-check\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isSelected(getSelectKey(product)),onChange:()=>toggleSelect(product)}),\" \\u5BF9\\u6BD4\"]})]})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination-controls\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:goPrev,disabled:currentPage===1,children:\"\\u4E0A\\u4E00\\u9875\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-info\",children:[currentPage,\" / \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:goNext,disabled:currentPage===totalPages,children:\"\\u4E0B\\u4E00\\u9875\"})]})]}),trendOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"price-trend-modal\",onClick:()=>setTrendOpen(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"modal-title\",children:trendTitle}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"modal-close\",onClick:()=>setTrendOpen(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsx(\"div\",{className:\"trend-chart\",children:function(){const width=600;const height=280;const padding=32;const xs=trendSeries.map((_,i)=>padding+i*(width-2*padding)/(trendSeries.length-1));const minV=Math.min(...trendSeries);const maxV=Math.max(...trendSeries);const ys=trendSeries.map(v=>height-padding-(v-minV)/Math.max(1,maxV-minV)*(height-2*padding));const path=xs.map((x,i)=>\"\".concat(i===0?'M':'L').concat(x,\",\").concat(ys[i])).join(' ');const gridY=[0.25,0.5,0.75].map(r=>height-padding-r*(height-2*padding));return/*#__PURE__*/_jsxs(\"svg\",{width:width,height:height,role:\"img\",\"aria-label\":\"\\u4EF7\\u683C\\u8D8B\\u52BF\\u56FE\",children:[gridY.map((gy,i)=>/*#__PURE__*/_jsx(\"line\",{x1:padding,y1:gy,x2:width-padding,y2:gy,stroke:\"#eee\"},i)),/*#__PURE__*/_jsx(\"path\",{d:path,fill:\"none\",stroke:\"#ff4400\",strokeWidth:2}),xs.map((x,i)=>/*#__PURE__*/_jsx(\"circle\",{cx:x,cy:ys[i],r:3,fill:\"#ff4400\"},i)),/*#__PURE__*/_jsx(\"text\",{x:padding,y:height-8,fontSize:12,fill:\"#999\",children:trendLabels[0]}),/*#__PURE__*/_jsx(\"text\",{x:width-padding-60,y:height-8,fontSize:12,fill:\"#999\",children:trendLabels[trendLabels.length-1]})]});}()})})]})})]}),!loading&&!error&&compareGroups.length===0&&query&&/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"\\u95A2\\u9023\\u5546\\u54C1\\u304C\\u898B\\u3064\\u304B\\u308A\\u307E\\u305B\\u3093\"})]});};export default ComparePage;","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","goodsApi","categoryApi","userApi","goodsOperateApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ComparePage","searchParams","query","setQuery","get","compareGroups","setCompareGroups","loading","setLoading","error","setError","sortOption","setSortOption","selectedPlatforms","setSelectedPlatforms","minPrice","setMinPrice","maxPrice","setMaxPrice","currentPage","setCurrentPage","pageSize","setPageSize","selectedKeys","setSelectedKeys","selectedBrands","setSelectedBrands","selectedSeries","setSelectedSeries","selectedModels","setSelectedModels","selectedStorage","setSelectedStorage","selectedColors","setSelectedColors","selectedSizes","setSelectedSizes","selectedCategories","setSelectedCategories","trendOpen","setTrendOpen","trendLabels","setTrendLabels","trendSeries","setTrendSeries","trendTitle","setTrendTitle","collectedIds","setCollectedIds","Set","searchSource","setSearchSource","executedQuery","setExecutedQuery","totalItems","setTotalItems","categories","setCategories","dynamicFilters","setDynamicFilters","selectedDynamicFilters","setSelectedDynamicFilters","currentCatId","setCurrentCatId","getList","then","res","data","code","catch","err","console","trim","searchProducts","getAttributes","getMyCollect","Array","isArray","ids","map","g","goodsId","filter","id","e","toggleCollect","has","cancelCollect","prev","next","delete","collect","add","alert","ensureGoodsIdAndCollect","product","token","localStorage","getItem","payload","goodsName","goodsPrice","goodsLink","imgUrl","mallType","status","addRes","addAndReturn","newId","searchQuery","minP","Number","undefined","maxP","log","response","getGoodsPage","records","total","processedData","goodsList","lowestPrice","lowestPlatform","getPlatformName","length","cmpRes","compareGoods","responseData","cmpProcessed","group","lowestProduct","reduce","lowest","current","localRes","_localRes$data$data","_localRes$data$data2","byNameRes","searchGoodsByName","list","_localRes$data$data3","_localRes$data$data4","fallbackErr","handleSearch","preventDefault","getPlatformColor","getPlatformBadgeClass","allProducts","flatMap","knownBrands","parseFacets","name","n","brand","find","b","RegExp","test","seriesMatch","match","series","modelMatch","model","storageMatch","storage","replace","colorMatch","color","sizeMatch","size","facetIndex","p","brands","from","f","Boolean","models","storages","colors","sizes","parseCategory","toLowerCase","parent","child","categoriesAll","c","concat","x","categoryTree","forEach","split","includes","push","filteredProducts","platformOk","minOk","isNaN","maxOk","brandOk","seriesOk","modelOk","storageOk","colorOk","sizeOk","cat","catStr","categoryOk","some","sc","sortedProducts","sort","a","localeCompare","togglePlatform","mt","totalPages","Math","max","ceil","currentPageProducts","slice","goPrev","goNext","min","onChangePageSize","getSelectKey","base","isSelected","key","toggleSelect","getSellerFromLink","url","u","URL","startsWith","hostname","_unused","className","children","onSubmit","type","value","onChange","target","placeholder","onClick","catId","catName","attr","attrName","values","val","checked","attrId","_objectSpread","Object","keys","readOnly","fullPath","isParentSelected","isChildSelected","others","siblings","s","index","src","alt","onError","href","rel","addHistory","parts","join","toLocaleString","title","labels","_","i","d","Date","setMonth","getMonth","m","toString","padStart","getFullYear","drift","sin","noise","random","round","disabled","stopPropagation","width","height","padding","xs","minV","maxV","ys","v","path","gridY","r","role","gy","x1","y1","x2","y2","stroke","fill","strokeWidth","cx","cy","y","fontSize"],"sources":["C:/Users/3jz/Desktop/HJZDM/frontend/hjzdm-frontend/src/pages/ComparePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport './ComparePage.css';\nimport { goodsApi, categoryApi, userApi, goodsOperateApi } from '../services/api';\n\ninterface Product {\n  goodsId?: number;\n  goodsName: string;\n  goodsPrice: number;\n  goodsLink: string;\n  imgUrl?: string;\n  mallType: number;\n}\n\ninterface CompareGroup {\n  goodsName: string;\n  goodsList: Product[];\n  lowestPrice: number | null;\n  lowestPlatform?: string;\n}\n\nconst ComparePage: React.FC = () => {\n  const [searchParams] = useSearchParams();\n  const [query, setQuery] = useState(searchParams.get('query') || '');\n  const [compareGroups, setCompareGroups] = useState<CompareGroup[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [sortOption, setSortOption] = useState('price_asc');\n  const [selectedPlatforms, setSelectedPlatforms] = useState<number[]>([]);\n  const [minPrice, setMinPrice] = useState('');\n  const [maxPrice, setMaxPrice] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(50);\n  const [selectedKeys, setSelectedKeys] = useState<string[]>([]);\n  const [selectedBrands, setSelectedBrands] = useState<string[]>([]);\n  const [selectedSeries, setSelectedSeries] = useState<string[]>([]);\n  const [selectedModels, setSelectedModels] = useState<string[]>([]);\n  const [selectedStorage, setSelectedStorage] = useState<string[]>([]);\n  const [selectedColors, setSelectedColors] = useState<string[]>([]);\n  const [selectedSizes, setSelectedSizes] = useState<string[]>([]);\n  const [selectedCategories, setSelectedCategories] = useState<string[]>([]);\n  const [trendOpen, setTrendOpen] = useState(false);\n  const [trendLabels, setTrendLabels] = useState<string[]>([]);\n  const [trendSeries, setTrendSeries] = useState<number[]>([]);\n  const [trendTitle, setTrendTitle] = useState('');\n  const [collectedIds, setCollectedIds] = useState<Set<number>>(new Set());\n\n  // Search Source\n  const [searchSource, setSearchSource] = useState<'local' | 'compare'>('compare');\n  const [executedQuery, setExecutedQuery] = useState('');\n  const [totalItems, setTotalItems] = useState(0);\n\n  // Dynamic Filters State\n  const [categories, setCategories] = useState<any[]>([]);\n  const [dynamicFilters, setDynamicFilters] = useState<any[]>([]);\n  const [selectedDynamicFilters, setSelectedDynamicFilters] = useState<Record<string, string>>({});\n  const [currentCatId, setCurrentCatId] = useState<number | null>(null);\n\n  // Fetch categories on mount\n  useEffect(() => {\n    categoryApi.getList().then(res => {\n      if (res.data.code === 200) {\n        setCategories(res.data.data);\n      }\n    }).catch(err => console.error(\"Failed to fetch categories\", err));\n  }, []);\n\n  // 仅在页面加载时，如果有URL参数，则执行搜索\n  useEffect(() => {\n    if (query.trim()) {\n      searchProducts(query);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Fetch dynamic attributes when category changes\n  useEffect(() => {\n    if (currentCatId) {\n      categoryApi.getAttributes(currentCatId).then(res => {\n        if (res.data.code === 200) {\n          setDynamicFilters(res.data.data);\n        }\n      }).catch(err => console.error(\"Failed to fetch attributes\", err));\n    } else {\n        setDynamicFilters([]);\n    }\n  }, [currentCatId]);\n\n  // Auto-search when filters change (Local Mode only)\n  useEffect(() => {\n    if (searchSource === 'local') {\n      searchProducts(executedQuery || query);\n    }\n  }, [selectedDynamicFilters, currentCatId, currentPage, pageSize, searchSource, selectedPlatforms]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const res = await goodsApi.getMyCollect(1, 500);\n        if (res.data && res.data.code === 200 && Array.isArray(res.data.data)) {\n          const ids = res.data.data.map((g: any) => g.goodsId).filter((id: any) => typeof id === 'number');\n          setCollectedIds(new Set(ids));\n        }\n      } catch (e) {\n      }\n    })();\n  }, []);\n\n  const toggleCollect = async (goodsId: number) => {\n    try {\n      if (collectedIds.has(goodsId)) {\n        const res = await goodsOperateApi.cancelCollect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.delete(goodsId);\n            return next;\n          });\n        }\n      } else {\n        const res = await goodsOperateApi.collect(goodsId);\n        if (res.data && res.data.code === 200) {\n          setCollectedIds(prev => {\n            const next = new Set(prev);\n            next.add(goodsId);\n            return next;\n          });\n        } else {\n          alert('请先登录');\n        }\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n\n  const ensureGoodsIdAndCollect = async (product: Product) => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        alert('请先登录');\n        return;\n      }\n      if (product.goodsId) {\n        await toggleCollect(product.goodsId);\n        return;\n      }\n      const payload: any = {\n        goodsName: product.goodsName,\n        goodsPrice: product.goodsPrice,\n        goodsLink: product.goodsLink,\n        imgUrl: product.imgUrl,\n        mallType: product.mallType,\n        status: 1\n      };\n      const addRes = await goodsApi.addAndReturn(payload);\n      if (addRes.data && addRes.data.code === 200 && addRes.data.data && addRes.data.data.goodsId) {\n        const newId = addRes.data.data.goodsId as number;\n        await toggleCollect(newId);\n      } else {\n        alert('新增商品失败');\n      }\n    } catch (e) {\n      alert('操作失败');\n    }\n  };\n\n  const searchProducts = async (searchQuery: string) => {\n    if (!searchQuery.trim() && searchSource === 'compare') return;\n    \n    setExecutedQuery(searchQuery);\n    setLoading(true);\n    setError(null);\n    \n    try {\n      if (searchSource === 'local') {\n        const minP = minPrice ? Number(minPrice) : undefined;\n        const maxP = maxPrice ? Number(maxPrice) : undefined;\n        console.log('Calling API: goodsApi.getGoodsPage', { searchQuery, selectedDynamicFilters, currentCatId, minP, maxP, selectedPlatforms });\n        const response = await goodsApi.getGoodsPage(searchQuery, selectedDynamicFilters, currentCatId || undefined, currentPage, pageSize, minP, maxP, selectedPlatforms);\n        console.log('Local API Response:', response.data);\n\n        if (response.data && response.data.code === 200) {\n          const records = response.data.data.records || [];\n          setTotalItems(response.data.data.total || 0);\n          const processedData = records.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n          if (processedData.length === 0) {\n            try {\n              const cmpRes = await goodsApi.compareGoods(searchQuery);\n              let responseData: any[] = [];\n              if (cmpRes.data && cmpRes.data.data) {\n                responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n              }\n              let cmpProcessed: any[] = [];\n              if (responseData.length > 0) {\n                cmpProcessed = responseData.map((group: any) => {\n                  const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                  let lowestPrice: number | null = null;\n                  let lowestPlatform = '不明';\n                  if (goodsList.length > 0) {\n                    const lowestProduct = goodsList.reduce((lowest: any, current: any) =>\n                      current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                    lowestPrice = lowestProduct.goodsPrice;\n                    lowestPlatform = getPlatformName(lowestProduct.mallType);\n                  }\n                  return {\n                    goodsName: group.goodsName || '不明な商品',\n                    goodsList: goodsList.map((product: any) => ({\n                      goodsId: product.goodsId,\n                      goodsName: product.goodsName,\n                      goodsPrice: product.goodsPrice,\n                      goodsLink: product.goodsLink,\n                      imgUrl: product.imgUrl,\n                      mallType: product.mallType\n                    })),\n                    lowestPrice,\n                    lowestPlatform\n                  };\n                });\n              }\n              setCompareGroups(cmpProcessed);\n              setLoading(false);\n              return;\n            } catch (e) {\n              console.error('Fallback compare search failed', e);\n            }\n          }\n          setCompareGroups(processedData);\n        } else {\n          setCompareGroups([]);\n          setTotalItems(0);\n          try {\n            const cmpRes = await goodsApi.compareGoods(searchQuery);\n            let responseData: any[] = [];\n            if (cmpRes.data && cmpRes.data.data) {\n              responseData = Array.isArray(cmpRes.data.data) ? cmpRes.data.data : [cmpRes.data.data];\n            }\n            let processedData: any[] = [];\n            if (responseData.length > 0) {\n              processedData = responseData.map((group: any) => {\n                const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n                let lowestPrice: number | null = null;\n                let lowestPlatform = '不明';\n                if (goodsList.length > 0) {\n                  const lowestProduct = goodsList.reduce((lowest: any, current: any) =>\n                    current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n                  lowestPrice = lowestProduct.goodsPrice;\n                  lowestPlatform = getPlatformName(lowestProduct.mallType);\n                }\n                return {\n                  goodsName: group.goodsName || '不明な商品',\n                  goodsList: goodsList.map((product: any) => ({\n                    goodsId: product.goodsId,\n                    goodsName: product.goodsName,\n                    goodsPrice: product.goodsPrice,\n                    goodsLink: product.goodsLink,\n                    imgUrl: product.imgUrl,\n                    mallType: product.mallType\n                  })),\n                  lowestPrice,\n                  lowestPlatform\n                };\n              });\n            }\n            setCompareGroups(processedData);\n          } catch (e) {\n            console.error('Fallback compare search failed', e);\n          }\n        }\n        setLoading(false);\n        return;\n      }\n\n      console.log('Calling API: goodsApi.compareGoods with query:', searchQuery); // デバッグ用ログ\n      \n      // 使用api.ts中定义的API服务\n      const response = await goodsApi.compareGoods(searchQuery);\n      \n      console.log('API Response:', response.data); // デバッグ用ログ\n      \n      let responseData = [];\n      if (response.data && response.data.data) {\n        responseData = Array.isArray(response.data.data) ? response.data.data : [response.data.data];\n      } else {\n        responseData = [];\n      }\n      \n      console.log('Raw Response Data:', responseData); // デバッグ用ログ\n      \n      // レスポンスデータを処理\n      let processedData: any[] = [];\n      \n      if (responseData.length > 0) {\n        // APIが返すグループデータを適切に処理\n        processedData = responseData.map((group: any) => {\n          // グループ内の商品リストを処理\n          const goodsList = Array.isArray(group.goodsList) ? group.goodsList : [];\n          \n          // 最低価格とプラットフォームを特定\n          let lowestPrice = null;\n          let lowestPlatform = '不明';\n          \n          // 最低価格を計算\n          if (goodsList.length > 0) {\n            const lowestProduct = goodsList.reduce((lowest: any, current: any) => \n              current.goodsPrice < lowest.goodsPrice ? current : lowest, goodsList[0]);\n            \n            lowestPrice = lowestProduct.goodsPrice;\n            lowestPlatform = getPlatformName(lowestProduct.mallType);\n          }\n          \n          return {\n            goodsName: group.goodsName || '不明な商品',\n            goodsList: goodsList.map((product: any) => ({\n              goodsId: product.goodsId,\n              goodsName: product.goodsName,\n              goodsPrice: product.goodsPrice,\n              goodsLink: product.goodsLink,\n              imgUrl: product.imgUrl,\n              mallType: product.mallType\n            })),\n            lowestPrice: lowestPrice,\n            lowestPlatform: lowestPlatform\n          };\n        });\n        \n        console.log('Processed grouped data:', processedData); // デバッグ用ログ\n      }\n\n      // Fallback: if compare returns empty, try local catalog search\n      if (processedData.length === 0) {\n        try {\n          const localRes = await goodsApi.getGoodsPage(\n            searchQuery,\n            undefined,\n            undefined,\n            currentPage,\n            pageSize,\n            undefined,\n            undefined,\n            selectedPlatforms\n          );\n          if (localRes.data && localRes.data.code === 200) {\n            const records = localRes.data.data?.records || [];\n            setTotalItems(localRes.data.data?.total || 0);\n            processedData = records.map((g: any) => ({\n              goodsName: g.goodsName,\n              goodsList: [{\n                goodsId: g.goodsId,\n                goodsName: g.goodsName,\n                goodsPrice: g.goodsPrice,\n                goodsLink: g.goodsLink || '#',\n                imgUrl: g.imgUrl,\n                mallType: g.mallType || 0\n              }],\n              lowestPrice: g.goodsPrice,\n              lowestPlatform: getPlatformName(g.mallType || 0)\n            }));\n          }\n          // If still empty, try name-based search as last resort\n          if (processedData.length === 0) {\n            try {\n              const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n              const list = (byNameRes.data && byNameRes.data.data)\n                ? (Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data])\n                : [];\n              processedData = list.map((g: any) => ({\n                goodsName: g.goodsName,\n                goodsList: [{\n                  goodsId: g.goodsId,\n                  goodsName: g.goodsName,\n                  goodsPrice: g.goodsPrice,\n                  goodsLink: g.goodsLink || '#',\n                  imgUrl: g.imgUrl,\n                  mallType: g.mallType || 0\n                }],\n                lowestPrice: g.goodsPrice,\n                lowestPlatform: getPlatformName(g.mallType || 0)\n              }));\n            } catch (e) {\n              console.error('Name-based fallback search failed', e);\n            }\n          }\n        } catch (e) {\n          console.error('Local catalog fallback search failed', e);\n        }\n      }\n      \n      console.log('Final processed data:', processedData); // デバッグ用ログ\n      \n      setCompareGroups(processedData);\n      setLoading(false);\n    } catch (err) {\n      // On compare error, attempt fallbacks before showing error\n      try {\n        let processedData: any[] = [];\n        const localRes = await goodsApi.getGoodsPage(\n          searchQuery,\n          undefined,\n          undefined,\n          currentPage,\n          pageSize,\n          undefined,\n          undefined,\n          selectedPlatforms\n        );\n        if (localRes.data && localRes.data.code === 200) {\n          const records = localRes.data.data?.records || [];\n          setTotalItems(localRes.data.data?.total || 0);\n          processedData = records.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        if (processedData.length === 0) {\n          const byNameRes = await goodsApi.searchGoodsByName(searchQuery);\n          const list = (byNameRes.data && byNameRes.data.data)\n            ? (Array.isArray(byNameRes.data.data) ? byNameRes.data.data : [byNameRes.data.data])\n            : [];\n          processedData = list.map((g: any) => ({\n            goodsName: g.goodsName,\n            goodsList: [{\n              goodsId: g.goodsId,\n              goodsName: g.goodsName,\n              goodsPrice: g.goodsPrice,\n              goodsLink: g.goodsLink || '#',\n              imgUrl: g.imgUrl,\n              mallType: g.mallType || 0\n            }],\n            lowestPrice: g.goodsPrice,\n            lowestPlatform: getPlatformName(g.mallType || 0)\n          }));\n        }\n        setCompareGroups(processedData);\n        setLoading(false);\n      } catch (fallbackErr) {\n        setError('検索に失敗しました。後ほど再試行してください');\n        setLoading(false);\n        console.error(fallbackErr);\n      }\n      console.error(err);\n    }\n  };\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      searchProducts(query);\n    }\n  };\n\n  const getPlatformName = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '楽天';\n      case 20: return 'ヤフー';\n      case 30: return 'タオバオ';\n      default: return '不明なプラットフォーム';\n    }\n  };\n\n  const getPlatformColor = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return '#bf0000'; // Rakuten Red\n      case 20: return '#ff0033'; // Yahoo Red (adjusted)\n      case 30: return '#ff5000'; // Taobao Orange\n      default: return '#666';\n    }\n  };\n\n  const getPlatformBadgeClass = (mallType: number): string => {\n    switch (mallType) {\n      case 10: return 'platform-badge rakuten';\n      case 20: return 'platform-badge yahoo';\n      case 30: return 'platform-badge taobao';\n      default: return 'platform-badge unknown';\n    }\n  };\n\n  const allProducts: Product[] = compareGroups.flatMap(group => group.goodsList);\n  const knownBrands = ['Apple','Samsung','Sony','Xiaomi','Huawei','Lenovo','Dell','HP','ASUS','Acer','Nintendo','Microsoft','Canon','Nikon'];\n  const parseFacets = (name: string) => {\n    const n = name || '';\n    const brand = knownBrands.find(b => new RegExp(b, 'i').test(n)) || '';\n    const seriesMatch = n.match(/(iPhone|MacBook|iPad|Galaxy|ThinkPad|Surface|PlayStation|Switch|WH\\-\\d{4}XM\\d|RX\\s?\\d{3,}|EOS\\s?\\w+)/i);\n    const series = seriesMatch ? seriesMatch[1] : '';\n    const modelMatch = n.match(/([A-Za-z]{1,3}\\-?\\d{2,4}[A-Za-z]?|\\bPro Max\\b|\\bPro\\b|\\bUltra\\b|\\bPlus\\b|\\bAir\\b|\\bMini\\b)/i);\n    const model = modelMatch ? modelMatch[1] : '';\n    const storageMatch = n.match(/(\\b\\d{2,4}\\s?(GB|TB)\\b)/i);\n    const storage = storageMatch ? storageMatch[1].replace(/\\s+/g,'') : '';\n    const colorMatch = n.match(/\\b(Black|White|Silver|Blue|Red|Green|Gold|Pink|Gray|Space Gray|Midnight|ブラック|ホワイト|シルバー|ブルー|レッド|グリーン|ゴールド|ピンク|グレー|スペースグレイ|ミッドナイト)\\b/i);\n    const color = colorMatch ? colorMatch[1] : '';\n    const sizeMatch = n.match(/(\\b\\d{1,2}(?:\\.\\d)?\\s?(?:吋|インチ|\"|英寸)\\b)/);\n    const size = sizeMatch ? sizeMatch[1] : '';\n    return { brand, series, model, storage, color, size };\n  };\n  const facetIndex = allProducts.map(p => parseFacets(p.goodsName));\n  const brands = Array.from(new Set(facetIndex.map(f => f.brand).filter(Boolean)));\n  const series = Array.from(new Set(facetIndex.map(f => f.series).filter(Boolean)));\n  const models = Array.from(new Set(facetIndex.map(f => f.model).filter(Boolean)));\n  const storages = Array.from(new Set(facetIndex.map(f => f.storage).filter(Boolean)));\n  const colors = Array.from(new Set(facetIndex.map(f => f.color).filter(Boolean)));\n  const sizes = Array.from(new Set(facetIndex.map(f => f.size).filter(Boolean)));\n  const parseCategory = (name: string) => {\n    const n = (name || '').toLowerCase();\n    if (/手机壳|ケース|保护壳|カバー/.test(n)) return { parent: 'スマホアクセサリー', child: 'ケース' };\n    if (/iphone|galaxy|xiaomi|huawei|pixel|xperia/.test(n)) return { parent: '携帯電話・スマートフォン', child: 'スマートフォン本体' };\n    if (/ipad|galaxy tab|surface|tablet/.test(n)) return { parent: 'パソコン・タブレット', child: 'タブレットPC' };\n    if (/macbook|thinkpad|notebook|laptop/.test(n)) return { parent: 'パソコン・タブレット', child: 'ノートパソコン' };\n    if (/monitor|display|显示器/.test(n)) return { parent: 'パソコン周辺機器', child: 'モニター' };\n    if (/mouse|keyboard|鼠标|键盘/.test(n)) return { parent: 'パソコン周辺機器', child: 'キーボード・マウス' };\n    if (/airpods|buds|wh-|wf-|耳机/.test(n)) return { parent: 'オーディオ・楽器', child: 'ヘッドホン・イヤホン' };\n    if (/tv|bravia|regza|电视/.test(n)) return { parent: 'テレビ・映像機器', child: 'テレビ' };\n    if (/camera|eos|alpha|相机/.test(n)) return { parent: 'カメラ', child: 'デジタルカメラ' };\n    if (/lens|镜头/.test(n)) return { parent: 'カメラ', child: 'レンズ' };\n    if (/fridge|refrigerator|冰箱/.test(n)) return { parent: '生活家電', child: '冷蔵庫' };\n    if (/washing|washer|洗衣机/.test(n)) return { parent: '生活家電', child: '洗濯機' };\n    return { parent: 'その他', child: 'その他' };\n  };\n  \n  const categoriesAll = Array.from(new Set(allProducts.map(p => {\n    const c = parseCategory(p.goodsName);\n    return `${c.parent}>${c.child}`;\n  }).filter(x => x !== '其他>其他')));\n  \n  // Build hierarchy tree\n  const categoryTree: Record<string, string[]> = {};\n  categoriesAll.forEach(c => {\n    const [p, child] = c.split('>');\n    if (!categoryTree[p]) categoryTree[p] = [];\n    if (!categoryTree[p].includes(child)) categoryTree[p].push(child);\n  });\n\n  const filteredProducts: Product[] = allProducts.filter(p => {\n    const platformOk = selectedPlatforms.length === 0 || selectedPlatforms.includes(p.mallType);\n    const minOk = minPrice === '' || (!isNaN(Number(minPrice)) && p.goodsPrice >= Number(minPrice));\n    const maxOk = maxPrice === '' || (!isNaN(Number(maxPrice)) && p.goodsPrice <= Number(maxPrice));\n    const f = parseFacets(p.goodsName);\n    const brandOk = selectedBrands.length === 0 || (f.brand && selectedBrands.includes(f.brand));\n    const seriesOk = selectedSeries.length === 0 || (f.series && selectedSeries.includes(f.series));\n    const modelOk = selectedModels.length === 0 || (f.model && selectedModels.includes(f.model));\n    const storageOk = selectedStorage.length === 0 || (f.storage && selectedStorage.includes(f.storage));\n    const colorOk = selectedColors.length === 0 || (f.color && selectedColors.includes(f.color));\n    const sizeOk = selectedSizes.length === 0 || (f.size && selectedSizes.includes(f.size));\n    \n    const cat = parseCategory(p.goodsName);\n    const catStr = `${cat.parent}>${cat.child}`;\n    // Simplified category filter: check if any selected category string matches parent or full path\n    const categoryOk = selectedCategories.length === 0 || \n      selectedCategories.some(sc => sc === cat.parent || sc === catStr);\n\n    return platformOk && minOk && maxOk && brandOk && seriesOk && modelOk && storageOk && colorOk && sizeOk && categoryOk;\n  });\n  const sortedProducts: Product[] = [...filteredProducts].sort((a, b) => {\n    if (sortOption === 'price_asc') return a.goodsPrice - b.goodsPrice;\n    if (sortOption === 'price_desc') return b.goodsPrice - a.goodsPrice;\n    if (sortOption === 'platform') return a.mallType - b.mallType;\n    if (sortOption === 'name') return a.goodsName.localeCompare(b.goodsName);\n    return 0;\n  });\n  const togglePlatform = (mt: number) => {\n    setSelectedPlatforms(prev => prev.includes(mt) ? prev.filter(x => x !== mt) : [...prev, mt]);\n  };\n\n  const totalPages = searchSource === 'local' \n    ? Math.max(1, Math.ceil(totalItems / pageSize)) \n    : Math.max(1, Math.ceil(sortedProducts.length / pageSize));\n  \n  const currentPageProducts = searchSource === 'local' \n    ? sortedProducts \n    : sortedProducts.slice((currentPage - 1) * pageSize, currentPage * pageSize);\n  const goPrev = () => setCurrentPage(p => Math.max(1, p - 1));\n  const goNext = () => setCurrentPage(p => Math.min(totalPages, p + 1));\n  const onChangePageSize = (size: number) => { setPageSize(size); setCurrentPage(1); };\n\n  const getSelectKey = (p: Product) => {\n    if (p.goodsId) return `id:${p.goodsId}`;\n    const base = `${p.mallType}-${p.goodsLink || ''}-${p.goodsName}`;\n    return `k:${base}`;\n  };\n  const isSelected = (key: string) => selectedKeys.includes(key);\n  const toggleSelect = (p: Product) => {\n    const key = getSelectKey(p);\n    setSelectedKeys(prev => prev.includes(key) ? prev.filter(x => x !== key) : [...prev, key]);\n  };\n\n  const getSellerFromLink = (url?: string) => {\n    if (!url) return '不明な店铺';\n    try {\n      const u = new URL(url.startsWith('http') ? url : ('https://' + url.replace(/^\\/\\//, '')));\n      return u.hostname.replace(/^www\\./, '');\n    } catch {\n      return '不明な店铺';\n    }\n  };\n\n  return (\n    <div className=\"compare-page\">\n      <div className=\"search-section\">\n        <h1>商品価格比較</h1>\n        <form onSubmit={handleSearch} className=\"search-form\">\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => setQuery(e.target.value)} // 仅更新状态，不触发搜索\n            placeholder=\"商品名を入力して価格比較...\"\n            className=\"search-input\"\n          />\n          <button type=\"submit\" className=\"search-button\">搜索</button>\n        </form>\n      </div>\n\n      {loading && <div className=\"loading\">検索中...</div>}\n      {error && <div className=\"error\">{error}</div>}\n\n      {!loading && !error && allProducts.length > 0 && (\n        <div className=\"compare-container\">\n          {/* Sidebar Filters */}\n          <div className=\"sidebar\">\n            {/* Search Source Toggle */}\n            <div className=\"sidebar-section source-toggle-section\">\n                <div className=\"source-toggle\">\n                    <button \n                        className={`toggle-btn ${searchSource === 'local' ? 'active' : ''}`}\n                        onClick={() => { setSearchSource('local'); setCompareGroups([]); }}\n                    >\n                        Local Catalog\n                    </button>\n                    <button \n                        className={`toggle-btn ${searchSource === 'compare' ? 'active' : ''}`}\n                        onClick={() => { setSearchSource('compare'); setCompareGroups([]); }}\n                    >\n                        Price Compare\n                    </button>\n                </div>\n            </div>\n\n            {/* Category Tree (Local Mode) */}\n            {searchSource === 'local' && (\n                <div className=\"sidebar-section category-section\">\n                  <h3 className=\"sidebar-title\">分类筛选</h3>\n                  <ul className=\"category-tree\">\n                    {categories.map(cat => (\n                        <li key={cat.catId} className={`category-item ${currentCatId === cat.catId ? 'active' : ''}`}>\n                            <div className=\"category-label\" onClick={() => setCurrentCatId(cat.catId === currentCatId ? null : cat.catId)}>\n                                {cat.catName}\n                            </div>\n                            {cat.children && cat.children.length > 0 && (\n                                <ul className=\"category-children\">\n                                    {cat.children.map((child: any) => (\n                                        <li key={child.catId} className={`category-subitem ${currentCatId === child.catId ? 'active' : ''}`}>\n                                            <span onClick={() => setCurrentCatId(child.catId === currentCatId ? null : child.catId)}>\n                                                {child.catName}\n                                            </span>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </li>\n                    ))}\n                  </ul>\n                </div>\n            )}\n\n            {/* Dynamic Filters (Local Mode + Category Selected) */}\n            {searchSource === 'local' && dynamicFilters.length > 0 && (\n                <div className=\"sidebar-section dynamic-filters\">\n                    <h3 className=\"sidebar-title\">属性筛选</h3>\n                    {dynamicFilters.map(attr => (\n                        <div key={attr.attrId} className=\"filter-group\">\n                            <h4>{attr.attrName}</h4>\n                            <ul className=\"filter-options\">\n                                {attr.values && attr.values.map((val: string) => (\n                                    <li key={val}>\n                                        <label>\n                                            <input \n                                                type=\"checkbox\"\n                                                checked={selectedDynamicFilters[attr.attrId] === val}\n                                                onChange={() => {\n                                                    setSelectedDynamicFilters(prev => {\n                                                        if (prev[attr.attrId] === val) {\n                                                            const next = { ...prev };\n                                                            delete next[attr.attrId];\n                                                            return next;\n                                                        }\n                                                        return { ...prev, [attr.attrId]: val };\n                                                    });\n                                                }}\n                                            />\n                                            {val}\n                                        </label>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    ))}\n                </div>\n            )}\n\n            {searchSource === 'compare' && (\n                <>\n                <div className=\"sidebar-section category-section\">\n                <h3 className=\"sidebar-title\">分类筛选</h3>\n                {Object.keys(categoryTree).length > 0 ? (\n                    <ul className=\"category-list\">\n                    {Object.keys(categoryTree).map(parent => (\n                        <li key={parent} className=\"category-parent\">\n                        <div className=\"parent-label\" onClick={() => {\n                            // Select/Deselect parent means select/deselect all children\n                            // Here we just toggle the parent string in selectedCategories\n                            setSelectedCategories(prev => prev.includes(parent) ? prev.filter(x => x !== parent && !x.startsWith(parent + '>')) : [...prev, parent]);\n                        }}>\n                            <input type=\"checkbox\" checked={selectedCategories.includes(parent)} readOnly />\n                            <span>{parent}</span>\n                        </div>\n                        <ul className=\"category-children\">\n                            {categoryTree[parent].map(child => {\n                            const fullPath = `${parent}>${child}`;\n                            return (\n                                <li key={fullPath}>\n                                <label>\n                                    <input \n                                    type=\"checkbox\" \n                                    checked={selectedCategories.includes(fullPath) || selectedCategories.includes(parent)} \n                                    onChange={() => {\n                                        setSelectedCategories(prev => {\n                                        const isParentSelected = prev.includes(parent);\n                                        const isChildSelected = prev.includes(fullPath);\n                                        if (isParentSelected) {\n                                            const others = prev.filter(x => x !== parent && !x.startsWith(parent + '>'));\n                                            const siblings = categoryTree[parent].map(c => `${parent}>${c}`);\n                                            return [...others, ...siblings.filter(s => s !== fullPath)];\n                                        }\n                                        return isChildSelected ? prev.filter(x => x !== fullPath) : [...prev, fullPath];\n                                        });\n                                    }}\n                                    />\n                                    {child}\n                                </label>\n                                </li>\n                            );\n                            })}\n                        </ul>\n                        </li>\n                    ))}\n                    </ul>\n                ) : <div className=\"no-filter-data\">无分类数据</div>}\n                </div>\n\n                <div className=\"sidebar-section\">\n                <h3 className=\"sidebar-title\">制造商/品牌</h3>\n                <ul className=\"filter-list\">\n                    {brands.map(b => (\n                    <li key={b}>\n                        <label>\n                        <input \n                            type=\"checkbox\" \n                            checked={selectedBrands.includes(b)} \n                            onChange={() => setSelectedBrands(prev => prev.includes(b) ? prev.filter(x=>x!==b) : [...prev,b])} \n                        />\n                        {b}\n                        </label>\n                    </li>\n                    ))}\n                </ul>\n                </div>\n\n                <div className=\"sidebar-section\">\n                <h3 className=\"sidebar-title\">规格参数</h3>\n                {series.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>系列</h4>\n                    <ul className=\"filter-list\">\n                        {series.slice(0, 10).map(s => (\n                        <li key={s}><label><input type=\"checkbox\" checked={selectedSeries.includes(s)} onChange={() => setSelectedSeries(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])} /> {s}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                {storages.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>容量</h4>\n                    <ul className=\"filter-list\">\n                        {storages.map(s => (\n                        <li key={s}><label><input type=\"checkbox\" checked={selectedStorage.includes(s)} onChange={() => setSelectedStorage(prev => prev.includes(s) ? prev.filter(x=>x!==s) : [...prev,s])} /> {s}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                {colors.length > 0 && (\n                    <div className=\"spec-group\">\n                    <h4>颜色</h4>\n                    <ul className=\"filter-list\">\n                        {colors.slice(0, 8).map(c => (\n                        <li key={c}><label><input type=\"checkbox\" checked={selectedColors.includes(c)} onChange={() => setSelectedColors(prev => prev.includes(c) ? prev.filter(x=>x!==c) : [...prev,c])} /> {c}</label></li>\n                        ))}\n                    </ul>\n                    </div>\n                )}\n                </div>\n                </>\n            )}\n\n            <div className=\"sidebar-section\">\n              <h3 className=\"sidebar-title\">价格区间</h3>\n              <div className=\"price-range-inputs\">\n                <input type=\"number\" placeholder=\"¥ min\" value={minPrice} onChange={e => setMinPrice(e.target.value)} />\n                <span>-</span>\n                <input type=\"number\" placeholder=\"¥ max\" value={maxPrice} onChange={e => setMaxPrice(e.target.value)} />\n              </div>\n            </div>\n            \n            <div className=\"sidebar-section\">\n               <h3 className=\"sidebar-title\">商城</h3>\n               <ul className=\"filter-list\">\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(10)} onChange={() => togglePlatform(10)} /> 楽天</label></li>\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(20)} onChange={() => togglePlatform(20)} /> Yahoo!ショッピング</label></li>\n                 <li><label><input type=\"checkbox\" checked={selectedPlatforms.includes(40)} onChange={() => togglePlatform(40)} /> Amazon</label></li>\n               </ul>\n            </div>\n          </div>\n\n          {/* Main Content Results */}\n          <div className=\"main-content\">\n            <div className=\"results-header\">\n              <h2>\"{query}\" 搜索结果 <span>({filteredProducts.length}件)</span></h2>\n              <div className=\"sort-bar\">\n                <span className=\"sort-label\">排序:</span>\n                <button className={`sort-tab ${sortOption === 'price_asc' ? 'active' : ''}`} onClick={() => setSortOption('price_asc')}>价格低到高</button>\n                <button className={`sort-tab ${sortOption === 'price_desc' ? 'active' : ''}`} onClick={() => setSortOption('price_desc')}>价格高到低</button>\n                <button className={`sort-tab ${sortOption === 'platform' ? 'active' : ''}`} onClick={() => setSortOption('platform')}>商城</button>\n              </div>\n            </div>\n\n            <div className=\"product-list-view\">\n              {currentPageProducts.map((product, index) => (\n                <div key={index} className=\"product-row\">\n                  <div className=\"p-image\">\n                    <img src={product.imgUrl || 'https://via.placeholder.com/120'} alt={product.goodsName} onError={(e) => (e.target as HTMLImageElement).src = 'https://via.placeholder.com/120'} />\n                  </div>\n                  <div className=\"p-info\">\n                    <div className=\"p-title-row\">\n                      <a href={product.goodsLink} target=\"_blank\" rel=\"noopener noreferrer\" className=\"p-title\" onClick={() => { if (product.goodsId) { userApi.addHistory(product.goodsId); } }}>{product.goodsName}</a>\n                    </div>\n                    <div className=\"p-specs\">\n                      {(function(){\n                        const f = parseFacets(product.goodsName);\n                        const parts = [f.brand, f.series, f.model, f.storage, f.color, f.size].filter(Boolean);\n                        return parts.join(' | ');\n                      })()}\n                    </div>\n                    <div className=\"p-meta\">\n                      <span className={`mall-tag mall-${product.mallType}`}>{getPlatformName(product.mallType)}</span>\n                      <span className=\"seller\">{getSellerFromLink(product.goodsLink)}</span>\n                    </div>\n                  </div>\n                  <div className=\"p-action\">\n                    <div className=\"p-price\">{product.goodsPrice.toLocaleString()}円</div>\n                    <a href={product.goodsLink} target=\"_blank\" rel=\"noopener noreferrer\" className=\"btn-shop\" onClick={() => { if (product.goodsId) { userApi.addHistory(product.goodsId); } }}>前往购买</a>\n                    <button className=\"btn-trend\" onClick={() => { ensureGoodsIdAndCollect(product); }}>{product.goodsId && collectedIds.has(product.goodsId) ? '取消收藏' : '收藏'}</button>\n                    <button className=\"btn-trend\" onClick={() => {\n                        const title = product.goodsName;\n                        const labels = Array.from({length:12}, (_,i)=>{\n                          const d = new Date();\n                          d.setMonth(d.getMonth() - (11 - i));\n                          const m = (d.getMonth()+1).toString().padStart(2,'0');\n                          return `${d.getFullYear()}-${m}`;\n                        });\n                        const base = Math.max(1, product.goodsPrice);\n                        let val = base * 1.0;\n                        const series = labels.map((_,i)=>{\n                          const drift = 1 + Math.sin(i/3) * 0.05;\n                          const noise = 1 + ((Math.random() - 0.5) * 0.08);\n                          val = Math.max(1, val * drift * noise);\n                          return Math.round(val);\n                        });\n                        setTrendTitle(title);\n                        setTrendLabels(labels);\n                        setTrendSeries(series);\n                        setTrendOpen(true);\n                    }}>价格走势</button>\n                    <label className=\"compare-check\">\n                      <input type=\"checkbox\" checked={isSelected(getSelectKey(product))} onChange={() => toggleSelect(product)} /> 对比\n                    </label>\n                  </div>\n                </div>\n              ))}\n            </div>\n            \n            <div className=\"pagination-controls\">\n                <button type=\"button\" onClick={goPrev} disabled={currentPage === 1}>上一页</button>\n                <span className=\"page-info\">{currentPage} / {totalPages}</span>\n                <button type=\"button\" onClick={goNext} disabled={currentPage === totalPages}>下一页</button>\n            </div>\n          </div>\n          \n          {trendOpen && (\n            <div className=\"price-trend-modal\" onClick={() => setTrendOpen(false)}>\n              <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\n                <div className=\"modal-header\">\n                  <span className=\"modal-title\">{trendTitle}</span>\n                  <button type=\"button\" className=\"modal-close\" onClick={() => setTrendOpen(false)}>×</button>\n                </div>\n                <div className=\"modal-body\">\n                  <div className=\"trend-chart\">\n                    {(function(){\n                      const width = 600;\n                      const height = 280;\n                      const padding = 32;\n                      const xs = trendSeries.map((_,i)=> padding + (i*(width - 2*padding))/(trendSeries.length-1));\n                      const minV = Math.min(...trendSeries);\n                      const maxV = Math.max(...trendSeries);\n                      const ys = trendSeries.map(v => height - padding - ((v - minV) / (Math.max(1, maxV - minV))) * (height - 2*padding));\n                      const path = xs.map((x,i)=> `${i===0?'M':'L'}${x},${ys[i]}`).join(' ');\n                      const gridY = [0.25,0.5,0.75].map(r => height - padding - r*(height - 2*padding));\n                      return (\n                        <svg width={width} height={height} role=\"img\" aria-label=\"价格趋势图\">\n                          {gridY.map((gy,i)=> (\n                            <line key={i} x1={padding} y1={gy} x2={width-padding} y2={gy} stroke=\"#eee\" />\n                          ))}\n                          <path d={path} fill=\"none\" stroke=\"#ff4400\" strokeWidth={2} />\n                          {xs.map((x,i)=> (\n                            <circle key={i} cx={x} cy={ys[i]} r={3} fill=\"#ff4400\" />\n                          ))}\n                          <text x={padding} y={height-8} fontSize={12} fill=\"#999\">{trendLabels[0]}</text>\n                          <text x={width-padding-60} y={height-8} fontSize={12} fill=\"#999\">{trendLabels[trendLabels.length-1]}</text>\n                        </svg>\n                      );\n                    })()}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {!loading && !error && compareGroups.length === 0 && query && (\n        <div className=\"no-results\">関連商品が見つかりません</div>\n      )}\n    </div>\n  );\n};\n\nexport default ComparePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}